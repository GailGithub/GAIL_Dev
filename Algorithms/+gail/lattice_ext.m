function xlat = lattice_ext(xpts,d)
% d: dimension of the problem, 1<=d<=100.
% xpts: the sequence of points in dimension n x 1 to extend to dimension d->
% xlat: output with dimension n x d

% generating vector corresponding to lattice_gen
 z = [1, 27808567, 14629093, 17951525, 873611, 20915065, 21016621, 23276977,...
    13573889, 23031381, 30852487, 26266751, 28027657, 5189743, 16396083,...
    17119083, 13327883, 5182645, 736279, 16190439, 4281341, 18011305,...
    26892147, 2860863, 18897101, 20241879, 31482589, 9705235, 23408339,...
    14422975, 27614503, 19560933, 1623155, 25844767, 4275455, 19908921,...
    32077639, 13483691, 7500601, 23724921, 20105911, 10850327, 12463705,...
    20419927, 15450237, 13699327, 5391239, 20988989, 2292675, 22914301,...
    11579857, 3631277, 29192369, 27493855, 26733513, 18979447, 7895911,...
    28510509, 5136563, 6010773, 22244255, 18318415, 21262503, 2703747,...
    12557745, 29189357, 24888579, 5272959, 18244419, 10852353, 19495673,...
    15385229, 17652639, 21737265, 13726991, 14542113, 16618901, 1921655,...
    29004257, 24806569, 2515121, 25540279, 3051655, 5637047, 19239479,...
    25413861, 19026129, 7717595, 16939323, 5596877, 3411409, 29006229,...
    29289975, 17980543, 25987481, 23186729, 4858187, 25345023, 30536647, 865955];

xlat = mod(bsxfun(@(x,c) x.*c,xpts,z(2:d+1)),1);

end
