Already up-to-date.
gailpbs_tests: Input arg R2017a

                            < M A T L A B (R) >
                  Copyright 1984-2017 The MathWorks, Inc.
                   R2017a (9.2.0.556344) 64-bit (glnxa64)
                               March 27, 2017

 
To get started, type one of these: helpwin, helpdesk, or demo.
For product information, visit www.mathworks.com.
 
>> >> >> >> 
Welcome to Guaranteed Automatic Integration Library (GAIL).
You are installing GAIL v2.3.1.

[Warning: Unable to save path to file
'/share/apps/matlab/R2017a/toolbox/local/pathdef.m'. You can save your path to
a different location by calling SAVEPATH with an input argument that specifies
the full path. For MATLAB to use that path in future sessions, save the path to
'pathdef.m' in your MATLAB startup folder.] 
[> In savepath (line 172)
  In GAIL_Install (line 20)] 

GAIL version 2.3.1 has been installed successfully.

>> >> >> >> GAILVERSION = 2.3.1.  MATLABVERSION = 9.2
TAP version 13
1..30
ok 1 - "help cubBayesLattice_g"
ok 2 - "warning('off','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 3 - "[~,muhat] = cubBayesLattice_g;"
ok 4 - "exactInteg = 1.0/3;"
ok 5 - "warning('on','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 6 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 7 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 8 - "dim=2; absTol=1e-2; relTol=1e-2;"
ok 9 - "exactInteg = besseli(0,1)^dim;"
ok 10 - "inputArgs = {'relTol',relTol, 'order',2, 'ptransform','C1sin'};"
ok 11 - "inputArgs = [{fun, dim, 'absTol',absTol,'oneTheta',false} inputArgs];"
ok 12 - "obj=cubBayesLattice_g(inputArgs{:});"
ok 13 - "[muhat,outParams]=compInteg(obj);"
ok 14 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
ok 15 - "etaDim = size(outParams.optParams.aMLEAll, 2)"
ok 16 - "help cubBayesLattice_g"
ok 17 - "warning('off','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 18 - "[~,muhat] = cubBayesLattice_g;"
ok 19 - "exactInteg = 1.0/3;"
ok 20 - "warning('on','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 21 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 22 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 23 - "dim=2; absTol=1e-2; relTol=1e-2;"
ok 24 - "exactInteg = besseli(0,1)^dim;"
ok 25 - "inputArgs = {'relTol',relTol, 'order',2, 'ptransform','C1sin'};"
ok 26 - "inputArgs = [{fun, dim, 'absTol',absTol,'oneTheta',false} inputArgs];"
ok 27 - "obj=cubBayesLattice_g(inputArgs{:});"
ok 28 - "[muhat,outParams]=compInteg(obj);"
ok 29 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
ok 30 - "etaDim = size(outParams.optParams.aMLEAll, 2)"
time =
    5.9970
TAP version 13
1..3
ok 1 - "q = integral_g(@(x) x.^2)"
ok 2 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',1,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 3 - "q = integral_g()"
time =
    0.2604
TAP version 13
1..17
ok 1 - "f = @(x) exp(-(x-1).^2); q = integral_g(f,'a',1,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 2 - "f = @(x) exp(-x.^2); q = integral_g(f,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 3 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',1,'b',2,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 4 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',2,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 5 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 6 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',3,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 7 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',-1,'b',3,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 8 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',-4.5,'b',1.5,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 9 - "q = integral_g(@(x)x.^2,'a',1)"
ok 10 - "q = integral_g(@(x)x.^2,'a',0,'b',Inf)"
ok 11 - "q = integral_g(@(x)x.^2,'a',Inf)"
ok 12 - "q = integral_g(@(x)x.^2,'a',NaN)"
ok 13 - "q = integral_g(@(x)x.^2,'a',0,'b',NaN)"
ok 14 - "q = integral_g(@(x)x.^2,'a',1,'b',0)"
ok 15 - "q = integral_g(@(x)x.^2,'a',0,'b',2,'nlo',10,'nhi',100)"
ok 16 - " inparam.a=0; inparam.b=3; inparam.abstol=1e-13; q=integral_g(@(x) exp(2*x),inparam)"
ok 17 - "q = integral_g(@(x) x.^2,'a',-1,'b',1)"
time =
    0.1326

Running ut_integral_g
........
Done ut_integral_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   0.076893 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
          ut_integral_g/testsinefunction        1        0          0     0.0026
      ut_integral_g/testerrorfabstolnmax        1        0          0     0.0030
                ut_integral_g/testerrorf        1        0          0     0.0043
           ut_integral_g/testerrorfninit        1        0          0     0.0051
            ut_integral_g/testerrorfnamx        1        0          0     0.0052
          ut_integral_g/testerrorOfExp2x        1        0          0     0.0104
     ut_integral_g/testerrorfabstolninit        1        0          0     0.0121
          ut_integral_g/testerrorfabstol        1        0          0     0.0342

TAP version 13
1..7
ok 1 - "f = @(x) x.^2;"
ok 2 - "[~, out_param] = funappx_g(f,-2,2,1e-7,18)"
ok 3 - "f = @(x) x.^2;"
ok 4 - "[~, out_param] = funappx_g(f,'a',-2,'b',2,'ninit',17)"
ok 5 - "in_param.a = -5; in_param.b = 5; f = @(x) x.^2;"
ok 6 - "in_param.abstol = 10^(-6); in_param.ninit=18;"
ok 7 - "[~, out_param] = funappx_g(f,in_param)"
time =
    0.1871
TAP version 13
1..11
ok 1 - "funappx_g"
ok 2 - "clear in_param; in_param.a = -5; in_param.b =5; in_param.abstol = 10^(-7); "
ok 3 - "[~, out_param] = funappx_g(@(x) x.^2, in_param)"
ok 4 - "clear in_param; f = @(x) sin(x); in_param.a = -1; in_param.b = 1; "
ok 5 - "in_param.abstol = 10^(-8); in_param.ninit = 20; "
ok 6 - "[~, out_param] = funappx_g(f, in_param)"
ok 7 - "[~, out_param] = funappx_g(@(x) x.^3,'a',-2,'b',2,'abstol',1e-7,'ninit',41)"
ok 8 - "[~, out_param] = funappx_g(@(x) exp(-100*(x-0.7).^2),'a',0,'b',1,'ninit',28)"
ok 9 - "[~, out_param] = funappx_g(@(x) x.^2,'memorytest',1,'output_x',1);"
ok 10 - "out_param.bytes <= 280674"
ok 11 - "length(out_param.x) == out_param.npoints"
time =
    0.3183

Running ut_funappx_g
..........
.......
Done ut_funappx_g
__________

Totals:
   17 Passed, 0 Failed, 0 Incomplete.   1.2707 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
             ut_funappx_g/funappx_gOfxab        1        0          0     0.0052
       ut_funappx_g/funappx_gOfxsquareab        1        0          0     0.0069
               ut_funappx_g/funappx_gOfx        1        0          0     0.0104
         ut_funappx_g/funappx_gOf100000x        1        0          0     0.0121
  ut_funappx_g/funappx_gOnpointsoflinear        1        0          0     0.0130
   ut_funappx_g/funappx_gOfexponentialab        1        0          0     0.0132
           ut_funappx_g/funappx_gOfsinab        1        0          0     0.0146
         ut_funappx_g/funappx_gOfxsquare        1        0          0     0.0152
             ut_funappx_g/funappx_gOfsin        1        0          0     0.0161
ut_funappx_g/funappx_gOnpointsofconstant        1        0          0     0.0211
            ut_funappx_g/funappx_gOfbeqa        1        0          0     0.0416
    ut_funappx_g/funappx_gOfexceedbudget        1        0          0     0.0429
     ut_funappx_g/funappx_gOfexponential        1        0          0     0.0473
      ut_funappx_g/funappx_gOfexceediter        1        0          0     0.0742
      ut_funappx_g/funappx_gOfnofunction        1        0          0     0.1322
            ut_funappx_g/funappx_gOfblea        1        0          0     0.2694
ut_funappx_g/funappx_gofConstantFunction        1        0          0     0.5353

TAP version 13
1..12
ok 1 - "f = @(x) exp(0.01*(x-0.5).^2); [fmin,out_param] = funmin_g(f)"
ok 2 - "f = @(x) exp(0.01*(x-0.5).^2);"
ok 3 - "[fmin,out_param] = funmin_g(f,-2,2,1e-7,10,1000000)"
ok 4 - "f=@(x) exp(0.01*(x-0.5).^2);"
ok 5 - "in_param.a = -13; in_param.b = 8;"
ok 6 - "in_param.abstol = 10^(-7);"
ok 7 - "in_param.ninit = 100;"
ok 8 - "in_param.nmax = 10^6;"
ok 9 - "[fmin,out_param] = funmin_g(f,in_param)"
ok 10 - "f=@(x) exp(0.01*(x-0.5).^2);"
ok 11 - "[fmin,out_param] = funmin_g(f,'a',-2,'b',2,'ninit',64,'nmax',1e6,'abstol',1e-5)"
ok 12 - "out_param(:).intervals"
time =
    0.1260

Running ut_funmin_g
........
Done ut_funmin_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   0.81492 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
                ut_funmin_g/funmin_gEXM3        1        0          0     0.0070
                ut_funmin_g/funmin_gEXM6        1        0          0     0.0094
                ut_funmin_g/funmin_gEXM7        1        0          0     0.0132
                ut_funmin_g/funmin_gEXM5        1        0          0     0.0155
                ut_funmin_g/funmin_gEXM2        1        0          0     0.0160
                ut_funmin_g/funmin_gEXM1        1        0          0     0.0454
                ut_funmin_g/funmin_gEXM4        1        0          0     0.1113
                ut_funmin_g/funmin_gEXM8        1        0          0     0.5971


Running ut_funmin_g_end
..
Done ut_funmin_g_end
__________

Totals:
   2 Passed, 0 Failed, 0 Incomplete.   0.055465 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
            ut_funmin_g_end/funmin_gEXM2        1        0          0     0.0168
            ut_funmin_g_end/funmin_gEXM1        1        0          0     0.0387

TAP version 13
1..10
ok 1 - "meanMC_g"
ok 2 - "in_param.reltol = 0; in_param.abstol = 1e-3;"
ok 3 - "in_param.alpha = 0.05; Yrand=@(n) rand(n,1).^2;"
ok 4 - "tmu = meanMC_g(Yrand,in_param); exactsol = 1/3;"
ok 5 - "check = double(abs(exactsol-tmu) < 1e-3)"
ok 6 - "tmu = meanMC_g(@(n)exp(rand(n,1)),1e-3,0); exactsol = exp(1)-1;"
ok 7 - "check = double(abs(exactsol-tmu) < 1e-3)"
ok 8 - "tmu = meanMC_g(@(n)cos(rand(n,1)),'reltol',1e-3,'abstol',1e-4,'alpha',0.01);"
ok 9 - "exactsol = sin(1);"
ok 10 - "check = double(abs(exactsol-tmu) < max(1e-3,1e-2*abs(exactsol)))"
time =
    0.0381

Running ut_meanMC_g
......
Done ut_meanMC_g
__________

Totals:
   6 Passed, 0 Failed, 0 Incomplete.   2.1864 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
               ut_meanMC_g/meanMC_gOfsin        1        0          0     0.0211
           ut_meanMC_g/meanMC_gOfxsquare        1        0          0     0.0252
    ut_meanMC_g/meanMC_gOfnonRandomInput        1        0          0     0.0329
           ut_meanMC_g/meanMC_gOfparsing        1        0          0     0.0353
               ut_meanMC_g/meanMC_gOfexp        1        0          0     0.0579
          ut_meanMC_g/meanMC_gOfWorkouts        1        0          0     2.0139

TAP version 13
1..22
ok 1 - "cubMC_g"
ok 2 - "f = @(x) sin(x); interval = [1;2];"
ok 3 - "Q = cubMC_g(f,interval,'uniform',1e-3,1e-2);"
ok 4 - "exactsol = 0.9564;"
ok 5 - "check = double(abs(exactsol-Q) < max(1e-3,1e-2*abs(exactsol)))"
ok 6 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [0 0;1 1];"
ok 7 - "Q = cubMC_g(f,hyperbox,'uniform',1e-3,0);"
ok 8 - "exactsol = 0.5577;"
ok 9 - "check = double(abs(exactsol-Q) < 1e-3)"
ok 10 - "d = 3; f = @(x) 2^d*prod(x,2)+0.555; hyperbox =[zeros(1,d); ones(1,d)];"
ok 11 - "in_param.abstol = 1e-3; in_param.reltol = 1e-3;"
ok 12 - "Q = cubMC_g(f,hyperbox,in_param);"
ok 13 - "exactsol = 1.555;"
ok 14 - "check = double(abs(exactsol-Q) < max(1e-3,1e-3*abs(exactsol)))"
ok 15 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-inf -inf;inf inf];"
ok 16 - "Q = cubMC_g(f,hyperbox,'normal',0,1e-2);"
ok 17 - "exactsol = 1/3;"
ok 18 - "check = double(abs(exactsol-Q) < max(0,1e-2*abs(exactsol)))"
ok 19 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1];"
ok 20 - "Q = cubMC_g(f,hyperbox,'uniform ball','abstol',1e-3,'reltol',1e-3);"
ok 21 - "exactsol = pi/2;"
ok 22 - "check = double(abs(exactsol-Q) < max(1e-3,1e-3*abs(exactsol)))"
time =
    0.8888
TAP version 13
1..21
ok 1 - "f = @(x) prod(x,2); hyperbox = [zeros(1,2);ones(1,2)];"
ok 2 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0,'transform','C1sin'); exactsol = 1/4;"
ok 3 - "check = double(abs(exactsol-q) < 1e-5)"
ok 4 - "f = @(x) x(:,1).^2.*x(:,2).^2.*x(:,3).^2; hyperbox = [-inf(1,3);inf(1,3)];"
ok 5 - "q = cubLattice_g(f,hyperbox,'normal',1e-3,1e-3,'transform','C1sin','shift',2^(-25)*ones(1,3)); exactsol = 1;"
ok 6 - "check = double(abs(exactsol-q) < max(1e-3,1e-3*abs(exactsol)))"
ok 7 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-ones(1,2);2*ones(1,2)];"
ok 8 - "q = cubLattice_g(f,hyperbox,'uniform',1e-3,1e-2,'transform','C1'); exactsol = 1/9*(sqrt(pi)/2*(erf(2)+erf(1)))^2;"
ok 9 - "check = double(abs(exactsol-q) < max(1e-3,1e-2*abs(exactsol)))"
ok 10 - "f = @(x) exp(-0.05^2/2)*max(100*exp(0.05*x)-100,0); hyperbox = [-inf(1,1);inf(1,1)];"
ok 11 - "q = cubLattice_g(f,hyperbox,'normal',1e-4,1e-2,'transform','C1sin'); price = normcdf(0.05)*100 - 0.5*100*exp(-0.05^2/2);"
ok 12 - "check = double(abs(price-q) < max(1e-4,1e-2*abs(price)))"
ok 13 - "f = @(x) 8*prod(x,2); hyperbox = [zeros(1,5);ones(1,5)];"
ok 14 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 15 - "check = double(abs(exactsol-q) < 1e-5)"
ok 16 - "f = @(x) 3./(5-4*(cos(2*pi*x))); hyperbox = [0;1];"
ok 17 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0,'transform','id'); exactsol = 1;"
ok 18 - "check = double(abs(exactsol-q) < 1e-5)"
ok 19 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1];"
ok 20 - "q = cubLattice_g(f,hyperbox,'uniform ball','abstol',1e-4,'reltol',0); exactsol = pi/2;"
ok 21 - "check = double(abs(exactsol-q) < 1e-4)"
time =
    0.7601

Running ut_cubLattice_g
.......
  Dim  FcnIdx       Q        f_true          Err      Sample Used      Stats  
-----------------------------------------------------------------------------------------------------
     1      1 +8.41471e-01 +8.41471e-01 9.37967e-08   1024             BothErrMet
     1      2 +7.85398e-01 +7.85398e-01 7.21102e-08   1024             BothErrMet
     1      3 +3.75001e-01 +3.75000e-01 5.10576e-07   1024             BothErrMet
     1      4 +7.46824e-01 +7.46824e-01 1.15481e-07   1024             BothErrMet
     1      5 +6.32121e-01 +6.32121e-01 5.50880e-08   1024             BothErrMet
     2      1 +4.96752e-01 +4.96751e-01 2.40111e-07   1024             BothErrMet
     2      2 +7.28296e-01 +7.28296e-01 1.12275e-07   1024             BothErrMet
     2      3 +1.01854e-01 +1.01852e-01 2.44932e-06   2048             BothErrMet
     2      4 +6.88992e-01 +6.88992e-01 2.28033e-07   1024             BothErrMet
     2      5 +4.97439e-01 +4.97440e-01 1.21948e-06   1024             BothErrMet
     3      1 +6.23593e-02 +6.23593e-02 5.75997e-08   2048             BothErrMet
     3      2 +6.62569e-01 +6.62570e-01 4.74167e-07   1024             BothErrMet
     3      3 +2.18414e-02 +2.17014e-02 1.40030e-04   1024             AbsErrMet
     3      4 +6.20903e-01 +6.20903e-01 8.40298e-07   1024             BothErrMet
     3      5 +3.83054e-01 +3.83055e-01 8.26405e-07   1024             BothErrMet
     4      1 -3.51763e-01 -3.51764e-01 5.11539e-07   4096             BothErrMet
     4      2 +5.88680e-01 +5.88680e-01 6.26715e-07   1024             BothErrMet
     4      3 +3.74062e-03 +3.80556e-03 6.49350e-05   1024             AbsErrMet
     4      4 +5.43378e-01 +5.43373e-01 4.72065e-06   1024             BothErrMet
     4      5 +2.86990e-01 +2.86844e-01 1.46654e-04   1024             BothErrMet
     5      1 -6.49338e-01 -6.49331e-01 6.56300e-06   4096             BothErrMet
     5      2 +5.13394e-01 +5.13409e-01 1.54960e-05   1024             BothErrMet
     5      3 +5.62676e-04 +5.67130e-04 4.45365e-06   1024             AbsErrMet
     5      4 +4.64609e-01 +4.64603e-01 6.20218e-06   2048             BothErrMet
     5      5 +2.09894e-01 +2.09952e-01 5.80458e-05   1024             BothErrMet
     6      1 -7.69110e-01 -7.69376e-01 2.66271e-04   8192             BothErrMet
     6      2 +4.41469e-01 +4.41474e-01 5.14436e-06   2048             BothErrMet
     6      3 +6.44952e-05 +7.34937e-05 8.99850e-06   1024             AbsErrMet
     6      4 +3.90257e-01 +3.90227e-01 2.91144e-05   2048             BothErrMet
     6      5 +1.50915e-01 +1.50939e-01 2.36316e-05   2048             BothErrMet
     7      1 -6.97857e-01 -6.97824e-01 3.31931e-05   8192             BothErrMet
     7      2 +3.75534e-01 +3.75484e-01 5.01802e-05   2048             BothErrMet
     7      3 +6.41155e-06 +8.42590e-06 2.01435e-06   1024             AbsErrMet
     7      4 +3.23302e-01 +3.23235e-01 6.63189e-05   2048             BothErrMet
     7      5 +1.06996e-01 +1.06978e-01 1.78653e-05   2048             BothErrMet
     8      1 -4.67014e-01 -4.67036e-01 2.15915e-05  16384             BothErrMet
     8      2 +3.16605e-01 +3.16602e-01 2.74858e-06   2048             BothErrMet
     8      3 +6.57235e-07 +8.66209e-07 2.08974e-07   1024             AbsErrMet
     8      4 +2.64849e-01 +2.64801e-01 4.77950e-05   2048             BothErrMet
     8      5 +7.48797e-02 +7.49531e-02 7.34399e-05   1024             BothErrMet
.
Done ut_cubLattice_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   3.1428 seconds testing time.
   100% Passed.
                                     Name   Passed   Failed Incomplete   Duration
        ut_cubLattice_g/cubLattice_gOfsin        1        0          0     0.0106
        ut_cubLattice_g/cubLattice_gOfexp        1        0          0     0.0143
ut_cubLattice_g/cubLattice_gOfmultierrfun        1        0          0     0.0158
    ut_cubLattice_g/cubLattice_gOfxsquare        1        0          0     0.0172
    ut_cubLattice_g/cubLattice_gOdwarning        1        0          0     0.0207
    ut_cubLattice_g/cubLattice_gOfwarning        1        0          0     0.0945
      ut_cubLattice_g/cubLattice_Workouts        1        0          0     0.4915
       ut_cubLattice_g/cubLattice_gNormal        1        0          0     2.4782

TAP version 13
1..26
ok 1 - "f = @(x) prod(x,2); hyperbox = [zeros(1,2);ones(1,2)];"
ok 2 - "q = cubSobol_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 3 - "check = double(abs(exactsol-q) < 1e-5)"
ok 4 - "f = @(x) x(:,1).^2.*x(:,2).^2.*x(:,3).^2; "
ok 5 - "hyperbox = [-inf(1,3);inf(1,3)]; exactsol = 1;"
ok 6 - "q = cubSobol_g(f,hyperbox,'normal',1e-3,1e-3, 'fudge',@(m) 10*2.^-m); "
ok 7 - "check = double(abs(exactsol-q) < max(1e-3,1e-3*abs(exactsol)))"
ok 8 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-ones(1,2);2*ones(1,2)];"
ok 9 - "q = cubSobol_g(f,hyperbox,'uniform',1e-3,1e-2); "
ok 10 - "exactsol = 1/9*(sqrt(pi)/2*(erf(2)+erf(1)))^2;"
ok 11 - "check = double(abs(exactsol-q) < max(1e-3,1e-2*abs(exactsol)))"
ok 12 - "f = @(x) exp(-0.05^2/2)*max(100*exp(0.05*x)-100,0); "
ok 13 - "hyperbox = [-inf(1,1);inf(1,1)];"
ok 14 - "q = cubSobol_g(f,hyperbox,'normal',1e-4,1e-2); "
ok 15 - "price = normcdf(0.05)*100 - 0.5*100*exp(-0.05^2/2);"
ok 16 - "check = double(abs(price-q) < max(1e-4,1e-2*abs(price)))"
ok 17 - "f = @(x) 8*prod(x,2); hyperbox = [zeros(1,5);ones(1,5)];"
ok 18 - "q = cubSobol_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 19 - "check = double(abs(exactsol-q) < 1e-5)"
ok 20 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1]; exactsol = pi/2;"
ok 21 - "q = cubSobol_g(f,hyperbox,'uniform ball','abstol',1e-4,'reltol',0); "
ok 22 - "check = double(abs(exactsol-q) < 1e-4)"
ok 23 - "g.func = @(x) [10*x(:,1)-5*x(:,2).^2+1*x(:,3).^3, x(:,1), x(:,2).^2];"
ok 24 - "g.cv = [1,4/3]; hyperbox= [zeros(1,3);2*ones(1,3)];"
ok 25 - "q = cubSobol_g(g,hyperbox,'uniform',1e-6,0); exactsol = 16/3;"
ok 26 - "check = double(abs(exactsol-q) < 1e-6)"
time =
   1.496539000000000

Running ut_cubSobol_g
.........Dim   FcnIdx       Q             f_true               Err            Sample Used             Stats  
-----------------------------------------------------------------------------------------------------
1     1       8.41471e-01       8.41471e-01       1.91709e-09         1024             BothErrMet
1     2       7.85399e-01       7.85398e-01       7.71554e-07         1024             BothErrMet
2     1       4.96758e-01       4.96751e-01       6.45572e-06         1024             BothErrMet
2     2       7.28296e-01       7.28296e-01       2.40469e-07         1024             BothErrMet
3     1       6.23465e-02       6.23593e-02       1.27815e-05         1024             BothErrMet
3     2       6.62569e-01       6.62570e-01       4.85014e-07         1024             BothErrMet
.
Done ut_cubSobol_g
__________

Totals:
   10 Passed, 0 Failed, 0 Incomplete.   1.5732 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
           ut_cubSobol_g/cubSobol_gOfsin        1        0          0     0.0113
           ut_cubSobol_g/cubSobol_gOfexp        1        0          0     0.0118
   ut_cubSobol_g/cubSobol_gOfmultierrfun        1        0          0     0.0142
    ut_cubSobol_g/cubSobol_gOfmultierfcv        1        0          0     0.0157
       ut_cubSobol_g/cubSobol_gOfxsquare        1        0          0     0.0223
        ut_cubSobol_g/cubSobol_gOfpolycv        1        0          0     0.0235
       ut_cubSobol_g/cubSobol_gOdwarning        1        0          0     0.0276
       ut_cubSobol_g/cubSobol_gOfwarning        1        0          0     0.1050
         ut_cubSobol_g/cubSobol_Workouts        1        0          0     0.1257
    ut_cubSobol_g/cubSobol_gOfgmeanOptcv        1        0          0     1.2162

TAP version 13
1..2
ok 1 - "obj = assetPath"
ok 2 - "obj = assetPath"
time =
    0.8942
TAP version 13
1..2
ok 1 - "obj = optPayoff"
ok 2 - "obj = optPayoff"
time =
    0.8888
TAP version 13
1..2
ok 1 - "obj = optPrice"
ok 2 - "obj = optPrice"
time =
    1.0507
TAP version 13
1..2
ok 1 - "obj = brownianMotion"
ok 2 - "obj = brownianMotion"
time =
    0.9115
TAP version 13
1..1
ok 1 - "obj = stochProcess"
time =
    0.8095
TAP version 13
1..2
ok 1 - "obj = whiteNoise"
ok 2 - "obj = whiteNoise"
time =
    0.8802
TAP version 13
1..4
ok 1 - "errParamObj = gail.errorParam"
ok 2 - "errParamObj = gail.errorParam(0.001)"
ok 3 - "errParamObj = gail.errorParam('relTol',0.1)"
ok 4 - "newErrParamObj = gail.errorParam(errParamObj,'relTol',0.001)"
time =
    0.9071
TAP version 13
1..12
ok 1 - "fParamObj = gail.fParam"
ok 2 - "fParamObj = gail.fParam(@(x) sum(x.^3.2),[0 0; 1 1])"
ok 3 - "fParamObj = gail.fParam(@(x) sum(x.^3.2),[0 0; 1 1],'ball')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.relTol = 0.1;"
ok 7 - "fParamObj = gail.fParam(inpStruct)"
ok 8 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 9 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 10 - "inpStruct.relTol = 0.1;"
ok 11 - "fParamObj = gail.fParam(inpStruct,0.0001,0.01)"
ok 12 - "newfParamObj = gail.fParam(fParamObj,'domainType','sphere')"
time =
    0.7438
TAP version 13
1..8
ok 1 - "cubParamObj = gail.cubParam"
ok 2 - "cubParamObj = gail.cubParam(@(x) sum(x.^3.2),[0 0; 2 2],'box','Lebesgue')"
ok 3 - "cubParamObj = gail.cubParam('domain', [-Inf -Inf; Inf Inf], 'f', @(x) sum(x.^3.2), 'relTol', 0.1, 'measure', 'Gaussian')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.nInit = 2048;"
ok 7 - "cubParamObj = gail.cubParam(inpStruct)"
ok 8 - "NewCubParamObj = gail.cubParam(cubParamObj,'measure','Lebesgue')"
time =
    0.9263
TAP version 13
1..5
ok 1 - "cubParamObj = gail.cubParam; %an input object"
ok 2 - "cubOutObj = gail.cubOut(cubParamObj); %copied to becom an output object"
ok 3 - "cubOutObj.mu = 1.467; %integral value is recorded"
ok 4 - "cubOutObj.nSample = 31415926; %sample size is recorded"
ok 5 - "cubOutObj.time = 0.0278 %time of computation is recorded"
time =
    0.6416
TAP version 13
1..7
ok 1 - "cubLatticeParamObj = gail.cubLatticeParam"
ok 2 - "cubLatticeParamObj = gail.cubLatticeParam('domain', [-2 -2; 2 2], 'f', @(x) sum(x.^3.2), 'relTol', 0.1, 'isShift', false)"
ok 3 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 4 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 5 - "inpStruct.isShift = false;"
ok 6 - "cubLatticeParamObj = gail.cubLatticeParam(inpStruct)"
ok 7 - "NewCubLatticeParamObj = gail.cubLatticeParam(cubLatticeParamObj,'measure','Lebesgue')"
time =
    0.5230
TAP version 13
1..8
ok 1 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam"
ok 2 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam(@(x) sum(x.^3.2),[0 0; 2 2])"
ok 3 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam('domain', [0 0; 1 1], 'f', @(x) sum(x.^3.2), 'relTol', 0.1,'kerName','Ber4')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.kerName = 'Ber4';"
ok 7 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam(inpStruct)"
ok 8 - "NewCubBayesLatticeParamObj = gail.cubBayesLatticeParam(cubBayesLatticeParamObj,'GPMean',0)"
time =
    0.5856
TAP version 13
1..5
ok 1 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam; %an input object"
ok 2 - "cubBayesLatticeOutObj = gail.cubBayesLatticeOut(cubBayesLatticeParamObj); %copied to becom an output object"
ok 3 - "cubBayesLatticeOutObj.mu = 1.467; %integral value is recorded"
ok 4 - "cubBayesLatticeOutObj.nSample = 31415926; %sample size is recorded"
ok 5 - "cubBayesLatticeOutObj.time = 0.0278 %time of computation is recorded"
time =
    0.5057
TAP version 13
1..8
ok 1 - "meanYParamObj = gail.meanYParam"
ok 2 - "meanYParamObj = gail.meanYParam(@(n) sum(rand(n,4).^3,2),0.001)"
ok 3 - "meanYParamObj = gail.meanYParam('nSig', 1e4, 'Y', @(n)sin(sum(rand(n,4).^3,2)), 'relTol', 0.1)"
ok 4 - "inpStruct.Y = @(n) sin(sum(rand(n,2),2));"
ok 5 - "inpStruct.nSig = 1e4;"
ok 6 - "inpStruct.relTol = 0.1;"
ok 7 - "meanYParamObj = gail.meanYParam(inpStruct)"
ok 8 - "NewMeanYParamObj = gail.meanYParam(meanYParamObj,'Y',@(n) rand(n,3))"
time =
    0.5207
TAP version 13
1..7
ok 1 - "meanParamObj = gail.meanYParam; %an input object"
ok 2 - "meanOutObj = gail.meanYOut(meanParamObj); %copied to becom an output object"
ok 3 - "meanOutObj.sol = 1.467; %integral value is recorded"
ok 4 - "meanOutObj.stddev = 1.23; %standard deviation is recorded"
ok 5 - "meanOutObj.nSample = 31415926; %sample size is recorded"
ok 6 - "meanOutObj.time = 0.0278; %time of computation is recorded"
ok 7 - "meanOutObj.errBd = 0.000456 %error bound is recorded"
time =
    0.5843
total_time =
   37.5157
>> gailpbs_tests: Input arg R2017b

                            < M A T L A B (R) >
                  Copyright 1984-2017 The MathWorks, Inc.
                   R2017b (9.3.0.713579) 64-bit (glnxa64)
                             September 14, 2017

 
To get started, type one of these: helpwin, helpdesk, or demo.
For product information, visit www.mathworks.com.
 
>> >> >> >> 
Welcome to Guaranteed Automatic Integration Library (GAIL).
You are installing GAIL v2.3.1.

[Warning: Unable to save path to file
'/share/apps/matlab/R2017b/toolbox/local/pathdef.m'. You can save your path to
a different location by calling SAVEPATH with an input argument that specifies
the full path. For MATLAB to use that path in future sessions, save the path to
'pathdef.m' in your MATLAB startup folder.] 
[> In savepath (line 176)
  In GAIL_Install (line 20)] 

GAIL version 2.3.1 has been installed successfully.

>> >> >> >> GAILVERSION = 2.3.1.  MATLABVERSION = 9.3
TAP version 13
1..30
ok 1 - "help cubBayesLattice_g"
ok 2 - "warning('off','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 3 - "[~,muhat] = cubBayesLattice_g;"
ok 4 - "exactInteg = 1.0/3;"
ok 5 - "warning('on','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 6 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 7 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 8 - "dim=2; absTol=1e-2; relTol=1e-2;"
ok 9 - "exactInteg = besseli(0,1)^dim;"
ok 10 - "inputArgs = {'relTol',relTol, 'order',2, 'ptransform','C1sin'};"
ok 11 - "inputArgs = [{fun, dim, 'absTol',absTol,'oneTheta',false} inputArgs];"
ok 12 - "obj=cubBayesLattice_g(inputArgs{:});"
ok 13 - "[muhat,outParams]=compInteg(obj);"
ok 14 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
ok 15 - "etaDim = size(outParams.optParams.aMLEAll, 2)"
ok 16 - "help cubBayesLattice_g"
ok 17 - "warning('off','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 18 - "[~,muhat] = cubBayesLattice_g;"
ok 19 - "exactInteg = 1.0/3;"
ok 20 - "warning('on','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 21 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 22 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 23 - "dim=2; absTol=1e-2; relTol=1e-2;"
ok 24 - "exactInteg = besseli(0,1)^dim;"
ok 25 - "inputArgs = {'relTol',relTol, 'order',2, 'ptransform','C1sin'};"
ok 26 - "inputArgs = [{fun, dim, 'absTol',absTol,'oneTheta',false} inputArgs];"
ok 27 - "obj=cubBayesLattice_g(inputArgs{:});"
ok 28 - "[muhat,outParams]=compInteg(obj);"
ok 29 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
ok 30 - "etaDim = size(outParams.optParams.aMLEAll, 2)"
time =
    7.5179
TAP version 13
1..3
ok 1 - "q = integral_g(@(x) x.^2)"
ok 2 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',1,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 3 - "q = integral_g()"
time =
    0.2116
TAP version 13
1..17
ok 1 - "f = @(x) exp(-(x-1).^2); q = integral_g(f,'a',1,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 2 - "f = @(x) exp(-x.^2); q = integral_g(f,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 3 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',1,'b',2,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 4 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',2,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 5 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 6 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',3,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 7 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',-1,'b',3,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 8 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',-4.5,'b',1.5,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 9 - "q = integral_g(@(x)x.^2,'a',1)"
ok 10 - "q = integral_g(@(x)x.^2,'a',0,'b',Inf)"
ok 11 - "q = integral_g(@(x)x.^2,'a',Inf)"
ok 12 - "q = integral_g(@(x)x.^2,'a',NaN)"
ok 13 - "q = integral_g(@(x)x.^2,'a',0,'b',NaN)"
ok 14 - "q = integral_g(@(x)x.^2,'a',1,'b',0)"
ok 15 - "q = integral_g(@(x)x.^2,'a',0,'b',2,'nlo',10,'nhi',100)"
ok 16 - " inparam.a=0; inparam.b=3; inparam.abstol=1e-13; q=integral_g(@(x) exp(2*x),inparam)"
ok 17 - "q = integral_g(@(x) x.^2,'a',-1,'b',1)"
time =
    0.1030

Running ut_integral_g
........
Done ut_integral_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   0.086712 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
          ut_integral_g/testsinefunction        1        0          0     0.0025
      ut_integral_g/testerrorfabstolnmax        1        0          0     0.0028
                ut_integral_g/testerrorf        1        0          0     0.0047
           ut_integral_g/testerrorfninit        1        0          0     0.0049
            ut_integral_g/testerrorfnamx        1        0          0     0.0053
          ut_integral_g/testerrorOfExp2x        1        0          0     0.0108
     ut_integral_g/testerrorfabstolninit        1        0          0     0.0135
          ut_integral_g/testerrorfabstol        1        0          0     0.0423

TAP version 13
1..7
ok 1 - "f = @(x) x.^2;"
ok 2 - "[~, out_param] = funappx_g(f,-2,2,1e-7,18)"
ok 3 - "f = @(x) x.^2;"
ok 4 - "[~, out_param] = funappx_g(f,'a',-2,'b',2,'ninit',17)"
ok 5 - "in_param.a = -5; in_param.b = 5; f = @(x) x.^2;"
ok 6 - "in_param.abstol = 10^(-6); in_param.ninit=18;"
ok 7 - "[~, out_param] = funappx_g(f,in_param)"
time =
    0.1933
TAP version 13
1..11
ok 1 - "funappx_g"
ok 2 - "clear in_param; in_param.a = -5; in_param.b =5; in_param.abstol = 10^(-7); "
ok 3 - "[~, out_param] = funappx_g(@(x) x.^2, in_param)"
ok 4 - "clear in_param; f = @(x) sin(x); in_param.a = -1; in_param.b = 1; "
ok 5 - "in_param.abstol = 10^(-8); in_param.ninit = 20; "
ok 6 - "[~, out_param] = funappx_g(f, in_param)"
ok 7 - "[~, out_param] = funappx_g(@(x) x.^3,'a',-2,'b',2,'abstol',1e-7,'ninit',41)"
ok 8 - "[~, out_param] = funappx_g(@(x) exp(-100*(x-0.7).^2),'a',0,'b',1,'ninit',28)"
ok 9 - "[~, out_param] = funappx_g(@(x) x.^2,'memorytest',1,'output_x',1);"
ok 10 - "out_param.bytes <= 280674"
ok 11 - "length(out_param.x) == out_param.npoints"
time =
    0.3696

Running ut_funappx_g
..........
.......
Done ut_funappx_g
__________

Totals:
   17 Passed, 0 Failed, 0 Incomplete.   1.4719 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
             ut_funappx_g/funappx_gOfxab        1        0          0     0.0051
       ut_funappx_g/funappx_gOfxsquareab        1        0          0     0.0085
         ut_funappx_g/funappx_gOf100000x        1        0          0     0.0098
               ut_funappx_g/funappx_gOfx        1        0          0     0.0107
   ut_funappx_g/funappx_gOfexponentialab        1        0          0     0.0110
           ut_funappx_g/funappx_gOfsinab        1        0          0     0.0138
             ut_funappx_g/funappx_gOfsin        1        0          0     0.0140
         ut_funappx_g/funappx_gOfxsquare        1        0          0     0.0147
  ut_funappx_g/funappx_gOnpointsoflinear        1        0          0     0.0161
ut_funappx_g/funappx_gOnpointsofconstant        1        0          0     0.0285
            ut_funappx_g/funappx_gOfbeqa        1        0          0     0.0504
     ut_funappx_g/funappx_gOfexponential        1        0          0     0.0539
    ut_funappx_g/funappx_gOfexceedbudget        1        0          0     0.0544
      ut_funappx_g/funappx_gOfexceediter        1        0          0     0.0896
      ut_funappx_g/funappx_gOfnofunction        1        0          0     0.1431
            ut_funappx_g/funappx_gOfblea        1        0          0     0.3144
ut_funappx_g/funappx_gofConstantFunction        1        0          0     0.6339

TAP version 13
1..12
ok 1 - "f = @(x) exp(0.01*(x-0.5).^2); [fmin,out_param] = funmin_g(f)"
ok 2 - "f = @(x) exp(0.01*(x-0.5).^2);"
ok 3 - "[fmin,out_param] = funmin_g(f,-2,2,1e-7,10,1000000)"
ok 4 - "f=@(x) exp(0.01*(x-0.5).^2);"
ok 5 - "in_param.a = -13; in_param.b = 8;"
ok 6 - "in_param.abstol = 10^(-7);"
ok 7 - "in_param.ninit = 100;"
ok 8 - "in_param.nmax = 10^6;"
ok 9 - "[fmin,out_param] = funmin_g(f,in_param)"
ok 10 - "f=@(x) exp(0.01*(x-0.5).^2);"
ok 11 - "[fmin,out_param] = funmin_g(f,'a',-2,'b',2,'ninit',64,'nmax',1e6,'abstol',1e-5)"
ok 12 - "out_param(:).intervals"
time =
    0.1473

Running ut_funmin_g
........
Done ut_funmin_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   0.84421 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
                ut_funmin_g/funmin_gEXM3        1        0          0     0.0072
                ut_funmin_g/funmin_gEXM6        1        0          0     0.0087
                ut_funmin_g/funmin_gEXM5        1        0          0     0.0129
                ut_funmin_g/funmin_gEXM7        1        0          0     0.0135
                ut_funmin_g/funmin_gEXM2        1        0          0     0.0141
                ut_funmin_g/funmin_gEXM1        1        0          0     0.0488
                ut_funmin_g/funmin_gEXM4        1        0          0     0.1449
                ut_funmin_g/funmin_gEXM8        1        0          0     0.5940


Running ut_funmin_g_end
..
Done ut_funmin_g_end
__________

Totals:
   2 Passed, 0 Failed, 0 Incomplete.   0.042131 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
            ut_funmin_g_end/funmin_gEXM2        1        0          0     0.0117
            ut_funmin_g_end/funmin_gEXM1        1        0          0     0.0304

TAP version 13
1..10
ok 1 - "meanMC_g"
ok 2 - "in_param.reltol = 0; in_param.abstol = 1e-3;"
ok 3 - "in_param.alpha = 0.05; Yrand=@(n) rand(n,1).^2;"
ok 4 - "tmu = meanMC_g(Yrand,in_param); exactsol = 1/3;"
ok 5 - "check = double(abs(exactsol-tmu) < 1e-3)"
ok 6 - "tmu = meanMC_g(@(n)exp(rand(n,1)),1e-3,0); exactsol = exp(1)-1;"
ok 7 - "check = double(abs(exactsol-tmu) < 1e-3)"
ok 8 - "tmu = meanMC_g(@(n)cos(rand(n,1)),'reltol',1e-3,'abstol',1e-4,'alpha',0.01);"
ok 9 - "exactsol = sin(1);"
ok 10 - "check = double(abs(exactsol-tmu) < max(1e-3,1e-2*abs(exactsol)))"
time =
    0.0414

Running ut_meanMC_g
......
Done ut_meanMC_g
__________

Totals:
   6 Passed, 0 Failed, 0 Incomplete.   2.0448 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
               ut_meanMC_g/meanMC_gOfsin        1        0          0     0.0147
           ut_meanMC_g/meanMC_gOfxsquare        1        0          0     0.0201
           ut_meanMC_g/meanMC_gOfparsing        1        0          0     0.0270
    ut_meanMC_g/meanMC_gOfnonRandomInput        1        0          0     0.0272
               ut_meanMC_g/meanMC_gOfexp        1        0          0     0.0511
          ut_meanMC_g/meanMC_gOfWorkouts        1        0          0     1.9048

TAP version 13
1..22
ok 1 - "cubMC_g"
ok 2 - "f = @(x) sin(x); interval = [1;2];"
ok 3 - "Q = cubMC_g(f,interval,'uniform',1e-3,1e-2);"
ok 4 - "exactsol = 0.9564;"
ok 5 - "check = double(abs(exactsol-Q) < max(1e-3,1e-2*abs(exactsol)))"
ok 6 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [0 0;1 1];"
ok 7 - "Q = cubMC_g(f,hyperbox,'uniform',1e-3,0);"
ok 8 - "exactsol = 0.5577;"
ok 9 - "check = double(abs(exactsol-Q) < 1e-3)"
ok 10 - "d = 3; f = @(x) 2^d*prod(x,2)+0.555; hyperbox =[zeros(1,d); ones(1,d)];"
ok 11 - "in_param.abstol = 1e-3; in_param.reltol = 1e-3;"
ok 12 - "Q = cubMC_g(f,hyperbox,in_param);"
ok 13 - "exactsol = 1.555;"
ok 14 - "check = double(abs(exactsol-Q) < max(1e-3,1e-3*abs(exactsol)))"
ok 15 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-inf -inf;inf inf];"
ok 16 - "Q = cubMC_g(f,hyperbox,'normal',0,1e-2);"
ok 17 - "exactsol = 1/3;"
ok 18 - "check = double(abs(exactsol-Q) < max(0,1e-2*abs(exactsol)))"
ok 19 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1];"
ok 20 - "Q = cubMC_g(f,hyperbox,'uniform ball','abstol',1e-3,'reltol',1e-3);"
ok 21 - "exactsol = pi/2;"
ok 22 - "check = double(abs(exactsol-Q) < max(1e-3,1e-3*abs(exactsol)))"
time =
    2.0718
TAP version 13
1..21
ok 1 - "f = @(x) prod(x,2); hyperbox = [zeros(1,2);ones(1,2)];"
ok 2 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0,'transform','C1sin'); exactsol = 1/4;"
ok 3 - "check = double(abs(exactsol-q) < 1e-5)"
ok 4 - "f = @(x) x(:,1).^2.*x(:,2).^2.*x(:,3).^2; hyperbox = [-inf(1,3);inf(1,3)];"
ok 5 - "q = cubLattice_g(f,hyperbox,'normal',1e-3,1e-3,'transform','C1sin','shift',2^(-25)*ones(1,3)); exactsol = 1;"
ok 6 - "check = double(abs(exactsol-q) < max(1e-3,1e-3*abs(exactsol)))"
ok 7 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-ones(1,2);2*ones(1,2)];"
ok 8 - "q = cubLattice_g(f,hyperbox,'uniform',1e-3,1e-2,'transform','C1'); exactsol = 1/9*(sqrt(pi)/2*(erf(2)+erf(1)))^2;"
ok 9 - "check = double(abs(exactsol-q) < max(1e-3,1e-2*abs(exactsol)))"
ok 10 - "f = @(x) exp(-0.05^2/2)*max(100*exp(0.05*x)-100,0); hyperbox = [-inf(1,1);inf(1,1)];"
ok 11 - "q = cubLattice_g(f,hyperbox,'normal',1e-4,1e-2,'transform','C1sin'); price = normcdf(0.05)*100 - 0.5*100*exp(-0.05^2/2);"
ok 12 - "check = double(abs(price-q) < max(1e-4,1e-2*abs(price)))"
ok 13 - "f = @(x) 8*prod(x,2); hyperbox = [zeros(1,5);ones(1,5)];"
ok 14 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 15 - "check = double(abs(exactsol-q) < 1e-5)"
ok 16 - "f = @(x) 3./(5-4*(cos(2*pi*x))); hyperbox = [0;1];"
ok 17 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0,'transform','id'); exactsol = 1;"
ok 18 - "check = double(abs(exactsol-q) < 1e-5)"
ok 19 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1];"
ok 20 - "q = cubLattice_g(f,hyperbox,'uniform ball','abstol',1e-4,'reltol',0); exactsol = pi/2;"
ok 21 - "check = double(abs(exactsol-q) < 1e-4)"
time =
    1.3771

Running ut_cubLattice_g
.......
  Dim  FcnIdx       Q        f_true          Err      Sample Used      Stats  
-----------------------------------------------------------------------------------------------------
     1      1 +8.41471e-01 +8.41471e-01 9.37967e-08   1024             BothErrMet
     1      2 +7.85398e-01 +7.85398e-01 7.21102e-08   1024             BothErrMet
     1      3 +3.75001e-01 +3.75000e-01 5.10576e-07   1024             BothErrMet
     1      4 +7.46824e-01 +7.46824e-01 1.15481e-07   1024             BothErrMet
     1      5 +6.32121e-01 +6.32121e-01 5.50880e-08   1024             BothErrMet
     2      1 +4.96752e-01 +4.96751e-01 2.40111e-07   1024             BothErrMet
     2      2 +7.28296e-01 +7.28296e-01 1.12275e-07   1024             BothErrMet
     2      3 +1.01854e-01 +1.01852e-01 2.44932e-06   2048             BothErrMet
     2      4 +6.88992e-01 +6.88992e-01 2.28033e-07   1024             BothErrMet
     2      5 +4.97439e-01 +4.97440e-01 1.21948e-06   1024             BothErrMet
     3      1 +6.23593e-02 +6.23593e-02 5.75997e-08   2048             BothErrMet
     3      2 +6.62569e-01 +6.62570e-01 4.74167e-07   1024             BothErrMet
     3      3 +2.18414e-02 +2.17014e-02 1.40030e-04   1024             AbsErrMet
     3      4 +6.20903e-01 +6.20903e-01 8.40298e-07   1024             BothErrMet
     3      5 +3.83054e-01 +3.83055e-01 8.26405e-07   1024             BothErrMet
     4      1 -3.51763e-01 -3.51764e-01 5.11539e-07   4096             BothErrMet
     4      2 +5.88680e-01 +5.88680e-01 6.26715e-07   1024             BothErrMet
     4      3 +3.74062e-03 +3.80556e-03 6.49350e-05   1024             AbsErrMet
     4      4 +5.43378e-01 +5.43373e-01 4.72065e-06   1024             BothErrMet
     4      5 +2.86990e-01 +2.86844e-01 1.46654e-04   1024             BothErrMet
     5      1 -6.49338e-01 -6.49331e-01 6.56300e-06   4096             BothErrMet
     5      2 +5.13394e-01 +5.13409e-01 1.54960e-05   1024             BothErrMet
     5      3 +5.62676e-04 +5.67130e-04 4.45365e-06   1024             AbsErrMet
     5      4 +4.64609e-01 +4.64603e-01 6.20218e-06   2048             BothErrMet
     5      5 +2.09894e-01 +2.09952e-01 5.80458e-05   1024             BothErrMet
     6      1 -7.69110e-01 -7.69376e-01 2.66271e-04   8192             BothErrMet
     6      2 +4.41469e-01 +4.41474e-01 5.14436e-06   2048             BothErrMet
     6      3 +6.44952e-05 +7.34937e-05 8.99850e-06   1024             AbsErrMet
     6      4 +3.90257e-01 +3.90227e-01 2.91144e-05   2048             BothErrMet
     6      5 +1.50915e-01 +1.50939e-01 2.36316e-05   2048             BothErrMet
     7      1 -6.97857e-01 -6.97824e-01 3.31931e-05   8192             BothErrMet
     7      2 +3.75534e-01 +3.75484e-01 5.01802e-05   2048             BothErrMet
     7      3 +6.41155e-06 +8.42590e-06 2.01435e-06   1024             AbsErrMet
     7      4 +3.23302e-01 +3.23235e-01 6.63189e-05   2048             BothErrMet
     7      5 +1.06996e-01 +1.06978e-01 1.78653e-05   2048             BothErrMet
     8      1 -4.67014e-01 -4.67036e-01 2.15915e-05  16384             BothErrMet
     8      2 +3.16605e-01 +3.16602e-01 2.74858e-06   2048             BothErrMet
     8      3 +6.57235e-07 +8.66209e-07 2.08974e-07   1024             AbsErrMet
     8      4 +2.64849e-01 +2.64801e-01 4.77950e-05   2048             BothErrMet
     8      5 +7.48797e-02 +7.49531e-02 7.34399e-05   1024             BothErrMet
.
Done ut_cubLattice_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   3.0948 seconds testing time.
   100% Passed.
                                     Name   Passed   Failed Incomplete   Duration
        ut_cubLattice_g/cubLattice_gOfsin        1        0          0     0.0122
        ut_cubLattice_g/cubLattice_gOfexp        1        0          0     0.0128
ut_cubLattice_g/cubLattice_gOfmultierrfun        1        0          0     0.0165
    ut_cubLattice_g/cubLattice_gOfxsquare        1        0          0     0.0170
    ut_cubLattice_g/cubLattice_gOdwarning        1        0          0     0.0306
    ut_cubLattice_g/cubLattice_gOfwarning        1        0          0     0.1299
      ut_cubLattice_g/cubLattice_Workouts        1        0          0     0.4922
       ut_cubLattice_g/cubLattice_gNormal        1        0          0     2.3836

TAP version 13
1..26
ok 1 - "f = @(x) prod(x,2); hyperbox = [zeros(1,2);ones(1,2)];"
ok 2 - "q = cubSobol_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 3 - "check = double(abs(exactsol-q) < 1e-5)"
ok 4 - "f = @(x) x(:,1).^2.*x(:,2).^2.*x(:,3).^2; "
ok 5 - "hyperbox = [-inf(1,3);inf(1,3)]; exactsol = 1;"
ok 6 - "q = cubSobol_g(f,hyperbox,'normal',1e-3,1e-3, 'fudge',@(m) 10*2.^-m); "
ok 7 - "check = double(abs(exactsol-q) < max(1e-3,1e-3*abs(exactsol)))"
ok 8 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-ones(1,2);2*ones(1,2)];"
ok 9 - "q = cubSobol_g(f,hyperbox,'uniform',1e-3,1e-2); "
ok 10 - "exactsol = 1/9*(sqrt(pi)/2*(erf(2)+erf(1)))^2;"
ok 11 - "check = double(abs(exactsol-q) < max(1e-3,1e-2*abs(exactsol)))"
ok 12 - "f = @(x) exp(-0.05^2/2)*max(100*exp(0.05*x)-100,0); "
ok 13 - "hyperbox = [-inf(1,1);inf(1,1)];"
ok 14 - "q = cubSobol_g(f,hyperbox,'normal',1e-4,1e-2); "
ok 15 - "price = normcdf(0.05)*100 - 0.5*100*exp(-0.05^2/2);"
ok 16 - "check = double(abs(price-q) < max(1e-4,1e-2*abs(price)))"
ok 17 - "f = @(x) 8*prod(x,2); hyperbox = [zeros(1,5);ones(1,5)];"
ok 18 - "q = cubSobol_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 19 - "check = double(abs(exactsol-q) < 1e-5)"
ok 20 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1]; exactsol = pi/2;"
ok 21 - "q = cubSobol_g(f,hyperbox,'uniform ball','abstol',1e-4,'reltol',0); "
ok 22 - "check = double(abs(exactsol-q) < 1e-4)"
ok 23 - "g.func = @(x) [10*x(:,1)-5*x(:,2).^2+1*x(:,3).^3, x(:,1), x(:,2).^2];"
ok 24 - "g.cv = [1,4/3]; hyperbox= [zeros(1,3);2*ones(1,3)];"
ok 25 - "q = cubSobol_g(g,hyperbox,'uniform',1e-6,0); exactsol = 16/3;"
ok 26 - "check = double(abs(exactsol-q) < 1e-6)"
time =
   1.461130000000000

Running ut_cubSobol_g
.........Dim   FcnIdx       Q             f_true               Err            Sample Used             Stats  
-----------------------------------------------------------------------------------------------------
1     1       8.41471e-01       8.41471e-01       1.91709e-09         1024             BothErrMet
1     2       7.85399e-01       7.85398e-01       7.71554e-07         1024             BothErrMet
2     1       4.96758e-01       4.96751e-01       6.45572e-06         1024             BothErrMet
2     2       7.28296e-01       7.28296e-01       2.40469e-07         1024             BothErrMet
3     1       6.23465e-02       6.23593e-02       1.27815e-05         1024             BothErrMet
3     2       6.62569e-01       6.62570e-01       4.85014e-07         1024             BothErrMet
.
Done ut_cubSobol_g
__________

Totals:
   10 Passed, 0 Failed, 0 Incomplete.   1.582 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
           ut_cubSobol_g/cubSobol_gOfsin        1        0          0     0.0103
           ut_cubSobol_g/cubSobol_gOfexp        1        0          0     0.0109
    ut_cubSobol_g/cubSobol_gOfmultierfcv        1        0          0     0.0164
   ut_cubSobol_g/cubSobol_gOfmultierrfun        1        0          0     0.0172
        ut_cubSobol_g/cubSobol_gOfpolycv        1        0          0     0.0261
       ut_cubSobol_g/cubSobol_gOfxsquare        1        0          0     0.0376
       ut_cubSobol_g/cubSobol_gOdwarning        1        0          0     0.0403
       ut_cubSobol_g/cubSobol_gOfwarning        1        0          0     0.1412
         ut_cubSobol_g/cubSobol_Workouts        1        0          0     0.1483
    ut_cubSobol_g/cubSobol_gOfgmeanOptcv        1        0          0     1.1339

TAP version 13
1..2
ok 1 - "obj = assetPath"
ok 2 - "obj = assetPath"
time =
    0.9954
TAP version 13
1..2
ok 1 - "obj = optPayoff"
ok 2 - "obj = optPayoff"
time =
    0.8152
TAP version 13
1..2
ok 1 - "obj = optPrice"
ok 2 - "obj = optPrice"
time =
    0.7705
TAP version 13
1..2
ok 1 - "obj = brownianMotion"
ok 2 - "obj = brownianMotion"
time =
    0.6383
TAP version 13
1..1
ok 1 - "obj = stochProcess"
time =
    0.5134
TAP version 13
1..2
ok 1 - "obj = whiteNoise"
ok 2 - "obj = whiteNoise"
time =
    0.5260
TAP version 13
1..4
ok 1 - "errParamObj = gail.errorParam"
ok 2 - "errParamObj = gail.errorParam(0.001)"
ok 3 - "errParamObj = gail.errorParam('relTol',0.1)"
ok 4 - "newErrParamObj = gail.errorParam(errParamObj,'relTol',0.001)"
time =
    0.5493
TAP version 13
1..12
ok 1 - "fParamObj = gail.fParam"
ok 2 - "fParamObj = gail.fParam(@(x) sum(x.^3.2),[0 0; 1 1])"
ok 3 - "fParamObj = gail.fParam(@(x) sum(x.^3.2),[0 0; 1 1],'ball')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.relTol = 0.1;"
ok 7 - "fParamObj = gail.fParam(inpStruct)"
ok 8 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 9 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 10 - "inpStruct.relTol = 0.1;"
ok 11 - "fParamObj = gail.fParam(inpStruct,0.0001,0.01)"
ok 12 - "newfParamObj = gail.fParam(fParamObj,'domainType','sphere')"
time =
    0.5337
TAP version 13
1..8
ok 1 - "cubParamObj = gail.cubParam"
ok 2 - "cubParamObj = gail.cubParam(@(x) sum(x.^3.2),[0 0; 2 2],'box','Lebesgue')"
ok 3 - "cubParamObj = gail.cubParam('domain', [-Inf -Inf; Inf Inf], 'f', @(x) sum(x.^3.2), 'relTol', 0.1, 'measure', 'Gaussian')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.nInit = 2048;"
ok 7 - "cubParamObj = gail.cubParam(inpStruct)"
ok 8 - "NewCubParamObj = gail.cubParam(cubParamObj,'measure','Lebesgue')"
time =
    0.6566
TAP version 13
1..5
ok 1 - "cubParamObj = gail.cubParam; %an input object"
ok 2 - "cubOutObj = gail.cubOut(cubParamObj); %copied to becom an output object"
ok 3 - "cubOutObj.mu = 1.467; %integral value is recorded"
ok 4 - "cubOutObj.nSample = 31415926; %sample size is recorded"
ok 5 - "cubOutObj.time = 0.0278 %time of computation is recorded"
time =
    0.5490
TAP version 13
1..7
ok 1 - "cubLatticeParamObj = gail.cubLatticeParam"
ok 2 - "cubLatticeParamObj = gail.cubLatticeParam('domain', [-2 -2; 2 2], 'f', @(x) sum(x.^3.2), 'relTol', 0.1, 'isShift', false)"
ok 3 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 4 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 5 - "inpStruct.isShift = false;"
ok 6 - "cubLatticeParamObj = gail.cubLatticeParam(inpStruct)"
ok 7 - "NewCubLatticeParamObj = gail.cubLatticeParam(cubLatticeParamObj,'measure','Lebesgue')"
time =
    0.5101
TAP version 13
1..8
ok 1 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam"
ok 2 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam(@(x) sum(x.^3.2),[0 0; 2 2])"
ok 3 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam('domain', [0 0; 1 1], 'f', @(x) sum(x.^3.2), 'relTol', 0.1,'kerName','Ber4')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.kerName = 'Ber4';"
ok 7 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam(inpStruct)"
ok 8 - "NewCubBayesLatticeParamObj = gail.cubBayesLatticeParam(cubBayesLatticeParamObj,'GPMean',0)"
time =
    0.5886
TAP version 13
1..5
ok 1 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam; %an input object"
ok 2 - "cubBayesLatticeOutObj = gail.cubBayesLatticeOut(cubBayesLatticeParamObj); %copied to becom an output object"
ok 3 - "cubBayesLatticeOutObj.mu = 1.467; %integral value is recorded"
ok 4 - "cubBayesLatticeOutObj.nSample = 31415926; %sample size is recorded"
ok 5 - "cubBayesLatticeOutObj.time = 0.0278 %time of computation is recorded"
time =
    0.5627
TAP version 13
1..8
ok 1 - "meanYParamObj = gail.meanYParam"
ok 2 - "meanYParamObj = gail.meanYParam(@(n) sum(rand(n,4).^3,2),0.001)"
ok 3 - "meanYParamObj = gail.meanYParam('nSig', 1e4, 'Y', @(n)sin(sum(rand(n,4).^3,2)), 'relTol', 0.1)"
ok 4 - "inpStruct.Y = @(n) sin(sum(rand(n,2),2));"
ok 5 - "inpStruct.nSig = 1e4;"
ok 6 - "inpStruct.relTol = 0.1;"
ok 7 - "meanYParamObj = gail.meanYParam(inpStruct)"
ok 8 - "NewMeanYParamObj = gail.meanYParam(meanYParamObj,'Y',@(n) rand(n,3))"
time =
    0.6642
TAP version 13
1..7
ok 1 - "meanParamObj = gail.meanYParam; %an input object"
ok 2 - "meanOutObj = gail.meanYOut(meanParamObj); %copied to becom an output object"
ok 3 - "meanOutObj.sol = 1.467; %integral value is recorded"
ok 4 - "meanOutObj.stddev = 1.23; %standard deviation is recorded"
ok 5 - "meanOutObj.nSample = 31415926; %sample size is recorded"
ok 6 - "meanOutObj.time = 0.0278; %time of computation is recorded"
ok 7 - "meanOutObj.errBd = 0.000456 %error bound is recorded"
time =
    0.6001
total_time =
   39.5896
>> gailpbs_tests: Input arg R2018a

                            < M A T L A B (R) >
                  Copyright 1984-2018 The MathWorks, Inc.
                   R2018a (9.4.0.813654) 64-bit (glnxa64)
                             February 23, 2018

 
To get started, type one of these: helpwin, helpdesk, or demo.
For product information, visit www.mathworks.com.
 
>> >> >> >> 
Welcome to Guaranteed Automatic Integration Library (GAIL).
You are installing GAIL v2.3.1.

[Warning: Unable to save path to file
'/share/apps/matlab/R2018a/toolbox/local/pathdef.m'. You can save your path to
a different location by calling SAVEPATH with an input argument that specifies
the full path. For MATLAB to use that path in future sessions, save the path to
'pathdef.m' in your MATLAB startup folder.] 
[> In savepath (line 176)
  In GAIL_Install (line 20)] 

GAIL version 2.3.1 has been installed successfully.

>> >> >> >> GAILVERSION = 2.3.1.  MATLABVERSION = 9.4
TAP version 13
1..30
ok 1 - "help cubBayesLattice_g"
ok 2 - "warning('off','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 3 - "[~,muhat] = cubBayesLattice_g;"
ok 4 - "exactInteg = 1.0/3;"
ok 5 - "warning('on','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 6 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 7 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 8 - "dim=2; absTol=1e-2; relTol=1e-2;"
ok 9 - "exactInteg = besseli(0,1)^dim;"
ok 10 - "inputArgs = {'relTol',relTol, 'order',2, 'ptransform','C1sin'};"
ok 11 - "inputArgs = [{fun, dim, 'absTol',absTol,'oneTheta',false} inputArgs];"
ok 12 - "obj=cubBayesLattice_g(inputArgs{:});"
ok 13 - "[muhat,outParams]=compInteg(obj);"
ok 14 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
ok 15 - "etaDim = size(outParams.optParams.aMLEAll, 2)"
ok 16 - "help cubBayesLattice_g"
ok 17 - "warning('off','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 18 - "[~,muhat] = cubBayesLattice_g;"
ok 19 - "exactInteg = 1.0/3;"
ok 20 - "warning('on','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 21 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 22 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 23 - "dim=2; absTol=1e-2; relTol=1e-2;"
ok 24 - "exactInteg = besseli(0,1)^dim;"
ok 25 - "inputArgs = {'relTol',relTol, 'order',2, 'ptransform','C1sin'};"
ok 26 - "inputArgs = [{fun, dim, 'absTol',absTol,'oneTheta',false} inputArgs];"
ok 27 - "obj=cubBayesLattice_g(inputArgs{:});"
ok 28 - "[muhat,outParams]=compInteg(obj);"
ok 29 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
ok 30 - "etaDim = size(outParams.optParams.aMLEAll, 2)"
time =
    6.3126
TAP version 13
1..3
ok 1 - "q = integral_g(@(x) x.^2)"
ok 2 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',1,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 3 - "q = integral_g()"
time =
    0.2342
TAP version 13
1..17
ok 1 - "f = @(x) exp(-(x-1).^2); q = integral_g(f,'a',1,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 2 - "f = @(x) exp(-x.^2); q = integral_g(f,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 3 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',1,'b',2,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 4 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',2,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 5 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 6 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',3,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 7 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',-1,'b',3,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 8 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',-4.5,'b',1.5,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 9 - "q = integral_g(@(x)x.^2,'a',1)"
ok 10 - "q = integral_g(@(x)x.^2,'a',0,'b',Inf)"
ok 11 - "q = integral_g(@(x)x.^2,'a',Inf)"
ok 12 - "q = integral_g(@(x)x.^2,'a',NaN)"
ok 13 - "q = integral_g(@(x)x.^2,'a',0,'b',NaN)"
ok 14 - "q = integral_g(@(x)x.^2,'a',1,'b',0)"
ok 15 - "q = integral_g(@(x)x.^2,'a',0,'b',2,'nlo',10,'nhi',100)"
ok 16 - " inparam.a=0; inparam.b=3; inparam.abstol=1e-13; q=integral_g(@(x) exp(2*x),inparam)"
ok 17 - "q = integral_g(@(x) x.^2,'a',-1,'b',1)"
time =
    0.1147

Running ut_integral_g
........
Done ut_integral_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   0.073547 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
      ut_integral_g/testerrorfabstolnmax        1        0          0     0.0021
          ut_integral_g/testsinefunction        1        0          0     0.0021
                ut_integral_g/testerrorf        1        0          0     0.0038
           ut_integral_g/testerrorfninit        1        0          0     0.0045
            ut_integral_g/testerrorfnamx        1        0          0     0.0060
          ut_integral_g/testerrorOfExp2x        1        0          0     0.0103
     ut_integral_g/testerrorfabstolninit        1        0          0     0.0105
          ut_integral_g/testerrorfabstol        1        0          0     0.0344

TAP version 13
1..7
ok 1 - "f = @(x) x.^2;"
ok 2 - "[~, out_param] = funappx_g(f,-2,2,1e-7,18)"
ok 3 - "f = @(x) x.^2;"
ok 4 - "[~, out_param] = funappx_g(f,'a',-2,'b',2,'ninit',17)"
ok 5 - "in_param.a = -5; in_param.b = 5; f = @(x) x.^2;"
ok 6 - "in_param.abstol = 10^(-6); in_param.ninit=18;"
ok 7 - "[~, out_param] = funappx_g(f,in_param)"
time =
    0.1871
TAP version 13
1..11
ok 1 - "funappx_g"
ok 2 - "clear in_param; in_param.a = -5; in_param.b =5; in_param.abstol = 10^(-7); "
ok 3 - "[~, out_param] = funappx_g(@(x) x.^2, in_param)"
ok 4 - "clear in_param; f = @(x) sin(x); in_param.a = -1; in_param.b = 1; "
ok 5 - "in_param.abstol = 10^(-8); in_param.ninit = 20; "
ok 6 - "[~, out_param] = funappx_g(f, in_param)"
ok 7 - "[~, out_param] = funappx_g(@(x) x.^3,'a',-2,'b',2,'abstol',1e-7,'ninit',41)"
ok 8 - "[~, out_param] = funappx_g(@(x) exp(-100*(x-0.7).^2),'a',0,'b',1,'ninit',28)"
ok 9 - "[~, out_param] = funappx_g(@(x) x.^2,'memorytest',1,'output_x',1);"
ok 10 - "out_param.bytes <= 280674"
ok 11 - "length(out_param.x) == out_param.npoints"
time =
    0.3499

Running ut_funappx_g
..........
.......
Done ut_funappx_g
__________

Totals:
   17 Passed, 0 Failed, 0 Incomplete.   1.4497 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
             ut_funappx_g/funappx_gOfxab        1        0          0     0.0069
       ut_funappx_g/funappx_gOfxsquareab        1        0          0     0.0082
         ut_funappx_g/funappx_gOf100000x        1        0          0     0.0120
               ut_funappx_g/funappx_gOfx        1        0          0     0.0136
   ut_funappx_g/funappx_gOfexponentialab        1        0          0     0.0150
  ut_funappx_g/funappx_gOnpointsoflinear        1        0          0     0.0161
           ut_funappx_g/funappx_gOfsinab        1        0          0     0.0166
             ut_funappx_g/funappx_gOfsin        1        0          0     0.0177
         ut_funappx_g/funappx_gOfxsquare        1        0          0     0.0186
ut_funappx_g/funappx_gOnpointsofconstant        1        0          0     0.0286
    ut_funappx_g/funappx_gOfexceedbudget        1        0          0     0.0437
            ut_funappx_g/funappx_gOfbeqa        1        0          0     0.0475
     ut_funappx_g/funappx_gOfexponential        1        0          0     0.0758
      ut_funappx_g/funappx_gOfexceediter        1        0          0     0.0805
      ut_funappx_g/funappx_gOfnofunction        1        0          0     0.0837
            ut_funappx_g/funappx_gOfblea        1        0          0     0.3644
ut_funappx_g/funappx_gofConstantFunction        1        0          0     0.6007

TAP version 13
1..12
ok 1 - "f = @(x) exp(0.01*(x-0.5).^2); [fmin,out_param] = funmin_g(f)"
ok 2 - "f = @(x) exp(0.01*(x-0.5).^2);"
ok 3 - "[fmin,out_param] = funmin_g(f,-2,2,1e-7,10,1000000)"
ok 4 - "f=@(x) exp(0.01*(x-0.5).^2);"
ok 5 - "in_param.a = -13; in_param.b = 8;"
ok 6 - "in_param.abstol = 10^(-7);"
ok 7 - "in_param.ninit = 100;"
ok 8 - "in_param.nmax = 10^6;"
ok 9 - "[fmin,out_param] = funmin_g(f,in_param)"
ok 10 - "f=@(x) exp(0.01*(x-0.5).^2);"
ok 11 - "[fmin,out_param] = funmin_g(f,'a',-2,'b',2,'ninit',64,'nmax',1e6,'abstol',1e-5)"
ok 12 - "out_param(:).intervals"
time =
    0.1754

Running ut_funmin_g
........
Done ut_funmin_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   0.83254 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
                ut_funmin_g/funmin_gEXM6        1        0          0     0.0087
                ut_funmin_g/funmin_gEXM3        1        0          0     0.0091
                ut_funmin_g/funmin_gEXM7        1        0          0     0.0138
                ut_funmin_g/funmin_gEXM5        1        0          0     0.0143
                ut_funmin_g/funmin_gEXM2        1        0          0     0.0147
                ut_funmin_g/funmin_gEXM1        1        0          0     0.0545
                ut_funmin_g/funmin_gEXM4        1        0          0     0.1776
                ut_funmin_g/funmin_gEXM8        1        0          0     0.5398


Running ut_funmin_g_end
..
Done ut_funmin_g_end
__________

Totals:
   2 Passed, 0 Failed, 0 Incomplete.   0.050609 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
            ut_funmin_g_end/funmin_gEXM2        1        0          0     0.0107
            ut_funmin_g_end/funmin_gEXM1        1        0          0     0.0399

TAP version 13
1..10
ok 1 - "meanMC_g"
ok 2 - "in_param.reltol = 0; in_param.abstol = 1e-3;"
ok 3 - "in_param.alpha = 0.05; Yrand=@(n) rand(n,1).^2;"
ok 4 - "tmu = meanMC_g(Yrand,in_param); exactsol = 1/3;"
ok 5 - "check = double(abs(exactsol-tmu) < 1e-3)"
ok 6 - "tmu = meanMC_g(@(n)exp(rand(n,1)),1e-3,0); exactsol = exp(1)-1;"
ok 7 - "check = double(abs(exactsol-tmu) < 1e-3)"
ok 8 - "tmu = meanMC_g(@(n)cos(rand(n,1)),'reltol',1e-3,'abstol',1e-4,'alpha',0.01);"
ok 9 - "exactsol = sin(1);"
ok 10 - "check = double(abs(exactsol-tmu) < max(1e-3,1e-2*abs(exactsol)))"
time =
    0.0374

Running ut_meanMC_g
......
Done ut_meanMC_g
__________

Totals:
   6 Passed, 0 Failed, 0 Incomplete.   1.9451 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
               ut_meanMC_g/meanMC_gOfsin        1        0          0     0.0121
           ut_meanMC_g/meanMC_gOfxsquare        1        0          0     0.0175
    ut_meanMC_g/meanMC_gOfnonRandomInput        1        0          0     0.0241
           ut_meanMC_g/meanMC_gOfparsing        1        0          0     0.0250
               ut_meanMC_g/meanMC_gOfexp        1        0          0     0.0472
          ut_meanMC_g/meanMC_gOfWorkouts        1        0          0     1.8192

TAP version 13
1..22
ok 1 - "cubMC_g"
ok 2 - "f = @(x) sin(x); interval = [1;2];"
ok 3 - "Q = cubMC_g(f,interval,'uniform',1e-3,1e-2);"
ok 4 - "exactsol = 0.9564;"
ok 5 - "check = double(abs(exactsol-Q) < max(1e-3,1e-2*abs(exactsol)))"
ok 6 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [0 0;1 1];"
ok 7 - "Q = cubMC_g(f,hyperbox,'uniform',1e-3,0);"
ok 8 - "exactsol = 0.5577;"
ok 9 - "check = double(abs(exactsol-Q) < 1e-3)"
ok 10 - "d = 3; f = @(x) 2^d*prod(x,2)+0.555; hyperbox =[zeros(1,d); ones(1,d)];"
ok 11 - "in_param.abstol = 1e-3; in_param.reltol = 1e-3;"
ok 12 - "Q = cubMC_g(f,hyperbox,in_param);"
ok 13 - "exactsol = 1.555;"
ok 14 - "check = double(abs(exactsol-Q) < max(1e-3,1e-3*abs(exactsol)))"
ok 15 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-inf -inf;inf inf];"
ok 16 - "Q = cubMC_g(f,hyperbox,'normal',0,1e-2);"
ok 17 - "exactsol = 1/3;"
ok 18 - "check = double(abs(exactsol-Q) < max(0,1e-2*abs(exactsol)))"
ok 19 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1];"
ok 20 - "Q = cubMC_g(f,hyperbox,'uniform ball','abstol',1e-3,'reltol',1e-3);"
ok 21 - "exactsol = pi/2;"
ok 22 - "check = double(abs(exactsol-Q) < max(1e-3,1e-3*abs(exactsol)))"
time =
    0.7944
TAP version 13
1..21
ok 1 - "f = @(x) prod(x,2); hyperbox = [zeros(1,2);ones(1,2)];"
ok 2 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0,'transform','C1sin'); exactsol = 1/4;"
ok 3 - "check = double(abs(exactsol-q) < 1e-5)"
ok 4 - "f = @(x) x(:,1).^2.*x(:,2).^2.*x(:,3).^2; hyperbox = [-inf(1,3);inf(1,3)];"
ok 5 - "q = cubLattice_g(f,hyperbox,'normal',1e-3,1e-3,'transform','C1sin','shift',2^(-25)*ones(1,3)); exactsol = 1;"
ok 6 - "check = double(abs(exactsol-q) < max(1e-3,1e-3*abs(exactsol)))"
ok 7 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-ones(1,2);2*ones(1,2)];"
ok 8 - "q = cubLattice_g(f,hyperbox,'uniform',1e-3,1e-2,'transform','C1'); exactsol = 1/9*(sqrt(pi)/2*(erf(2)+erf(1)))^2;"
ok 9 - "check = double(abs(exactsol-q) < max(1e-3,1e-2*abs(exactsol)))"
ok 10 - "f = @(x) exp(-0.05^2/2)*max(100*exp(0.05*x)-100,0); hyperbox = [-inf(1,1);inf(1,1)];"
ok 11 - "q = cubLattice_g(f,hyperbox,'normal',1e-4,1e-2,'transform','C1sin'); price = normcdf(0.05)*100 - 0.5*100*exp(-0.05^2/2);"
ok 12 - "check = double(abs(price-q) < max(1e-4,1e-2*abs(price)))"
ok 13 - "f = @(x) 8*prod(x,2); hyperbox = [zeros(1,5);ones(1,5)];"
ok 14 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 15 - "check = double(abs(exactsol-q) < 1e-5)"
ok 16 - "f = @(x) 3./(5-4*(cos(2*pi*x))); hyperbox = [0;1];"
ok 17 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0,'transform','id'); exactsol = 1;"
ok 18 - "check = double(abs(exactsol-q) < 1e-5)"
ok 19 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1];"
ok 20 - "q = cubLattice_g(f,hyperbox,'uniform ball','abstol',1e-4,'reltol',0); exactsol = pi/2;"
ok 21 - "check = double(abs(exactsol-q) < 1e-4)"
time =
    0.7868

Running ut_cubLattice_g
.......
  Dim  FcnIdx       Q        f_true          Err      Sample Used      Stats  
-----------------------------------------------------------------------------------------------------
     1      1 +8.41471e-01 +8.41471e-01 1.28269e-07   1024             BothErrMet
     1      2 +7.85398e-01 +7.85398e-01 3.62707e-08   1024             BothErrMet
     1      3 +3.75000e-01 +3.75000e-01 4.36241e-07   1024             BothErrMet
     1      4 +7.46824e-01 +7.46824e-01 1.99168e-07   1024             BothErrMet
     1      5 +6.32121e-01 +6.32121e-01 9.75604e-08   1024             BothErrMet
     2      1 +4.96751e-01 +4.96751e-01 9.39825e-07   1024             BothErrMet
     2      2 +7.28296e-01 +7.28296e-01 5.05414e-07   1024             BothErrMet
     2      3 +1.01854e-01 +1.01852e-01 1.94901e-06   2048             BothErrMet
     2      4 +6.88991e-01 +6.88992e-01 3.82925e-07   1024             BothErrMet
     2      5 +4.97440e-01 +4.97440e-01 1.35858e-07   1024             BothErrMet
     3      1 +6.23594e-02 +6.23593e-02 4.21491e-08   2048             BothErrMet
     3      2 +6.62569e-01 +6.62570e-01 1.75593e-07   1024             BothErrMet
     3      3 +2.16210e-02 +2.17014e-02 8.03864e-05   1024             AbsErrMet
     3      4 +6.20902e-01 +6.20903e-01 1.16048e-06   1024             BothErrMet
     3      5 +3.83059e-01 +3.83055e-01 4.21199e-06   1024             BothErrMet
     4      1 -3.51760e-01 -3.51764e-01 4.10885e-06   4096             BothErrMet
     4      2 +5.88680e-01 +5.88680e-01 8.20614e-07   1024             BothErrMet
     4      3 +4.06761e-03 +3.80556e-03 2.62056e-04   1024             AbsErrMet
     4      4 +5.43399e-01 +5.43373e-01 2.62480e-05   1024             BothErrMet
     4      5 +2.86937e-01 +2.86844e-01 9.35056e-05   1024             BothErrMet
     5      1 -6.49344e-01 -6.49331e-01 1.28087e-05   4096             BothErrMet
     5      2 +5.13389e-01 +5.13409e-01 2.04832e-05   1024             BothErrMet
     5      3 +5.74770e-04 +5.67130e-04 7.64001e-06   1024             AbsErrMet
     5      4 +4.64588e-01 +4.64603e-01 1.52391e-05   2048             BothErrMet
     5      5 +2.10016e-01 +2.09952e-01 6.38825e-05   1024             BothErrMet
     6      1 -7.69102e-01 -7.69376e-01 2.74908e-04   8192             BothErrMet
     6      2 +4.41471e-01 +4.41474e-01 2.27142e-06   2048             BothErrMet
     6      3 +6.69867e-05 +7.34937e-05 6.50696e-06   1024             AbsErrMet
     6      4 +3.90235e-01 +3.90227e-01 7.21284e-06   2048             BothErrMet
     6      5 +1.51008e-01 +1.50939e-01 6.90128e-05   2048             BothErrMet
     7      1 -6.97216e-01 -6.97824e-01 6.08136e-04   8192             BothErrMet
     7      2 +3.75505e-01 +3.75484e-01 2.13349e-05   2048             BothErrMet
     7      3 +6.33188e-06 +8.42590e-06 2.09402e-06   1024             AbsErrMet
     7      4 +3.23172e-01 +3.23235e-01 6.34074e-05   2048             BothErrMet
     7      5 +1.06916e-01 +1.06978e-01 6.23692e-05   2048             BothErrMet
     8      1 -4.66757e-01 -4.67036e-01 2.78505e-04  16384             BothErrMet
     8      2 +3.16551e-01 +3.16602e-01 5.10272e-05   2048             BothErrMet
     8      3 +7.11862e-07 +8.66209e-07 1.54346e-07   1024             AbsErrMet
     8      4 +2.64745e-01 +2.64801e-01 5.62568e-05   4096             BothErrMet
     8      5 +7.50169e-02 +7.49531e-02 6.37062e-05   1024             BothErrMet
.
Done ut_cubLattice_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   2.6153 seconds testing time.
   100% Passed.
                                     Name   Passed   Failed Incomplete   Duration
        ut_cubLattice_g/cubLattice_gOfsin        1        0          0     0.0086
        ut_cubLattice_g/cubLattice_gOfexp        1        0          0     0.0091
    ut_cubLattice_g/cubLattice_gOfxsquare        1        0          0     0.0224
ut_cubLattice_g/cubLattice_gOfmultierrfun        1        0          0     0.0238
    ut_cubLattice_g/cubLattice_gOdwarning        1        0          0     0.0271
    ut_cubLattice_g/cubLattice_gOfwarning        1        0          0     0.0447
      ut_cubLattice_g/cubLattice_Workouts        1        0          0     0.5958
       ut_cubLattice_g/cubLattice_gNormal        1        0          0     1.8838

TAP version 13
1..26
ok 1 - "f = @(x) prod(x,2); hyperbox = [zeros(1,2);ones(1,2)];"
ok 2 - "q = cubSobol_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 3 - "check = double(abs(exactsol-q) < 1e-5)"
ok 4 - "f = @(x) x(:,1).^2.*x(:,2).^2.*x(:,3).^2; "
ok 5 - "hyperbox = [-inf(1,3);inf(1,3)]; exactsol = 1;"
ok 6 - "q = cubSobol_g(f,hyperbox,'normal',1e-3,1e-3, 'fudge',@(m) 10*2.^-m); "
ok 7 - "check = double(abs(exactsol-q) < max(1e-3,1e-3*abs(exactsol)))"
ok 8 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-ones(1,2);2*ones(1,2)];"
ok 9 - "q = cubSobol_g(f,hyperbox,'uniform',1e-3,1e-2); "
ok 10 - "exactsol = 1/9*(sqrt(pi)/2*(erf(2)+erf(1)))^2;"
ok 11 - "check = double(abs(exactsol-q) < max(1e-3,1e-2*abs(exactsol)))"
ok 12 - "f = @(x) exp(-0.05^2/2)*max(100*exp(0.05*x)-100,0); "
ok 13 - "hyperbox = [-inf(1,1);inf(1,1)];"
ok 14 - "q = cubSobol_g(f,hyperbox,'normal',1e-4,1e-2); "
ok 15 - "price = normcdf(0.05)*100 - 0.5*100*exp(-0.05^2/2);"
ok 16 - "check = double(abs(price-q) < max(1e-4,1e-2*abs(price)))"
ok 17 - "f = @(x) 8*prod(x,2); hyperbox = [zeros(1,5);ones(1,5)];"
ok 18 - "q = cubSobol_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 19 - "check = double(abs(exactsol-q) < 1e-5)"
ok 20 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1]; exactsol = pi/2;"
ok 21 - "q = cubSobol_g(f,hyperbox,'uniform ball','abstol',1e-4,'reltol',0); "
ok 22 - "check = double(abs(exactsol-q) < 1e-4)"
ok 23 - "g.func = @(x) [10*x(:,1)-5*x(:,2).^2+1*x(:,3).^3, x(:,1), x(:,2).^2];"
ok 24 - "g.cv = [1,4/3]; hyperbox= [zeros(1,3);2*ones(1,3)];"
ok 25 - "q = cubSobol_g(g,hyperbox,'uniform',1e-6,0); exactsol = 16/3;"
ok 26 - "check = double(abs(exactsol-q) < 1e-6)"
time =
   1.920844000000000

Running ut_cubSobol_g
.........Dim   FcnIdx       Q             f_true               Err            Sample Used             Stats  
-----------------------------------------------------------------------------------------------------
1     1       8.41471e-01       8.41471e-01       7.93487e-10         1024             BothErrMet
1     2       7.85520e-01       7.85398e-01       1.22070e-04         1024             BothErrMet
2     1       4.96752e-01       4.96751e-01       1.59514e-07         1024             BothErrMet
2     2       7.28296e-01       7.28296e-01       1.50460e-07         1024             BothErrMet
3     1       6.23572e-02       6.23593e-02       2.13548e-06         1024             BothErrMet
3     2       6.62549e-01       6.62570e-01       2.01317e-05         1024             BothErrMet
.
Done ut_cubSobol_g
__________

Totals:
   10 Passed, 0 Failed, 0 Incomplete.   1.4021 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
           ut_cubSobol_g/cubSobol_gOfsin        1        0          0     0.0097
           ut_cubSobol_g/cubSobol_gOfexp        1        0          0     0.0124
    ut_cubSobol_g/cubSobol_gOfmultierfcv        1        0          0     0.0161
   ut_cubSobol_g/cubSobol_gOfmultierrfun        1        0          0     0.0250
       ut_cubSobol_g/cubSobol_gOdwarning        1        0          0     0.0282
       ut_cubSobol_g/cubSobol_gOfxsquare        1        0          0     0.0298
        ut_cubSobol_g/cubSobol_gOfpolycv        1        0          0     0.0322
       ut_cubSobol_g/cubSobol_gOfwarning        1        0          0     0.0396
         ut_cubSobol_g/cubSobol_Workouts        1        0          0     0.1154
    ut_cubSobol_g/cubSobol_gOfgmeanOptcv        1        0          0     1.0937

TAP version 13
1..2
ok 1 - "obj = assetPath"
ok 2 - "obj = assetPath"
time =
    0.7573
TAP version 13
1..2
ok 1 - "obj = optPayoff"
ok 2 - "obj = optPayoff"
time =
    0.7015
TAP version 13
1..2
ok 1 - "obj = optPrice"
ok 2 - "obj = optPrice"
time =
    0.6899
TAP version 13
1..2
ok 1 - "obj = brownianMotion"
ok 2 - "obj = brownianMotion"
time =
    0.7129
TAP version 13
1..1
ok 1 - "obj = stochProcess"
time =
    0.5781
TAP version 13
1..2
ok 1 - "obj = whiteNoise"
ok 2 - "obj = whiteNoise"
time =
    0.5717
TAP version 13
1..4
ok 1 - "errParamObj = gail.errorParam"
ok 2 - "errParamObj = gail.errorParam(0.001)"
ok 3 - "errParamObj = gail.errorParam('relTol',0.1)"
ok 4 - "newErrParamObj = gail.errorParam(errParamObj,'relTol',0.001)"
time =
    0.4883
TAP version 13
1..12
ok 1 - "fParamObj = gail.fParam"
ok 2 - "fParamObj = gail.fParam(@(x) sum(x.^3.2),[0 0; 1 1])"
ok 3 - "fParamObj = gail.fParam(@(x) sum(x.^3.2),[0 0; 1 1],'ball')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.relTol = 0.1;"
ok 7 - "fParamObj = gail.fParam(inpStruct)"
ok 8 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 9 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 10 - "inpStruct.relTol = 0.1;"
ok 11 - "fParamObj = gail.fParam(inpStruct,0.0001,0.01)"
ok 12 - "newfParamObj = gail.fParam(fParamObj,'domainType','sphere')"
time =
    0.4396
TAP version 13
1..8
ok 1 - "cubParamObj = gail.cubParam"
ok 2 - "cubParamObj = gail.cubParam(@(x) sum(x.^3.2),[0 0; 2 2],'box','Lebesgue')"
ok 3 - "cubParamObj = gail.cubParam('domain', [-Inf -Inf; Inf Inf], 'f', @(x) sum(x.^3.2), 'relTol', 0.1, 'measure', 'Gaussian')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.nInit = 2048;"
ok 7 - "cubParamObj = gail.cubParam(inpStruct)"
ok 8 - "NewCubParamObj = gail.cubParam(cubParamObj,'measure','Lebesgue')"
time =
    0.5305
TAP version 13
1..5
ok 1 - "cubParamObj = gail.cubParam; %an input object"
ok 2 - "cubOutObj = gail.cubOut(cubParamObj); %copied to becom an output object"
ok 3 - "cubOutObj.mu = 1.467; %integral value is recorded"
ok 4 - "cubOutObj.nSample = 31415926; %sample size is recorded"
ok 5 - "cubOutObj.time = 0.0278 %time of computation is recorded"
time =
    0.4170
TAP version 13
1..7
ok 1 - "cubLatticeParamObj = gail.cubLatticeParam"
ok 2 - "cubLatticeParamObj = gail.cubLatticeParam('domain', [-2 -2; 2 2], 'f', @(x) sum(x.^3.2), 'relTol', 0.1, 'isShift', false)"
ok 3 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 4 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 5 - "inpStruct.isShift = false;"
ok 6 - "cubLatticeParamObj = gail.cubLatticeParam(inpStruct)"
ok 7 - "NewCubLatticeParamObj = gail.cubLatticeParam(cubLatticeParamObj,'measure','Lebesgue')"
time =
    0.4938
TAP version 13
1..8
ok 1 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam"
ok 2 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam(@(x) sum(x.^3.2),[0 0; 2 2])"
ok 3 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam('domain', [0 0; 1 1], 'f', @(x) sum(x.^3.2), 'relTol', 0.1,'kerName','Ber4')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.kerName = 'Ber4';"
ok 7 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam(inpStruct)"
ok 8 - "NewCubBayesLatticeParamObj = gail.cubBayesLatticeParam(cubBayesLatticeParamObj,'GPMean',0)"
time =
    0.5091
TAP version 13
1..5
ok 1 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam; %an input object"
ok 2 - "cubBayesLatticeOutObj = gail.cubBayesLatticeOut(cubBayesLatticeParamObj); %copied to becom an output object"
ok 3 - "cubBayesLatticeOutObj.mu = 1.467; %integral value is recorded"
ok 4 - "cubBayesLatticeOutObj.nSample = 31415926; %sample size is recorded"
ok 5 - "cubBayesLatticeOutObj.time = 0.0278 %time of computation is recorded"
time =
    0.4904
TAP version 13
1..8
ok 1 - "meanYParamObj = gail.meanYParam"
ok 2 - "meanYParamObj = gail.meanYParam(@(n) sum(rand(n,4).^3,2),0.001)"
ok 3 - "meanYParamObj = gail.meanYParam('nSig', 1e4, 'Y', @(n)sin(sum(rand(n,4).^3,2)), 'relTol', 0.1)"
ok 4 - "inpStruct.Y = @(n) sin(sum(rand(n,2),2));"
ok 5 - "inpStruct.nSig = 1e4;"
ok 6 - "inpStruct.relTol = 0.1;"
ok 7 - "meanYParamObj = gail.meanYParam(inpStruct)"
ok 8 - "NewMeanYParamObj = gail.meanYParam(meanYParamObj,'Y',@(n) rand(n,3))"
time =
    0.5712
TAP version 13
1..7
ok 1 - "meanParamObj = gail.meanYParam; %an input object"
ok 2 - "meanOutObj = gail.meanYOut(meanParamObj); %copied to becom an output object"
ok 3 - "meanOutObj.sol = 1.467; %integral value is recorded"
ok 4 - "meanOutObj.stddev = 1.23; %standard deviation is recorded"
ok 5 - "meanOutObj.nSample = 31415926; %sample size is recorded"
ok 6 - "meanOutObj.time = 0.0278; %time of computation is recorded"
ok 7 - "meanOutObj.errBd = 0.000456 %error bound is recorded"
time =
    0.5137
total_time =
   34.2489
>> gailpbs_tests: Input arg R2018b

                            < M A T L A B (R) >
                  Copyright 1984-2018 The MathWorks, Inc.
              R2018b Update 7 (9.5.0.1298439) 64-bit (glnxa64)
                              January 22, 2020

 
To get started, type doc.
For product information, visit www.mathworks.com.
 
>> >> >> >> 
Welcome to Guaranteed Automatic Integration Library (GAIL).
You are installing GAIL v2.3.1.

[Warning: Unable to save path to file
'/share/apps/matlab/R2018b/toolbox/local/pathdef.m'. You can save your path to
a different location by calling SAVEPATH with an input argument that specifies
the full path. For MATLAB to use that path in future sessions, save the path to
'pathdef.m' in your MATLAB startup folder.] 
[> In savepath (line 176)
  In GAIL_Install (line 20)] 

GAIL version 2.3.1 has been installed successfully.

>> >> >> >> GAILVERSION = 2.3.1.  MATLABVERSION = 9.5
TAP version 13
1..30
ok 1 - "help cubBayesLattice_g"
ok 2 - "warning('off','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 3 - "[~,muhat] = cubBayesLattice_g;"
ok 4 - "exactInteg = 1.0/3;"
ok 5 - "warning('on','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 6 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 7 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 8 - "dim=2; absTol=1e-2; relTol=1e-2;"
ok 9 - "exactInteg = besseli(0,1)^dim;"
ok 10 - "inputArgs = {'relTol',relTol, 'order',2, 'ptransform','C1sin'};"
ok 11 - "inputArgs = [{fun, dim, 'absTol',absTol,'oneTheta',false} inputArgs];"
ok 12 - "obj=cubBayesLattice_g(inputArgs{:});"
ok 13 - "[muhat,outParams]=compInteg(obj);"
ok 14 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
ok 15 - "etaDim = size(outParams.optParams.aMLEAll, 2)"
ok 16 - "help cubBayesLattice_g"
ok 17 - "warning('off','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 18 - "[~,muhat] = cubBayesLattice_g;"
ok 19 - "exactInteg = 1.0/3;"
ok 20 - "warning('on','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 21 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 22 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 23 - "dim=2; absTol=1e-2; relTol=1e-2;"
ok 24 - "exactInteg = besseli(0,1)^dim;"
ok 25 - "inputArgs = {'relTol',relTol, 'order',2, 'ptransform','C1sin'};"
ok 26 - "inputArgs = [{fun, dim, 'absTol',absTol,'oneTheta',false} inputArgs];"
ok 27 - "obj=cubBayesLattice_g(inputArgs{:});"
ok 28 - "[muhat,outParams]=compInteg(obj);"
ok 29 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
ok 30 - "etaDim = size(outParams.optParams.aMLEAll, 2)"
time =
    7.4981
TAP version 13
1..3
ok 1 - "q = integral_g(@(x) x.^2)"
ok 2 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',1,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 3 - "q = integral_g()"
time =
    0.2127
TAP version 13
1..17
ok 1 - "f = @(x) exp(-(x-1).^2); q = integral_g(f,'a',1,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 2 - "f = @(x) exp(-x.^2); q = integral_g(f,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 3 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',1,'b',2,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 4 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',2,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 5 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 6 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',3,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 7 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',-1,'b',3,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 8 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',-4.5,'b',1.5,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 9 - "q = integral_g(@(x)x.^2,'a',1)"
ok 10 - "q = integral_g(@(x)x.^2,'a',0,'b',Inf)"
ok 11 - "q = integral_g(@(x)x.^2,'a',Inf)"
ok 12 - "q = integral_g(@(x)x.^2,'a',NaN)"
ok 13 - "q = integral_g(@(x)x.^2,'a',0,'b',NaN)"
ok 14 - "q = integral_g(@(x)x.^2,'a',1,'b',0)"
ok 15 - "q = integral_g(@(x)x.^2,'a',0,'b',2,'nlo',10,'nhi',100)"
ok 16 - " inparam.a=0; inparam.b=3; inparam.abstol=1e-13; q=integral_g(@(x) exp(2*x),inparam)"
ok 17 - "q = integral_g(@(x) x.^2,'a',-1,'b',1)"
time =
    0.1054

Running ut_integral_g
........
Done ut_integral_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   0.080776 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
      ut_integral_g/testerrorfabstolnmax        1        0          0     0.0023
          ut_integral_g/testsinefunction        1        0          0     0.0026
                ut_integral_g/testerrorf        1        0          0     0.0041
           ut_integral_g/testerrorfninit        1        0          0     0.0046
            ut_integral_g/testerrorfnamx        1        0          0     0.0064
          ut_integral_g/testerrorOfExp2x        1        0          0     0.0097
     ut_integral_g/testerrorfabstolninit        1        0          0     0.0115
          ut_integral_g/testerrorfabstol        1        0          0     0.0395

TAP version 13
1..7
ok 1 - "f = @(x) x.^2;"
ok 2 - "[~, out_param] = funappx_g(f,-2,2,1e-7,18)"
ok 3 - "f = @(x) x.^2;"
ok 4 - "[~, out_param] = funappx_g(f,'a',-2,'b',2,'ninit',17)"
ok 5 - "in_param.a = -5; in_param.b = 5; f = @(x) x.^2;"
ok 6 - "in_param.abstol = 10^(-6); in_param.ninit=18;"
ok 7 - "[~, out_param] = funappx_g(f,in_param)"
time =
    0.1906
TAP version 13
1..11
ok 1 - "funappx_g"
ok 2 - "clear in_param; in_param.a = -5; in_param.b =5; in_param.abstol = 10^(-7); "
ok 3 - "[~, out_param] = funappx_g(@(x) x.^2, in_param)"
ok 4 - "clear in_param; f = @(x) sin(x); in_param.a = -1; in_param.b = 1; "
ok 5 - "in_param.abstol = 10^(-8); in_param.ninit = 20; "
ok 6 - "[~, out_param] = funappx_g(f, in_param)"
ok 7 - "[~, out_param] = funappx_g(@(x) x.^3,'a',-2,'b',2,'abstol',1e-7,'ninit',41)"
ok 8 - "[~, out_param] = funappx_g(@(x) exp(-100*(x-0.7).^2),'a',0,'b',1,'ninit',28)"
ok 9 - "[~, out_param] = funappx_g(@(x) x.^2,'memorytest',1,'output_x',1);"
ok 10 - "out_param.bytes <= 280674"
ok 11 - "length(out_param.x) == out_param.npoints"
time =
    0.3159

Running ut_funappx_g
.......... .......
Done ut_funappx_g
__________

Totals:
   17 Passed, 0 Failed, 0 Incomplete.   1.3771 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
             ut_funappx_g/funappx_gOfxab        1        0          0     0.0043
       ut_funappx_g/funappx_gOfxsquareab        1        0          0     0.0050
         ut_funappx_g/funappx_gOf100000x        1        0          0     0.0088
               ut_funappx_g/funappx_gOfx        1        0          0     0.0097
   ut_funappx_g/funappx_gOfexponentialab        1        0          0     0.0109
           ut_funappx_g/funappx_gOfsinab        1        0          0     0.0132
         ut_funappx_g/funappx_gOfxsquare        1        0          0     0.0134
             ut_funappx_g/funappx_gOfsin        1        0          0     0.0136
  ut_funappx_g/funappx_gOnpointsoflinear        1        0          0     0.0179
ut_funappx_g/funappx_gOnpointsofconstant        1        0          0     0.0284
     ut_funappx_g/funappx_gOfexponential        1        0          0     0.0450
            ut_funappx_g/funappx_gOfbeqa        1        0          0     0.0470
    ut_funappx_g/funappx_gOfexceedbudget        1        0          0     0.0494
      ut_funappx_g/funappx_gOfnofunction        1        0          0     0.0702
      ut_funappx_g/funappx_gOfexceediter        1        0          0     0.0916
            ut_funappx_g/funappx_gOfblea        1        0          0     0.3396
ut_funappx_g/funappx_gofConstantFunction        1        0          0     0.6088

TAP version 13
1..12
ok 1 - "f = @(x) exp(0.01*(x-0.5).^2); [fmin,out_param] = funmin_g(f)"
ok 2 - "f = @(x) exp(0.01*(x-0.5).^2);"
ok 3 - "[fmin,out_param] = funmin_g(f,-2,2,1e-7,10,1000000)"
ok 4 - "f=@(x) exp(0.01*(x-0.5).^2);"
ok 5 - "in_param.a = -13; in_param.b = 8;"
ok 6 - "in_param.abstol = 10^(-7);"
ok 7 - "in_param.ninit = 100;"
ok 8 - "in_param.nmax = 10^6;"
ok 9 - "[fmin,out_param] = funmin_g(f,in_param)"
ok 10 - "f=@(x) exp(0.01*(x-0.5).^2);"
ok 11 - "[fmin,out_param] = funmin_g(f,'a',-2,'b',2,'ninit',64,'nmax',1e6,'abstol',1e-5)"
ok 12 - "out_param(:).intervals"
time =
    0.1656

Running ut_funmin_g
........
Done ut_funmin_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   0.85102 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
                ut_funmin_g/funmin_gEXM3        1        0          0     0.0082
                ut_funmin_g/funmin_gEXM6        1        0          0     0.0090
                ut_funmin_g/funmin_gEXM7        1        0          0     0.0146
                ut_funmin_g/funmin_gEXM5        1        0          0     0.0151
                ut_funmin_g/funmin_gEXM2        1        0          0     0.0154
                ut_funmin_g/funmin_gEXM1        1        0          0     0.0563
                ut_funmin_g/funmin_gEXM4        1        0          0     0.1865
                ut_funmin_g/funmin_gEXM8        1        0          0     0.5459


Running ut_funmin_g_end
..
Done ut_funmin_g_end
__________

Totals:
   2 Passed, 0 Failed, 0 Incomplete.   0.057422 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
            ut_funmin_g_end/funmin_gEXM2        1        0          0     0.0133
            ut_funmin_g_end/funmin_gEXM1        1        0          0     0.0442

TAP version 13
1..10
ok 1 - "meanMC_g"
ok 2 - "in_param.reltol = 0; in_param.abstol = 1e-3;"
ok 3 - "in_param.alpha = 0.05; Yrand=@(n) rand(n,1).^2;"
ok 4 - "tmu = meanMC_g(Yrand,in_param); exactsol = 1/3;"
ok 5 - "check = double(abs(exactsol-tmu) < 1e-3)"
ok 6 - "tmu = meanMC_g(@(n)exp(rand(n,1)),1e-3,0); exactsol = exp(1)-1;"
ok 7 - "check = double(abs(exactsol-tmu) < 1e-3)"
ok 8 - "tmu = meanMC_g(@(n)cos(rand(n,1)),'reltol',1e-3,'abstol',1e-4,'alpha',0.01);"
ok 9 - "exactsol = sin(1);"
ok 10 - "check = double(abs(exactsol-tmu) < max(1e-3,1e-2*abs(exactsol)))"
time =
    0.0370

Running ut_meanMC_g
......
Done ut_meanMC_g
__________

Totals:
   6 Passed, 0 Failed, 0 Incomplete.   1.9737 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
               ut_meanMC_g/meanMC_gOfsin        1        0          0     0.0131
           ut_meanMC_g/meanMC_gOfxsquare        1        0          0     0.0190
    ut_meanMC_g/meanMC_gOfnonRandomInput        1        0          0     0.0233
           ut_meanMC_g/meanMC_gOfparsing        1        0          0     0.0281
               ut_meanMC_g/meanMC_gOfexp        1        0          0     0.0513
          ut_meanMC_g/meanMC_gOfWorkouts        1        0          0     1.8389

TAP version 13
1..22
ok 1 - "cubMC_g"
ok 2 - "f = @(x) sin(x); interval = [1;2];"
ok 3 - "Q = cubMC_g(f,interval,'uniform',1e-3,1e-2);"
ok 4 - "exactsol = 0.9564;"
ok 5 - "check = double(abs(exactsol-Q) < max(1e-3,1e-2*abs(exactsol)))"
ok 6 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [0 0;1 1];"
ok 7 - "Q = cubMC_g(f,hyperbox,'uniform',1e-3,0);"
ok 8 - "exactsol = 0.5577;"
ok 9 - "check = double(abs(exactsol-Q) < 1e-3)"
ok 10 - "d = 3; f = @(x) 2^d*prod(x,2)+0.555; hyperbox =[zeros(1,d); ones(1,d)];"
ok 11 - "in_param.abstol = 1e-3; in_param.reltol = 1e-3;"
ok 12 - "Q = cubMC_g(f,hyperbox,in_param);"
ok 13 - "exactsol = 1.555;"
ok 14 - "check = double(abs(exactsol-Q) < max(1e-3,1e-3*abs(exactsol)))"
ok 15 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-inf -inf;inf inf];"
ok 16 - "Q = cubMC_g(f,hyperbox,'normal',0,1e-2);"
ok 17 - "exactsol = 1/3;"
ok 18 - "check = double(abs(exactsol-Q) < max(0,1e-2*abs(exactsol)))"
ok 19 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1];"
ok 20 - "Q = cubMC_g(f,hyperbox,'uniform ball','abstol',1e-3,'reltol',1e-3);"
ok 21 - "exactsol = pi/2;"
ok 22 - "check = double(abs(exactsol-Q) < max(1e-3,1e-3*abs(exactsol)))"
time =
    0.8298
TAP version 13
1..21
ok 1 - "f = @(x) prod(x,2); hyperbox = [zeros(1,2);ones(1,2)];"
ok 2 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0,'transform','C1sin'); exactsol = 1/4;"
ok 3 - "check = double(abs(exactsol-q) < 1e-5)"
ok 4 - "f = @(x) x(:,1).^2.*x(:,2).^2.*x(:,3).^2; hyperbox = [-inf(1,3);inf(1,3)];"
ok 5 - "q = cubLattice_g(f,hyperbox,'normal',1e-3,1e-3,'transform','C1sin','shift',2^(-25)*ones(1,3)); exactsol = 1;"
ok 6 - "check = double(abs(exactsol-q) < max(1e-3,1e-3*abs(exactsol)))"
ok 7 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-ones(1,2);2*ones(1,2)];"
ok 8 - "q = cubLattice_g(f,hyperbox,'uniform',1e-3,1e-2,'transform','C1'); exactsol = 1/9*(sqrt(pi)/2*(erf(2)+erf(1)))^2;"
ok 9 - "check = double(abs(exactsol-q) < max(1e-3,1e-2*abs(exactsol)))"
ok 10 - "f = @(x) exp(-0.05^2/2)*max(100*exp(0.05*x)-100,0); hyperbox = [-inf(1,1);inf(1,1)];"
ok 11 - "q = cubLattice_g(f,hyperbox,'normal',1e-4,1e-2,'transform','C1sin'); price = normcdf(0.05)*100 - 0.5*100*exp(-0.05^2/2);"
ok 12 - "check = double(abs(price-q) < max(1e-4,1e-2*abs(price)))"
ok 13 - "f = @(x) 8*prod(x,2); hyperbox = [zeros(1,5);ones(1,5)];"
ok 14 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 15 - "check = double(abs(exactsol-q) < 1e-5)"
ok 16 - "f = @(x) 3./(5-4*(cos(2*pi*x))); hyperbox = [0;1];"
ok 17 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0,'transform','id'); exactsol = 1;"
ok 18 - "check = double(abs(exactsol-q) < 1e-5)"
ok 19 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1];"
ok 20 - "q = cubLattice_g(f,hyperbox,'uniform ball','abstol',1e-4,'reltol',0); exactsol = pi/2;"
ok 21 - "check = double(abs(exactsol-q) < 1e-4)"
time =
    0.8220

Running ut_cubLattice_g
.......
  Dim  FcnIdx       Q        f_true          Err      Sample Used      Stats  
-----------------------------------------------------------------------------------------------------
     1      1 +8.41471e-01 +8.41471e-01 1.28269e-07   1024             BothErrMet
     1      2 +7.85398e-01 +7.85398e-01 3.62707e-08   1024             BothErrMet
     1      3 +3.75000e-01 +3.75000e-01 4.36241e-07   1024             BothErrMet
     1      4 +7.46824e-01 +7.46824e-01 1.99168e-07   1024             BothErrMet
     1      5 +6.32121e-01 +6.32121e-01 9.75604e-08   1024             BothErrMet
     2      1 +4.96751e-01 +4.96751e-01 9.39825e-07   1024             BothErrMet
     2      2 +7.28296e-01 +7.28296e-01 5.05414e-07   1024             BothErrMet
     2      3 +1.01854e-01 +1.01852e-01 1.94901e-06   2048             BothErrMet
     2      4 +6.88991e-01 +6.88992e-01 3.82925e-07   1024             BothErrMet
     2      5 +4.97440e-01 +4.97440e-01 1.35858e-07   1024             BothErrMet
     3      1 +6.23594e-02 +6.23593e-02 4.21491e-08   2048             BothErrMet
     3      2 +6.62569e-01 +6.62570e-01 1.75593e-07   1024             BothErrMet
     3      3 +2.16210e-02 +2.17014e-02 8.03864e-05   1024             AbsErrMet
     3      4 +6.20902e-01 +6.20903e-01 1.16048e-06   1024             BothErrMet
     3      5 +3.83059e-01 +3.83055e-01 4.21199e-06   1024             BothErrMet
     4      1 -3.51760e-01 -3.51764e-01 4.10885e-06   4096             BothErrMet
     4      2 +5.88680e-01 +5.88680e-01 8.20614e-07   1024             BothErrMet
     4      3 +4.06761e-03 +3.80556e-03 2.62056e-04   1024             AbsErrMet
     4      4 +5.43399e-01 +5.43373e-01 2.62480e-05   1024             BothErrMet
     4      5 +2.86937e-01 +2.86844e-01 9.35056e-05   1024             BothErrMet
     5      1 -6.49344e-01 -6.49331e-01 1.28087e-05   4096             BothErrMet
     5      2 +5.13389e-01 +5.13409e-01 2.04832e-05   1024             BothErrMet
     5      3 +5.74770e-04 +5.67130e-04 7.64001e-06   1024             AbsErrMet
     5      4 +4.64588e-01 +4.64603e-01 1.52391e-05   2048             BothErrMet
     5      5 +2.10016e-01 +2.09952e-01 6.38825e-05   1024             BothErrMet
     6      1 -7.69102e-01 -7.69376e-01 2.74908e-04   8192             BothErrMet
     6      2 +4.41471e-01 +4.41474e-01 2.27142e-06   2048             BothErrMet
     6      3 +6.69867e-05 +7.34937e-05 6.50696e-06   1024             AbsErrMet
     6      4 +3.90235e-01 +3.90227e-01 7.21284e-06   2048             BothErrMet
     6      5 +1.51008e-01 +1.50939e-01 6.90128e-05   2048             BothErrMet
     7      1 -6.97216e-01 -6.97824e-01 6.08136e-04   8192             BothErrMet
     7      2 +3.75505e-01 +3.75484e-01 2.13349e-05   2048             BothErrMet
     7      3 +6.33188e-06 +8.42590e-06 2.09402e-06   1024             AbsErrMet
     7      4 +3.23172e-01 +3.23235e-01 6.34074e-05   2048             BothErrMet
     7      5 +1.06916e-01 +1.06978e-01 6.23692e-05   2048             BothErrMet
     8      1 -4.66757e-01 -4.67036e-01 2.78505e-04  16384             BothErrMet
     8      2 +3.16551e-01 +3.16602e-01 5.10272e-05   2048             BothErrMet
     8      3 +7.11862e-07 +8.66209e-07 1.54346e-07   1024             AbsErrMet
     8      4 +2.64745e-01 +2.64801e-01 5.62568e-05   4096             BothErrMet
     8      5 +7.50169e-02 +7.49531e-02 6.37062e-05   1024             BothErrMet
.
Done ut_cubLattice_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   2.5048 seconds testing time.
   100% Passed.
                                     Name   Passed   Failed Incomplete   Duration
        ut_cubLattice_g/cubLattice_gOfexp        1        0          0     0.0097
        ut_cubLattice_g/cubLattice_gOfsin        1        0          0     0.0107
ut_cubLattice_g/cubLattice_gOfmultierrfun        1        0          0     0.0223
    ut_cubLattice_g/cubLattice_gOfxsquare        1        0          0     0.0237
    ut_cubLattice_g/cubLattice_gOdwarning        1        0          0     0.0275
    ut_cubLattice_g/cubLattice_gOfwarning        1        0          0     0.0437
      ut_cubLattice_g/cubLattice_Workouts        1        0          0     0.5074
       ut_cubLattice_g/cubLattice_gNormal        1        0          0     1.8599

TAP version 13
1..26
ok 1 - "f = @(x) prod(x,2); hyperbox = [zeros(1,2);ones(1,2)];"
ok 2 - "q = cubSobol_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 3 - "check = double(abs(exactsol-q) < 1e-5)"
ok 4 - "f = @(x) x(:,1).^2.*x(:,2).^2.*x(:,3).^2; "
ok 5 - "hyperbox = [-inf(1,3);inf(1,3)]; exactsol = 1;"
ok 6 - "q = cubSobol_g(f,hyperbox,'normal',1e-3,1e-3, 'fudge',@(m) 10*2.^-m); "
ok 7 - "check = double(abs(exactsol-q) < max(1e-3,1e-3*abs(exactsol)))"
ok 8 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-ones(1,2);2*ones(1,2)];"
ok 9 - "q = cubSobol_g(f,hyperbox,'uniform',1e-3,1e-2); "
ok 10 - "exactsol = 1/9*(sqrt(pi)/2*(erf(2)+erf(1)))^2;"
ok 11 - "check = double(abs(exactsol-q) < max(1e-3,1e-2*abs(exactsol)))"
ok 12 - "f = @(x) exp(-0.05^2/2)*max(100*exp(0.05*x)-100,0); "
ok 13 - "hyperbox = [-inf(1,1);inf(1,1)];"
ok 14 - "q = cubSobol_g(f,hyperbox,'normal',1e-4,1e-2); "
ok 15 - "price = normcdf(0.05)*100 - 0.5*100*exp(-0.05^2/2);"
ok 16 - "check = double(abs(price-q) < max(1e-4,1e-2*abs(price)))"
ok 17 - "f = @(x) 8*prod(x,2); hyperbox = [zeros(1,5);ones(1,5)];"
ok 18 - "q = cubSobol_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 19 - "check = double(abs(exactsol-q) < 1e-5)"
ok 20 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1]; exactsol = pi/2;"
ok 21 - "q = cubSobol_g(f,hyperbox,'uniform ball','abstol',1e-4,'reltol',0); "
ok 22 - "check = double(abs(exactsol-q) < 1e-4)"
ok 23 - "g.func = @(x) [10*x(:,1)-5*x(:,2).^2+1*x(:,3).^3, x(:,1), x(:,2).^2];"
ok 24 - "g.cv = [1,4/3]; hyperbox= [zeros(1,3);2*ones(1,3)];"
ok 25 - "q = cubSobol_g(g,hyperbox,'uniform',1e-6,0); exactsol = 16/3;"
ok 26 - "check = double(abs(exactsol-q) < 1e-6)"
time =
   1.570057000000000

Running ut_cubSobol_g
.........Dim   FcnIdx       Q             f_true               Err            Sample Used             Stats  
-----------------------------------------------------------------------------------------------------
1     1       8.41471e-01       8.41471e-01       7.93487e-10         1024             BothErrMet
1     2       7.85520e-01       7.85398e-01       1.22070e-04         1024             BothErrMet
2     1       4.96752e-01       4.96751e-01       1.59514e-07         1024             BothErrMet
2     2       7.28296e-01       7.28296e-01       1.50460e-07         1024             BothErrMet
3     1       6.23572e-02       6.23593e-02       2.13548e-06         1024             BothErrMet
3     2       6.62549e-01       6.62570e-01       2.01317e-05         1024             BothErrMet
.
Done ut_cubSobol_g
__________

Totals:
   10 Passed, 0 Failed, 0 Incomplete.   1.2265 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
           ut_cubSobol_g/cubSobol_gOfsin        1        0          0     0.0077
    ut_cubSobol_g/cubSobol_gOfmultierfcv        1        0          0     0.0138
           ut_cubSobol_g/cubSobol_gOfexp        1        0          0     0.0163
   ut_cubSobol_g/cubSobol_gOfmultierrfun        1        0          0     0.0198
        ut_cubSobol_g/cubSobol_gOfpolycv        1        0          0     0.0259
       ut_cubSobol_g/cubSobol_gOdwarning        1        0          0     0.0259
       ut_cubSobol_g/cubSobol_gOfxsquare        1        0          0     0.0269
       ut_cubSobol_g/cubSobol_gOfwarning        1        0          0     0.0391
         ut_cubSobol_g/cubSobol_Workouts        1        0          0     0.1128
    ut_cubSobol_g/cubSobol_gOfgmeanOptcv        1        0          0     0.9382

TAP version 13
1..2
ok 1 - "obj = assetPath"
ok 2 - "obj = assetPath"
time =
    0.6731
TAP version 13
1..2
ok 1 - "obj = optPayoff"
ok 2 - "obj = optPayoff"
time =
    0.5552
TAP version 13
1..2
ok 1 - "obj = optPrice"
ok 2 - "obj = optPrice"
time =
    0.6709
TAP version 13
1..2
ok 1 - "obj = brownianMotion"
ok 2 - "obj = brownianMotion"
time =
    0.5546
TAP version 13
1..1
ok 1 - "obj = stochProcess"
time =
    0.4820
TAP version 13
1..2
ok 1 - "obj = whiteNoise"
ok 2 - "obj = whiteNoise"
time =
    0.5181
TAP version 13
1..4
ok 1 - "errParamObj = gail.errorParam"
ok 2 - "errParamObj = gail.errorParam(0.001)"
ok 3 - "errParamObj = gail.errorParam('relTol',0.1)"
ok 4 - "newErrParamObj = gail.errorParam(errParamObj,'relTol',0.001)"
time =
    0.4997
TAP version 13
1..12
ok 1 - "fParamObj = gail.fParam"
ok 2 - "fParamObj = gail.fParam(@(x) sum(x.^3.2),[0 0; 1 1])"
ok 3 - "fParamObj = gail.fParam(@(x) sum(x.^3.2),[0 0; 1 1],'ball')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.relTol = 0.1;"
ok 7 - "fParamObj = gail.fParam(inpStruct)"
ok 8 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 9 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 10 - "inpStruct.relTol = 0.1;"
ok 11 - "fParamObj = gail.fParam(inpStruct,0.0001,0.01)"
ok 12 - "newfParamObj = gail.fParam(fParamObj,'domainType','sphere')"
time =
    0.4361
TAP version 13
1..8
ok 1 - "cubParamObj = gail.cubParam"
ok 2 - "cubParamObj = gail.cubParam(@(x) sum(x.^3.2),[0 0; 2 2],'box','Lebesgue')"
ok 3 - "cubParamObj = gail.cubParam('domain', [-Inf -Inf; Inf Inf], 'f', @(x) sum(x.^3.2), 'relTol', 0.1, 'measure', 'Gaussian')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.nInit = 2048;"
ok 7 - "cubParamObj = gail.cubParam(inpStruct)"
ok 8 - "NewCubParamObj = gail.cubParam(cubParamObj,'measure','Lebesgue')"
time =
    0.5997
TAP version 13
1..5
ok 1 - "cubParamObj = gail.cubParam; %an input object"
ok 2 - "cubOutObj = gail.cubOut(cubParamObj); %copied to becom an output object"
ok 3 - "cubOutObj.mu = 1.467; %integral value is recorded"
ok 4 - "cubOutObj.nSample = 31415926; %sample size is recorded"
ok 5 - "cubOutObj.time = 0.0278 %time of computation is recorded"
time =
    0.4005
TAP version 13
1..7
ok 1 - "cubLatticeParamObj = gail.cubLatticeParam"
ok 2 - "cubLatticeParamObj = gail.cubLatticeParam('domain', [-2 -2; 2 2], 'f', @(x) sum(x.^3.2), 'relTol', 0.1, 'isShift', false)"
ok 3 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 4 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 5 - "inpStruct.isShift = false;"
ok 6 - "cubLatticeParamObj = gail.cubLatticeParam(inpStruct)"
ok 7 - "NewCubLatticeParamObj = gail.cubLatticeParam(cubLatticeParamObj,'measure','Lebesgue')"
time =
    0.4850
TAP version 13
1..8
ok 1 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam"
ok 2 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam(@(x) sum(x.^3.2),[0 0; 2 2])"
ok 3 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam('domain', [0 0; 1 1], 'f', @(x) sum(x.^3.2), 'relTol', 0.1,'kerName','Ber4')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.kerName = 'Ber4';"
ok 7 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam(inpStruct)"
ok 8 - "NewCubBayesLatticeParamObj = gail.cubBayesLatticeParam(cubBayesLatticeParamObj,'GPMean',0)"
time =
    0.5284
TAP version 13
1..5
ok 1 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam; %an input object"
ok 2 - "cubBayesLatticeOutObj = gail.cubBayesLatticeOut(cubBayesLatticeParamObj); %copied to becom an output object"
ok 3 - "cubBayesLatticeOutObj.mu = 1.467; %integral value is recorded"
ok 4 - "cubBayesLatticeOutObj.nSample = 31415926; %sample size is recorded"
ok 5 - "cubBayesLatticeOutObj.time = 0.0278 %time of computation is recorded"
time =
    0.4150
TAP version 13
1..8
ok 1 - "meanYParamObj = gail.meanYParam"
ok 2 - "meanYParamObj = gail.meanYParam(@(n) sum(rand(n,4).^3,2),0.001)"
ok 3 - "meanYParamObj = gail.meanYParam('nSig', 1e4, 'Y', @(n)sin(sum(rand(n,4).^3,2)), 'relTol', 0.1)"
ok 4 - "inpStruct.Y = @(n) sin(sum(rand(n,2),2));"
ok 5 - "inpStruct.nSig = 1e4;"
ok 6 - "inpStruct.relTol = 0.1;"
ok 7 - "meanYParamObj = gail.meanYParam(inpStruct)"
ok 8 - "NewMeanYParamObj = gail.meanYParam(meanYParamObj,'Y',@(n) rand(n,3))"
time =
    0.4434
TAP version 13
1..7
ok 1 - "meanParamObj = gail.meanYParam; %an input object"
ok 2 - "meanOutObj = gail.meanYOut(meanParamObj); %copied to becom an output object"
ok 3 - "meanOutObj.sol = 1.467; %integral value is recorded"
ok 4 - "meanOutObj.stddev = 1.23; %standard deviation is recorded"
ok 5 - "meanOutObj.nSample = 31415926; %sample size is recorded"
ok 6 - "meanOutObj.time = 0.0278; %time of computation is recorded"
ok 7 - "meanOutObj.errBd = 0.000456 %error bound is recorded"
time =
    0.3983
total_time =
   34.8560
>> gailpbs_tests: Input arg R2019a

                            < M A T L A B (R) >
                  Copyright 1984-2019 The MathWorks, Inc.
              R2019a Update 6 (9.6.0.1214997) 64-bit (glnxa64)
                             September 25, 2019

 
To get started, type doc.
For product information, visit www.mathworks.com.
 
>> >> >> >> 
Welcome to Guaranteed Automatic Integration Library (GAIL).
You are installing GAIL v2.3.1.

[Warning: Unable to save path to file
'/share/apps/matlab/R2019a/toolbox/local/pathdef.m'. You can save your path to
a different location by calling SAVEPATH with an input argument that specifies
the full path. For MATLAB to use that path in future sessions, save the path to
'pathdef.m' in your MATLAB startup folder.] 
[> In savepath (line 176)
  In GAIL_Install (line 20)] 

GAIL version 2.3.1 has been installed successfully.

>> >> >> >> GAILVERSION = 2.3.1.  MATLABVERSION = 9.6
TAP version 13
1..30
ok 1 - "help cubBayesLattice_g"
ok 2 - "warning('off','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 3 - "[~,muhat] = cubBayesLattice_g;"
ok 4 - "exactInteg = 1.0/3;"
ok 5 - "warning('on','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 6 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 7 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 8 - "dim=2; absTol=1e-2; relTol=1e-2;"
ok 9 - "exactInteg = besseli(0,1)^dim;"
ok 10 - "inputArgs = {'relTol',relTol, 'order',2, 'ptransform','C1sin'};"
ok 11 - "inputArgs = [{fun, dim, 'absTol',absTol,'oneTheta',false} inputArgs];"
ok 12 - "obj=cubBayesLattice_g(inputArgs{:});"
ok 13 - "[muhat,outParams]=compInteg(obj);"
ok 14 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
ok 15 - "etaDim = size(outParams.optParams.aMLEAll, 2)"
ok 16 - "help cubBayesLattice_g"
ok 17 - "warning('off','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 18 - "[~,muhat] = cubBayesLattice_g;"
ok 19 - "exactInteg = 1.0/3;"
ok 20 - "warning('on','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 21 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 22 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 23 - "dim=2; absTol=1e-2; relTol=1e-2;"
ok 24 - "exactInteg = besseli(0,1)^dim;"
ok 25 - "inputArgs = {'relTol',relTol, 'order',2, 'ptransform','C1sin'};"
ok 26 - "inputArgs = [{fun, dim, 'absTol',absTol,'oneTheta',false} inputArgs];"
ok 27 - "obj=cubBayesLattice_g(inputArgs{:});"
ok 28 - "[muhat,outParams]=compInteg(obj);"
ok 29 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
ok 30 - "etaDim = size(outParams.optParams.aMLEAll, 2)"
time =
    8.2923
TAP version 13
1..3
ok 1 - "q = integral_g(@(x) x.^2)"
ok 2 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',1,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 3 - "q = integral_g()"
time =
    0.3240
TAP version 13
1..17
ok 1 - "f = @(x) exp(-(x-1).^2); q = integral_g(f,'a',1,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 2 - "f = @(x) exp(-x.^2); q = integral_g(f,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 3 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',1,'b',2,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 4 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',2,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 5 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 6 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',3,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 7 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',-1,'b',3,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 8 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',-4.5,'b',1.5,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 9 - "q = integral_g(@(x)x.^2,'a',1)"
ok 10 - "q = integral_g(@(x)x.^2,'a',0,'b',Inf)"
ok 11 - "q = integral_g(@(x)x.^2,'a',Inf)"
ok 12 - "q = integral_g(@(x)x.^2,'a',NaN)"
ok 13 - "q = integral_g(@(x)x.^2,'a',0,'b',NaN)"
ok 14 - "q = integral_g(@(x)x.^2,'a',1,'b',0)"
ok 15 - "q = integral_g(@(x)x.^2,'a',0,'b',2,'nlo',10,'nhi',100)"
ok 16 - " inparam.a=0; inparam.b=3; inparam.abstol=1e-13; q=integral_g(@(x) exp(2*x),inparam)"
ok 17 - "q = integral_g(@(x) x.^2,'a',-1,'b',1)"
time =
    0.1537

Running ut_integral_g
........
Done ut_integral_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   0.085848 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
      ut_integral_g/testerrorfabstolnmax        1        0          0     0.0027
          ut_integral_g/testsinefunction        1        0          0     0.0030
                ut_integral_g/testerrorf        1        0          0     0.0047
           ut_integral_g/testerrorfninit        1        0          0     0.0053
            ut_integral_g/testerrorfnamx        1        0          0     0.0064
          ut_integral_g/testerrorOfExp2x        1        0          0     0.0103
     ut_integral_g/testerrorfabstolninit        1        0          0     0.0115
          ut_integral_g/testerrorfabstol        1        0          0     0.0419

TAP version 13
1..7
ok 1 - "f = @(x) x.^2;"
ok 2 - "[~, out_param] = funappx_g(f,-2,2,1e-7,18)"
ok 3 - "f = @(x) x.^2;"
ok 4 - "[~, out_param] = funappx_g(f,'a',-2,'b',2,'ninit',17)"
ok 5 - "in_param.a = -5; in_param.b = 5; f = @(x) x.^2;"
ok 6 - "in_param.abstol = 10^(-6); in_param.ninit=18;"
ok 7 - "[~, out_param] = funappx_g(f,in_param)"
time =
    0.3134
TAP version 13
1..11
ok 1 - "funappx_g"
ok 2 - "clear in_param; in_param.a = -5; in_param.b =5; in_param.abstol = 10^(-7); "
ok 3 - "[~, out_param] = funappx_g(@(x) x.^2, in_param)"
ok 4 - "clear in_param; f = @(x) sin(x); in_param.a = -1; in_param.b = 1; "
ok 5 - "in_param.abstol = 10^(-8); in_param.ninit = 20; "
ok 6 - "[~, out_param] = funappx_g(f, in_param)"
ok 7 - "[~, out_param] = funappx_g(@(x) x.^3,'a',-2,'b',2,'abstol',1e-7,'ninit',41)"
ok 8 - "[~, out_param] = funappx_g(@(x) exp(-100*(x-0.7).^2),'a',0,'b',1,'ninit',28)"
ok 9 - "[~, out_param] = funappx_g(@(x) x.^2,'memorytest',1,'output_x',1);"
ok 10 - "out_param.bytes <= 280674"
ok 11 - "length(out_param.x) == out_param.npoints"
time =
    0.3843

Running ut_funappx_g
.......... .......
Done ut_funappx_g
__________

Totals:
   17 Passed, 0 Failed, 0 Incomplete.   1.5348 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
             ut_funappx_g/funappx_gOfxab        1        0          0     0.0056
       ut_funappx_g/funappx_gOfxsquareab        1        0          0     0.0058
               ut_funappx_g/funappx_gOfx        1        0          0     0.0123
   ut_funappx_g/funappx_gOfexponentialab        1        0          0     0.0123
         ut_funappx_g/funappx_gOf100000x        1        0          0     0.0129
           ut_funappx_g/funappx_gOfsinab        1        0          0     0.0133
             ut_funappx_g/funappx_gOfsin        1        0          0     0.0147
         ut_funappx_g/funappx_gOfxsquare        1        0          0     0.0151
  ut_funappx_g/funappx_gOnpointsoflinear        1        0          0     0.0165
ut_funappx_g/funappx_gOnpointsofconstant        1        0          0     0.0266
    ut_funappx_g/funappx_gOfexceedbudget        1        0          0     0.0453
            ut_funappx_g/funappx_gOfbeqa        1        0          0     0.0475
     ut_funappx_g/funappx_gOfexponential        1        0          0     0.0492
      ut_funappx_g/funappx_gOfnofunction        1        0          0     0.0755
      ut_funappx_g/funappx_gOfexceediter        1        0          0     0.0865
            ut_funappx_g/funappx_gOfblea        1        0          0     0.3665
ut_funappx_g/funappx_gofConstantFunction        1        0          0     0.7291

TAP version 13
1..12
ok 1 - "f = @(x) exp(0.01*(x-0.5).^2); [fmin,out_param] = funmin_g(f)"
ok 2 - "f = @(x) exp(0.01*(x-0.5).^2);"
ok 3 - "[fmin,out_param] = funmin_g(f,-2,2,1e-7,10,1000000)"
ok 4 - "f=@(x) exp(0.01*(x-0.5).^2);"
ok 5 - "in_param.a = -13; in_param.b = 8;"
ok 6 - "in_param.abstol = 10^(-7);"
ok 7 - "in_param.ninit = 100;"
ok 8 - "in_param.nmax = 10^6;"
ok 9 - "[fmin,out_param] = funmin_g(f,in_param)"
ok 10 - "f=@(x) exp(0.01*(x-0.5).^2);"
ok 11 - "[fmin,out_param] = funmin_g(f,'a',-2,'b',2,'ninit',64,'nmax',1e6,'abstol',1e-5)"
ok 12 - "out_param(:).intervals"
time =
    0.1590

Running ut_funmin_g
........
Done ut_funmin_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   0.85057 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
                ut_funmin_g/funmin_gEXM6        1        0          0     0.0074
                ut_funmin_g/funmin_gEXM2        1        0          0     0.0127
                ut_funmin_g/funmin_gEXM5        1        0          0     0.0142
                ut_funmin_g/funmin_gEXM3        1        0          0     0.0195
                ut_funmin_g/funmin_gEXM7        1        0          0     0.0238
                ut_funmin_g/funmin_gEXM1        1        0          0     0.0571
                ut_funmin_g/funmin_gEXM4        1        0          0     0.1596
                ut_funmin_g/funmin_gEXM8        1        0          0     0.5563


Running ut_funmin_g_end
..
Done ut_funmin_g_end
__________

Totals:
   2 Passed, 0 Failed, 0 Incomplete.   0.050182 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
            ut_funmin_g_end/funmin_gEXM2        1        0          0     0.0103
            ut_funmin_g_end/funmin_gEXM1        1        0          0     0.0398

TAP version 13
1..10
ok 1 - "meanMC_g"
ok 2 - "in_param.reltol = 0; in_param.abstol = 1e-3;"
ok 3 - "in_param.alpha = 0.05; Yrand=@(n) rand(n,1).^2;"
ok 4 - "tmu = meanMC_g(Yrand,in_param); exactsol = 1/3;"
ok 5 - "check = double(abs(exactsol-tmu) < 1e-3)"
ok 6 - "tmu = meanMC_g(@(n)exp(rand(n,1)),1e-3,0); exactsol = exp(1)-1;"
ok 7 - "check = double(abs(exactsol-tmu) < 1e-3)"
ok 8 - "tmu = meanMC_g(@(n)cos(rand(n,1)),'reltol',1e-3,'abstol',1e-4,'alpha',0.01);"
ok 9 - "exactsol = sin(1);"
ok 10 - "check = double(abs(exactsol-tmu) < max(1e-3,1e-2*abs(exactsol)))"
time =
    0.0375

Running ut_meanMC_g
......
Done ut_meanMC_g
__________

Totals:
   6 Passed, 0 Failed, 0 Incomplete.   2.1414 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
               ut_meanMC_g/meanMC_gOfsin        1        0          0     0.0122
           ut_meanMC_g/meanMC_gOfxsquare        1        0          0     0.0183
    ut_meanMC_g/meanMC_gOfnonRandomInput        1        0          0     0.0234
           ut_meanMC_g/meanMC_gOfparsing        1        0          0     0.0368
               ut_meanMC_g/meanMC_gOfexp        1        0          0     0.0497
          ut_meanMC_g/meanMC_gOfWorkouts        1        0          0     2.0010

TAP version 13
1..22
ok 1 - "cubMC_g"
ok 2 - "f = @(x) sin(x); interval = [1;2];"
ok 3 - "Q = cubMC_g(f,interval,'uniform',1e-3,1e-2);"
ok 4 - "exactsol = 0.9564;"
ok 5 - "check = double(abs(exactsol-Q) < max(1e-3,1e-2*abs(exactsol)))"
ok 6 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [0 0;1 1];"
ok 7 - "Q = cubMC_g(f,hyperbox,'uniform',1e-3,0);"
ok 8 - "exactsol = 0.5577;"
ok 9 - "check = double(abs(exactsol-Q) < 1e-3)"
ok 10 - "d = 3; f = @(x) 2^d*prod(x,2)+0.555; hyperbox =[zeros(1,d); ones(1,d)];"
ok 11 - "in_param.abstol = 1e-3; in_param.reltol = 1e-3;"
ok 12 - "Q = cubMC_g(f,hyperbox,in_param);"
ok 13 - "exactsol = 1.555;"
ok 14 - "check = double(abs(exactsol-Q) < max(1e-3,1e-3*abs(exactsol)))"
ok 15 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-inf -inf;inf inf];"
ok 16 - "Q = cubMC_g(f,hyperbox,'normal',0,1e-2);"
ok 17 - "exactsol = 1/3;"
ok 18 - "check = double(abs(exactsol-Q) < max(0,1e-2*abs(exactsol)))"
ok 19 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1];"
ok 20 - "Q = cubMC_g(f,hyperbox,'uniform ball','abstol',1e-3,'reltol',1e-3);"
ok 21 - "exactsol = pi/2;"
ok 22 - "check = double(abs(exactsol-Q) < max(1e-3,1e-3*abs(exactsol)))"
time =
    0.8241
TAP version 13
1..21
ok 1 - "f = @(x) prod(x,2); hyperbox = [zeros(1,2);ones(1,2)];"
ok 2 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0,'transform','C1sin'); exactsol = 1/4;"
ok 3 - "check = double(abs(exactsol-q) < 1e-5)"
ok 4 - "f = @(x) x(:,1).^2.*x(:,2).^2.*x(:,3).^2; hyperbox = [-inf(1,3);inf(1,3)];"
ok 5 - "q = cubLattice_g(f,hyperbox,'normal',1e-3,1e-3,'transform','C1sin','shift',2^(-25)*ones(1,3)); exactsol = 1;"
ok 6 - "check = double(abs(exactsol-q) < max(1e-3,1e-3*abs(exactsol)))"
ok 7 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-ones(1,2);2*ones(1,2)];"
ok 8 - "q = cubLattice_g(f,hyperbox,'uniform',1e-3,1e-2,'transform','C1'); exactsol = 1/9*(sqrt(pi)/2*(erf(2)+erf(1)))^2;"
ok 9 - "check = double(abs(exactsol-q) < max(1e-3,1e-2*abs(exactsol)))"
ok 10 - "f = @(x) exp(-0.05^2/2)*max(100*exp(0.05*x)-100,0); hyperbox = [-inf(1,1);inf(1,1)];"
ok 11 - "q = cubLattice_g(f,hyperbox,'normal',1e-4,1e-2,'transform','C1sin'); price = normcdf(0.05)*100 - 0.5*100*exp(-0.05^2/2);"
ok 12 - "check = double(abs(price-q) < max(1e-4,1e-2*abs(price)))"
ok 13 - "f = @(x) 8*prod(x,2); hyperbox = [zeros(1,5);ones(1,5)];"
ok 14 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 15 - "check = double(abs(exactsol-q) < 1e-5)"
ok 16 - "f = @(x) 3./(5-4*(cos(2*pi*x))); hyperbox = [0;1];"
ok 17 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0,'transform','id'); exactsol = 1;"
ok 18 - "check = double(abs(exactsol-q) < 1e-5)"
ok 19 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1];"
ok 20 - "q = cubLattice_g(f,hyperbox,'uniform ball','abstol',1e-4,'reltol',0); exactsol = pi/2;"
ok 21 - "check = double(abs(exactsol-q) < 1e-4)"
time =
    0.9633

Running ut_cubLattice_g
.......
  Dim  FcnIdx       Q        f_true          Err      Sample Used      Stats  
-----------------------------------------------------------------------------------------------------
     1      1 +8.41471e-01 +8.41471e-01 2.98057e-08   1024             BothErrMet
     1      2 +7.85398e-01 +7.85398e-01 1.19708e-07   1024             BothErrMet
     1      3 +3.75000e-01 +3.75000e-01 3.75841e-07   1024             BothErrMet
     1      4 +7.46824e-01 +7.46824e-01 1.15054e-07   1024             BothErrMet
     1      5 +6.32120e-01 +6.32121e-01 6.78215e-08   1024             BothErrMet
     2      1 +4.96751e-01 +4.96751e-01 8.47401e-08   1024             BothErrMet
     2      2 +7.28296e-01 +7.28296e-01 2.21339e-07   1024             BothErrMet
     2      3 +1.01853e-01 +1.01852e-01 1.35980e-06   2048             BothErrMet
     2      4 +6.88991e-01 +6.88992e-01 8.90321e-08   1024             BothErrMet
     2      5 +4.97441e-01 +4.97440e-01 1.27413e-06   1024             BothErrMet
     3      1 +6.23595e-02 +6.23593e-02 1.37422e-07   2048             BothErrMet
     3      2 +6.62570e-01 +6.62570e-01 7.70885e-08   1024             BothErrMet
     3      3 +2.15636e-02 +2.17014e-02 1.37772e-04   1024             AbsErrMet
     3      4 +6.20902e-01 +6.20903e-01 1.27736e-06   1024             BothErrMet
     3      5 +3.83057e-01 +3.83055e-01 2.93461e-06   1024             BothErrMet
     4      1 -3.51759e-01 -3.51764e-01 4.38039e-06   4096             BothErrMet
     4      2 +5.88681e-01 +5.88680e-01 1.37379e-06   1024             BothErrMet
     4      3 +3.63421e-03 +3.80556e-03 1.71342e-04   1024             AbsErrMet
     4      4 +5.43390e-01 +5.43373e-01 1.69862e-05   1024             BothErrMet
     4      5 +2.87000e-01 +2.86844e-01 1.56171e-04   1024             BothErrMet
     5      1 -6.49333e-01 -6.49331e-01 1.50813e-06   4096             BothErrMet
     5      2 +5.13412e-01 +5.13409e-01 2.77610e-06   1024             BothErrMet
     5      3 +5.24420e-04 +5.67130e-04 4.27099e-05   1024             AbsErrMet
     5      4 +4.64618e-01 +4.64603e-01 1.46204e-05   2048             BothErrMet
     5      5 +2.09886e-01 +2.09952e-01 6.66204e-05   1024             BothErrMet
     6      1 -7.69103e-01 -7.69376e-01 2.73778e-04   8192             BothErrMet
     6      2 +4.41466e-01 +4.41474e-01 7.36976e-06   2048             BothErrMet
     6      3 +6.47614e-05 +7.34937e-05 8.73226e-06   1024             AbsErrMet
     6      4 +3.90245e-01 +3.90227e-01 1.76227e-05   2048             BothErrMet
     6      5 +1.51034e-01 +1.50939e-01 9.53647e-05   2048             BothErrMet
     7      1 -6.98072e-01 -6.97824e-01 2.47897e-04   8192             BothErrMet
     7      2 +3.75526e-01 +3.75484e-01 4.22862e-05   2048             BothErrMet
     7      3 +1.00110e-05 +8.42590e-06 1.58509e-06   1024             AbsErrMet
     7      4 +3.23087e-01 +3.23235e-01 1.47929e-04   2048             BothErrMet
     7      5 +1.06875e-01 +1.06978e-01 1.03363e-04   1024             BothErrMet
     8      1 -4.67033e-01 -4.67036e-01 2.89794e-06  16384             BothErrMet
     8      2 +3.16646e-01 +3.16602e-01 4.40476e-05   2048             BothErrMet
     8      3 +6.56175e-07 +8.66209e-07 2.10034e-07   1024             AbsErrMet
     8      4 +2.64773e-01 +2.64801e-01 2.76186e-05   2048             BothErrMet
     8      5 +7.49391e-02 +7.49531e-02 1.40498e-05   1024             BothErrMet
.
Done ut_cubLattice_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   2.5134 seconds testing time.
   100% Passed.
                                     Name   Passed   Failed Incomplete   Duration
        ut_cubLattice_g/cubLattice_gOfsin        1        0          0     0.0096
        ut_cubLattice_g/cubLattice_gOfexp        1        0          0     0.0106
ut_cubLattice_g/cubLattice_gOfmultierrfun        1        0          0     0.0224
    ut_cubLattice_g/cubLattice_gOfxsquare        1        0          0     0.0257
    ut_cubLattice_g/cubLattice_gOdwarning        1        0          0     0.0337
    ut_cubLattice_g/cubLattice_gOfwarning        1        0          0     0.0593
      ut_cubLattice_g/cubLattice_Workouts        1        0          0     0.4399
       ut_cubLattice_g/cubLattice_gNormal        1        0          0     1.9122

TAP version 13
1..26
ok 1 - "f = @(x) prod(x,2); hyperbox = [zeros(1,2);ones(1,2)];"
ok 2 - "q = cubSobol_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 3 - "check = double(abs(exactsol-q) < 1e-5)"
ok 4 - "f = @(x) x(:,1).^2.*x(:,2).^2.*x(:,3).^2; "
ok 5 - "hyperbox = [-inf(1,3);inf(1,3)]; exactsol = 1;"
ok 6 - "q = cubSobol_g(f,hyperbox,'normal',1e-3,1e-3, 'fudge',@(m) 10*2.^-m); "
ok 7 - "check = double(abs(exactsol-q) < max(1e-3,1e-3*abs(exactsol)))"
ok 8 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-ones(1,2);2*ones(1,2)];"
ok 9 - "q = cubSobol_g(f,hyperbox,'uniform',1e-3,1e-2); "
ok 10 - "exactsol = 1/9*(sqrt(pi)/2*(erf(2)+erf(1)))^2;"
ok 11 - "check = double(abs(exactsol-q) < max(1e-3,1e-2*abs(exactsol)))"
ok 12 - "f = @(x) exp(-0.05^2/2)*max(100*exp(0.05*x)-100,0); "
ok 13 - "hyperbox = [-inf(1,1);inf(1,1)];"
ok 14 - "q = cubSobol_g(f,hyperbox,'normal',1e-4,1e-2); "
ok 15 - "price = normcdf(0.05)*100 - 0.5*100*exp(-0.05^2/2);"
ok 16 - "check = double(abs(price-q) < max(1e-4,1e-2*abs(price)))"
ok 17 - "f = @(x) 8*prod(x,2); hyperbox = [zeros(1,5);ones(1,5)];"
ok 18 - "q = cubSobol_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 19 - "check = double(abs(exactsol-q) < 1e-5)"
ok 20 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1]; exactsol = pi/2;"
ok 21 - "q = cubSobol_g(f,hyperbox,'uniform ball','abstol',1e-4,'reltol',0); "
ok 22 - "check = double(abs(exactsol-q) < 1e-4)"
ok 23 - "g.func = @(x) [10*x(:,1)-5*x(:,2).^2+1*x(:,3).^3, x(:,1), x(:,2).^2];"
ok 24 - "g.cv = [1,4/3]; hyperbox= [zeros(1,3);2*ones(1,3)];"
ok 25 - "q = cubSobol_g(g,hyperbox,'uniform',1e-6,0); exactsol = 16/3;"
ok 26 - "check = double(abs(exactsol-q) < 1e-6)"
time =
   1.254192000000000

Running ut_cubSobol_g
.........Dim   FcnIdx       Q             f_true               Err            Sample Used             Stats  
-----------------------------------------------------------------------------------------------------
1     1       8.41471e-01       8.41471e-01       2.20431e-07         1024             BothErrMet
1     2       7.85398e-01       7.85398e-01       7.11309e-12         1024             BothErrMet
2     1       4.96753e-01       4.96751e-01       1.50314e-06         1024             BothErrMet
2     2       7.28296e-01       7.28296e-01       3.43936e-08         1024             BothErrMet
3     1       6.22695e-02       6.23593e-02       8.98245e-05         1024             AbsErrMet
3     2       6.62556e-01       6.62570e-01       1.32443e-05         1024             BothErrMet
.
Done ut_cubSobol_g
__________

Totals:
   10 Passed, 0 Failed, 0 Incomplete.   1.2897 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
           ut_cubSobol_g/cubSobol_gOfsin        1        0          0     0.0086
           ut_cubSobol_g/cubSobol_gOfexp        1        0          0     0.0103
    ut_cubSobol_g/cubSobol_gOfmultierfcv        1        0          0     0.0120
   ut_cubSobol_g/cubSobol_gOfmultierrfun        1        0          0     0.0159
        ut_cubSobol_g/cubSobol_gOfpolycv        1        0          0     0.0237
       ut_cubSobol_g/cubSobol_gOdwarning        1        0          0     0.0273
       ut_cubSobol_g/cubSobol_gOfxsquare        1        0          0     0.0283
       ut_cubSobol_g/cubSobol_gOfwarning        1        0          0     0.0438
         ut_cubSobol_g/cubSobol_Workouts        1        0          0     0.1216
    ut_cubSobol_g/cubSobol_gOfgmeanOptcv        1        0          0     0.9983

TAP version 13
1..2
ok 1 - "obj = assetPath"
ok 2 - "obj = assetPath"
time =
    0.8254
TAP version 13
1..2
ok 1 - "obj = optPayoff"
ok 2 - "obj = optPayoff"
time =
    0.7892
TAP version 13
1..2
ok 1 - "obj = optPrice"
ok 2 - "obj = optPrice"
time =
    0.8083
TAP version 13
1..2
ok 1 - "obj = brownianMotion"
ok 2 - "obj = brownianMotion"
time =
    0.6411
TAP version 13
1..1
ok 1 - "obj = stochProcess"
time =
    0.5665
TAP version 13
1..2
ok 1 - "obj = whiteNoise"
ok 2 - "obj = whiteNoise"
time =
    0.6723
TAP version 13
1..4
ok 1 - "errParamObj = gail.errorParam"
ok 2 - "errParamObj = gail.errorParam(0.001)"
ok 3 - "errParamObj = gail.errorParam('relTol',0.1)"
ok 4 - "newErrParamObj = gail.errorParam(errParamObj,'relTol',0.001)"
time =
    0.5827
TAP version 13
1..12
ok 1 - "fParamObj = gail.fParam"
ok 2 - "fParamObj = gail.fParam(@(x) sum(x.^3.2),[0 0; 1 1])"
ok 3 - "fParamObj = gail.fParam(@(x) sum(x.^3.2),[0 0; 1 1],'ball')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.relTol = 0.1;"
ok 7 - "fParamObj = gail.fParam(inpStruct)"
ok 8 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 9 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 10 - "inpStruct.relTol = 0.1;"
ok 11 - "fParamObj = gail.fParam(inpStruct,0.0001,0.01)"
ok 12 - "newfParamObj = gail.fParam(fParamObj,'domainType','sphere')"
time =
    0.5100
TAP version 13
1..8
ok 1 - "cubParamObj = gail.cubParam"
ok 2 - "cubParamObj = gail.cubParam(@(x) sum(x.^3.2),[0 0; 2 2],'box','Lebesgue')"
ok 3 - "cubParamObj = gail.cubParam('domain', [-Inf -Inf; Inf Inf], 'f', @(x) sum(x.^3.2), 'relTol', 0.1, 'measure', 'Gaussian')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.nInit = 2048;"
ok 7 - "cubParamObj = gail.cubParam(inpStruct)"
ok 8 - "NewCubParamObj = gail.cubParam(cubParamObj,'measure','Lebesgue')"
time =
    0.6247
TAP version 13
1..5
ok 1 - "cubParamObj = gail.cubParam; %an input object"
ok 2 - "cubOutObj = gail.cubOut(cubParamObj); %copied to becom an output object"
ok 3 - "cubOutObj.mu = 1.467; %integral value is recorded"
ok 4 - "cubOutObj.nSample = 31415926; %sample size is recorded"
ok 5 - "cubOutObj.time = 0.0278 %time of computation is recorded"
time =
    0.4627
TAP version 13
1..7
ok 1 - "cubLatticeParamObj = gail.cubLatticeParam"
ok 2 - "cubLatticeParamObj = gail.cubLatticeParam('domain', [-2 -2; 2 2], 'f', @(x) sum(x.^3.2), 'relTol', 0.1, 'isShift', false)"
ok 3 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 4 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 5 - "inpStruct.isShift = false;"
ok 6 - "cubLatticeParamObj = gail.cubLatticeParam(inpStruct)"
ok 7 - "NewCubLatticeParamObj = gail.cubLatticeParam(cubLatticeParamObj,'measure','Lebesgue')"
time =
    0.5273
TAP version 13
1..8
ok 1 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam"
ok 2 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam(@(x) sum(x.^3.2),[0 0; 2 2])"
ok 3 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam('domain', [0 0; 1 1], 'f', @(x) sum(x.^3.2), 'relTol', 0.1,'kerName','Ber4')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.kerName = 'Ber4';"
ok 7 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam(inpStruct)"
ok 8 - "NewCubBayesLatticeParamObj = gail.cubBayesLatticeParam(cubBayesLatticeParamObj,'GPMean',0)"
time =
    0.5607
TAP version 13
1..5
ok 1 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam; %an input object"
ok 2 - "cubBayesLatticeOutObj = gail.cubBayesLatticeOut(cubBayesLatticeParamObj); %copied to becom an output object"
ok 3 - "cubBayesLatticeOutObj.mu = 1.467; %integral value is recorded"
ok 4 - "cubBayesLatticeOutObj.nSample = 31415926; %sample size is recorded"
ok 5 - "cubBayesLatticeOutObj.time = 0.0278 %time of computation is recorded"
time =
    0.4728
TAP version 13
1..8
ok 1 - "meanYParamObj = gail.meanYParam"
ok 2 - "meanYParamObj = gail.meanYParam(@(n) sum(rand(n,4).^3,2),0.001)"
ok 3 - "meanYParamObj = gail.meanYParam('nSig', 1e4, 'Y', @(n)sin(sum(rand(n,4).^3,2)), 'relTol', 0.1)"
ok 4 - "inpStruct.Y = @(n) sin(sum(rand(n,2),2));"
ok 5 - "inpStruct.nSig = 1e4;"
ok 6 - "inpStruct.relTol = 0.1;"
ok 7 - "meanYParamObj = gail.meanYParam(inpStruct)"
ok 8 - "NewMeanYParamObj = gail.meanYParam(meanYParamObj,'Y',@(n) rand(n,3))"
time =
    0.5037
TAP version 13
1..7
ok 1 - "meanParamObj = gail.meanYParam; %an input object"
ok 2 - "meanOutObj = gail.meanYOut(meanParamObj); %copied to becom an output object"
ok 3 - "meanOutObj.sol = 1.467; %integral value is recorded"
ok 4 - "meanOutObj.stddev = 1.23; %standard deviation is recorded"
ok 5 - "meanOutObj.nSample = 31415926; %sample size is recorded"
ok 6 - "meanOutObj.time = 0.0278; %time of computation is recorded"
ok 7 - "meanOutObj.errBd = 0.000456 %error bound is recorded"
time =
    0.4413
total_time =
   38.3603
>> gailpbs_tests: Input arg R2019b

                            < M A T L A B (R) >
                  Copyright 1984-2019 The MathWorks, Inc.
                  R2019b (9.7.0.1190202) 64-bit (glnxa64)
                              August 21, 2019

 
To get started, type doc.
For product information, visit www.mathworks.com.
 
>> >> >> >> 
Welcome to Guaranteed Automatic Integration Library (GAIL).
You are installing GAIL v2.3.1.

[Warning: Unable to save path to file
'/share/apps/matlab/R2019b/toolbox/local/pathdef.m'. You can save your path to
a different location by calling SAVEPATH with an input argument that specifies
the full path. For MATLAB to use that path in future sessions, save the path to
'pathdef.m' in your MATLAB startup folder.] 
[> In savepath (line 176)
  In GAIL_Install (line 20)] 

GAIL version 2.3.1 has been installed successfully.

>> >> >> >> GAILVERSION = 2.3.1.  MATLABVERSION = 9.7
TAP version 13
1..24
ok 1 - "help cubBayesNet_g"
ok 2 - "warning('off','GAIL:cubBayesNet_g:fdnotgiven')"
ok 3 - "[~,muhat] = cubBayesNet_g;"
ok 4 - "exactInteg = 1.0/3;"
ok 5 - "warning('on','GAIL:cubBayesNet_g:fdnotgiven')"
ok 6 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 7 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 8 - "dim=2; absTol=1e-3; relTol=1e-2;"
ok 9 - "exactInteg = besseli(0,1)^dim;"
ok 10 - "inputArgs = {'absTol',absTol,'relTol',relTol};"
ok 11 - "[~,muhat]=cubBayesNet_g(fun, dim, inputArgs{:});"
ok 12 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
ok 13 - "help cubBayesNet_g"
ok 14 - "warning('off','GAIL:cubBayesNet_g:fdnotgiven')"
ok 15 - "[~,muhat] = cubBayesNet_g;"
ok 16 - "exactInteg = 1.0/3;"
ok 17 - "warning('on','GAIL:cubBayesNet_g:fdnotgiven')"
ok 18 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 19 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 20 - "dim=2; absTol=1e-3; relTol=1e-2;"
ok 21 - "exactInteg = besseli(0,1)^dim;"
ok 22 - "inputArgs = {'absTol',absTol,'relTol',relTol};"
ok 23 - "[~,muhat]=cubBayesNet_g(fun, dim, inputArgs{:});"
ok 24 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
time =
    8.0808
TAP version 13
1..30
ok 1 - "help cubBayesLattice_g"
ok 2 - "warning('off','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 3 - "[~,muhat] = cubBayesLattice_g;"
ok 4 - "exactInteg = 1.0/3;"
ok 5 - "warning('on','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 6 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 7 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 8 - "dim=2; absTol=1e-2; relTol=1e-2;"
ok 9 - "exactInteg = besseli(0,1)^dim;"
ok 10 - "inputArgs = {'relTol',relTol, 'order',2, 'ptransform','C1sin'};"
ok 11 - "inputArgs = [{fun, dim, 'absTol',absTol,'oneTheta',false} inputArgs];"
ok 12 - "obj=cubBayesLattice_g(inputArgs{:});"
ok 13 - "[muhat,outParams]=compInteg(obj);"
ok 14 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
ok 15 - "etaDim = size(outParams.optParams.aMLEAll, 2)"
ok 16 - "help cubBayesLattice_g"
ok 17 - "warning('off','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 18 - "[~,muhat] = cubBayesLattice_g;"
ok 19 - "exactInteg = 1.0/3;"
ok 20 - "warning('on','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 21 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 22 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 23 - "dim=2; absTol=1e-2; relTol=1e-2;"
ok 24 - "exactInteg = besseli(0,1)^dim;"
ok 25 - "inputArgs = {'relTol',relTol, 'order',2, 'ptransform','C1sin'};"
ok 26 - "inputArgs = [{fun, dim, 'absTol',absTol,'oneTheta',false} inputArgs];"
ok 27 - "obj=cubBayesLattice_g(inputArgs{:});"
ok 28 - "[muhat,outParams]=compInteg(obj);"
ok 29 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
ok 30 - "etaDim = size(outParams.optParams.aMLEAll, 2)"
time =
    2.2207
TAP version 13
1..3
ok 1 - "q = integral_g(@(x) x.^2)"
ok 2 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',1,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 3 - "q = integral_g()"
time =
    0.2456
TAP version 13
1..17
ok 1 - "f = @(x) exp(-(x-1).^2); q = integral_g(f,'a',1,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 2 - "f = @(x) exp(-x.^2); q = integral_g(f,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 3 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',1,'b',2,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 4 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',2,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 5 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 6 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',3,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 7 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',-1,'b',3,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 8 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',-4.5,'b',1.5,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 9 - "q = integral_g(@(x)x.^2,'a',1)"
ok 10 - "q = integral_g(@(x)x.^2,'a',0,'b',Inf)"
ok 11 - "q = integral_g(@(x)x.^2,'a',Inf)"
ok 12 - "q = integral_g(@(x)x.^2,'a',NaN)"
ok 13 - "q = integral_g(@(x)x.^2,'a',0,'b',NaN)"
ok 14 - "q = integral_g(@(x)x.^2,'a',1,'b',0)"
ok 15 - "q = integral_g(@(x)x.^2,'a',0,'b',2,'nlo',10,'nhi',100)"
ok 16 - " inparam.a=0; inparam.b=3; inparam.abstol=1e-13; q=integral_g(@(x) exp(2*x),inparam)"
ok 17 - "q = integral_g(@(x) x.^2,'a',-1,'b',1)"
time =
    0.1184

Running ut_integral_g
........
Done ut_integral_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   0.075498 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
      ut_integral_g/testerrorfabstolnmax        1        0          0     0.0024
          ut_integral_g/testsinefunction        1        0          0     0.0028
                ut_integral_g/testerrorf        1        0          0     0.0046
           ut_integral_g/testerrorfninit        1        0          0     0.0065
            ut_integral_g/testerrorfnamx        1        0          0     0.0068
     ut_integral_g/testerrorfabstolninit        1        0          0     0.0106
          ut_integral_g/testerrorOfExp2x        1        0          0     0.0108
          ut_integral_g/testerrorfabstol        1        0          0     0.0309

TAP version 13
1..7
ok 1 - "f = @(x) x.^2;"
ok 2 - "[~, out_param] = funappx_g(f,-2,2,1e-7,18)"
ok 3 - "f = @(x) x.^2;"
ok 4 - "[~, out_param] = funappx_g(f,'a',-2,'b',2,'ninit',17)"
ok 5 - "in_param.a = -5; in_param.b = 5; f = @(x) x.^2;"
ok 6 - "in_param.abstol = 10^(-6); in_param.ninit=18;"
ok 7 - "[~, out_param] = funappx_g(f,in_param)"
time =
    0.3233
TAP version 13
1..11
ok 1 - "funappx_g"
ok 2 - "clear in_param; in_param.a = -5; in_param.b =5; in_param.abstol = 10^(-7); "
ok 3 - "[~, out_param] = funappx_g(@(x) x.^2, in_param)"
ok 4 - "clear in_param; f = @(x) sin(x); in_param.a = -1; in_param.b = 1; "
ok 5 - "in_param.abstol = 10^(-8); in_param.ninit = 20; "
ok 6 - "[~, out_param] = funappx_g(f, in_param)"
ok 7 - "[~, out_param] = funappx_g(@(x) x.^3,'a',-2,'b',2,'abstol',1e-7,'ninit',41)"
ok 8 - "[~, out_param] = funappx_g(@(x) exp(-100*(x-0.7).^2),'a',0,'b',1,'ninit',28)"
ok 9 - "[~, out_param] = funappx_g(@(x) x.^2,'memorytest',1,'output_x',1);"
ok 10 - "out_param.bytes <= 280674"
ok 11 - "length(out_param.x) == out_param.npoints"
time =
    0.3284

Running ut_funappx_g
.......... .......
Done ut_funappx_g
__________

Totals:
   17 Passed, 0 Failed, 0 Incomplete.   1.0442 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
             ut_funappx_g/funappx_gOfxab        1        0          0     0.0059
       ut_funappx_g/funappx_gOfxsquareab        1        0          0     0.0063
         ut_funappx_g/funappx_gOf100000x        1        0          0     0.0116
               ut_funappx_g/funappx_gOfx        1        0          0     0.0121
   ut_funappx_g/funappx_gOfexponentialab        1        0          0     0.0124
           ut_funappx_g/funappx_gOfsinab        1        0          0     0.0143
             ut_funappx_g/funappx_gOfsin        1        0          0     0.0149
  ut_funappx_g/funappx_gOnpointsoflinear        1        0          0     0.0161
         ut_funappx_g/funappx_gOfxsquare        1        0          0     0.0198
ut_funappx_g/funappx_gOnpointsofconstant        1        0          0     0.0238
            ut_funappx_g/funappx_gOfbeqa        1        0          0     0.0365
    ut_funappx_g/funappx_gOfexceedbudget        1        0          0     0.0404
     ut_funappx_g/funappx_gOfexponential        1        0          0     0.0549
      ut_funappx_g/funappx_gOfnofunction        1        0          0     0.0601
      ut_funappx_g/funappx_gOfexceediter        1        0          0     0.0775
            ut_funappx_g/funappx_gOfblea        1        0          0     0.2116
ut_funappx_g/funappx_gofConstantFunction        1        0          0     0.4258

TAP version 13
1..12
ok 1 - "f = @(x) exp(0.01*(x-0.5).^2); [fmin,out_param] = funmin_g(f)"
ok 2 - "f = @(x) exp(0.01*(x-0.5).^2);"
ok 3 - "[fmin,out_param] = funmin_g(f,-2,2,1e-7,10,1000000)"
ok 4 - "f=@(x) exp(0.01*(x-0.5).^2);"
ok 5 - "in_param.a = -13; in_param.b = 8;"
ok 6 - "in_param.abstol = 10^(-7);"
ok 7 - "in_param.ninit = 100;"
ok 8 - "in_param.nmax = 10^6;"
ok 9 - "[fmin,out_param] = funmin_g(f,in_param)"
ok 10 - "f=@(x) exp(0.01*(x-0.5).^2);"
ok 11 - "[fmin,out_param] = funmin_g(f,'a',-2,'b',2,'ninit',64,'nmax',1e6,'abstol',1e-5)"
ok 12 - "out_param(:).intervals"
time =
    0.1184

Running ut_funmin_g
........
Done ut_funmin_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   0.79601 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
                ut_funmin_g/funmin_gEXM6        1        0          0     0.0066
                ut_funmin_g/funmin_gEXM2        1        0          0     0.0121
                ut_funmin_g/funmin_gEXM5        1        0          0     0.0184
                ut_funmin_g/funmin_gEXM3        1        0          0     0.0188
                ut_funmin_g/funmin_gEXM7        1        0          0     0.0226
                ut_funmin_g/funmin_gEXM1        1        0          0     0.0520
                ut_funmin_g/funmin_gEXM4        1        0          0     0.1255
                ut_funmin_g/funmin_gEXM8        1        0          0     0.5400


Running ut_funmin_g_end
..
Done ut_funmin_g_end
__________

Totals:
   2 Passed, 0 Failed, 0 Incomplete.   0.047221 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
            ut_funmin_g_end/funmin_gEXM2        1        0          0     0.0096
            ut_funmin_g_end/funmin_gEXM1        1        0          0     0.0376

TAP version 13
1..10
ok 1 - "meanMC_g"
ok 2 - "in_param.reltol = 0; in_param.abstol = 1e-3;"
ok 3 - "in_param.alpha = 0.05; Yrand=@(n) rand(n,1).^2;"
ok 4 - "tmu = meanMC_g(Yrand,in_param); exactsol = 1/3;"
ok 5 - "check = double(abs(exactsol-tmu) < 1e-3)"
ok 6 - "tmu = meanMC_g(@(n)exp(rand(n,1)),1e-3,0); exactsol = exp(1)-1;"
ok 7 - "check = double(abs(exactsol-tmu) < 1e-3)"
ok 8 - "tmu = meanMC_g(@(n)cos(rand(n,1)),'reltol',1e-3,'abstol',1e-4,'alpha',0.01);"
ok 9 - "exactsol = sin(1);"
ok 10 - "check = double(abs(exactsol-tmu) < max(1e-3,1e-2*abs(exactsol)))"
time =
    0.0295

Running ut_meanMC_g
......
Done ut_meanMC_g
__________

Totals:
   6 Passed, 0 Failed, 0 Incomplete.   2.15 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
               ut_meanMC_g/meanMC_gOfsin        1        0          0     0.0098
           ut_meanMC_g/meanMC_gOfxsquare        1        0          0     0.0158
    ut_meanMC_g/meanMC_gOfnonRandomInput        1        0          0     0.0184
           ut_meanMC_g/meanMC_gOfparsing        1        0          0     0.0322
               ut_meanMC_g/meanMC_gOfexp        1        0          0     0.0459
          ut_meanMC_g/meanMC_gOfWorkouts        1        0          0     2.0278

TAP version 13
1..22
ok 1 - "cubMC_g"
ok 2 - "f = @(x) sin(x); interval = [1;2];"
ok 3 - "Q = cubMC_g(f,interval,'uniform',1e-3,1e-2);"
ok 4 - "exactsol = 0.9564;"
ok 5 - "check = double(abs(exactsol-Q) < max(1e-3,1e-2*abs(exactsol)))"
ok 6 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [0 0;1 1];"
ok 7 - "Q = cubMC_g(f,hyperbox,'uniform',1e-3,0);"
ok 8 - "exactsol = 0.5577;"
ok 9 - "check = double(abs(exactsol-Q) < 1e-3)"
ok 10 - "d = 3; f = @(x) 2^d*prod(x,2)+0.555; hyperbox =[zeros(1,d); ones(1,d)];"
ok 11 - "in_param.abstol = 1e-3; in_param.reltol = 1e-3;"
ok 12 - "Q = cubMC_g(f,hyperbox,in_param);"
ok 13 - "exactsol = 1.555;"
ok 14 - "check = double(abs(exactsol-Q) < max(1e-3,1e-3*abs(exactsol)))"
ok 15 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-inf -inf;inf inf];"
ok 16 - "Q = cubMC_g(f,hyperbox,'normal',0,1e-2);"
ok 17 - "exactsol = 1/3;"
ok 18 - "check = double(abs(exactsol-Q) < max(0,1e-2*abs(exactsol)))"
ok 19 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1];"
ok 20 - "Q = cubMC_g(f,hyperbox,'uniform ball','abstol',1e-3,'reltol',1e-3);"
ok 21 - "exactsol = pi/2;"
ok 22 - "check = double(abs(exactsol-Q) < max(1e-3,1e-3*abs(exactsol)))"
time =
    0.9416
TAP version 13
1..21
ok 1 - "f = @(x) prod(x,2); hyperbox = [zeros(1,2);ones(1,2)];"
ok 2 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0,'transform','C1sin'); exactsol = 1/4;"
ok 3 - "check = double(abs(exactsol-q) < 1e-5)"
ok 4 - "f = @(x) x(:,1).^2.*x(:,2).^2.*x(:,3).^2; hyperbox = [-inf(1,3);inf(1,3)];"
ok 5 - "q = cubLattice_g(f,hyperbox,'normal',1e-3,1e-3,'transform','C1sin','shift',2^(-25)*ones(1,3)); exactsol = 1;"
ok 6 - "check = double(abs(exactsol-q) < max(1e-3,1e-3*abs(exactsol)))"
ok 7 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-ones(1,2);2*ones(1,2)];"
ok 8 - "q = cubLattice_g(f,hyperbox,'uniform',1e-3,1e-2,'transform','C1'); exactsol = 1/9*(sqrt(pi)/2*(erf(2)+erf(1)))^2;"
ok 9 - "check = double(abs(exactsol-q) < max(1e-3,1e-2*abs(exactsol)))"
ok 10 - "f = @(x) exp(-0.05^2/2)*max(100*exp(0.05*x)-100,0); hyperbox = [-inf(1,1);inf(1,1)];"
ok 11 - "q = cubLattice_g(f,hyperbox,'normal',1e-4,1e-2,'transform','C1sin'); price = normcdf(0.05)*100 - 0.5*100*exp(-0.05^2/2);"
ok 12 - "check = double(abs(price-q) < max(1e-4,1e-2*abs(price)))"
ok 13 - "f = @(x) 8*prod(x,2); hyperbox = [zeros(1,5);ones(1,5)];"
ok 14 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 15 - "check = double(abs(exactsol-q) < 1e-5)"
ok 16 - "f = @(x) 3./(5-4*(cos(2*pi*x))); hyperbox = [0;1];"
ok 17 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0,'transform','id'); exactsol = 1;"
ok 18 - "check = double(abs(exactsol-q) < 1e-5)"
ok 19 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1];"
ok 20 - "q = cubLattice_g(f,hyperbox,'uniform ball','abstol',1e-4,'reltol',0); exactsol = pi/2;"
ok 21 - "check = double(abs(exactsol-q) < 1e-4)"
time =
    0.6417

Running ut_cubLattice_g
.......
  Dim  FcnIdx       Q        f_true          Err      Sample Used      Stats  
-----------------------------------------------------------------------------------------------------
     1      1 +8.41471e-01 +8.41471e-01 1.32673e-07   1024             BothErrMet
     1      2 +7.85398e-01 +7.85398e-01 7.45098e-08   1024             BothErrMet
     1      3 +3.75000e-01 +3.75000e-01 1.75564e-07   1024             BothErrMet
     1      4 +7.46824e-01 +7.46824e-01 1.84046e-08   1024             BothErrMet
     1      5 +6.32121e-01 +6.32121e-01 5.24246e-08   1024             BothErrMet
     2      1 +4.96751e-01 +4.96751e-01 1.80736e-08   1024             BothErrMet
     2      2 +7.28296e-01 +7.28296e-01 3.30148e-07   1024             BothErrMet
     2      3 +1.01854e-01 +1.01852e-01 2.46361e-06   2048             BothErrMet
     2      4 +6.88992e-01 +6.88992e-01 3.53293e-07   1024             BothErrMet
     2      5 +4.97439e-01 +4.97440e-01 7.25513e-07   1024             BothErrMet
     3      1 +6.23594e-02 +6.23593e-02 8.68149e-08   2048             BothErrMet
     3      2 +6.62569e-01 +6.62570e-01 1.00495e-06   1024             BothErrMet
     3      3 +2.18552e-02 +2.17014e-02 1.53820e-04   1024             AbsErrMet
     3      4 +6.20903e-01 +6.20903e-01 8.76758e-07   1024             BothErrMet
     3      5 +3.83053e-01 +3.83055e-01 1.32945e-06   1024             BothErrMet
     4      1 -3.51762e-01 -3.51764e-01 1.67575e-06   4096             BothErrMet
     4      2 +5.88682e-01 +5.88680e-01 2.35626e-06   1024             BothErrMet
     4      3 +3.63265e-03 +3.80556e-03 1.72907e-04   1024             AbsErrMet
     4      4 +5.43348e-01 +5.43373e-01 2.56990e-05   1024             BothErrMet
     4      5 +2.86779e-01 +2.86844e-01 6.45888e-05   1024             BothErrMet
     5      1 -6.49323e-01 -6.49331e-01 7.78595e-06   4096             BothErrMet
     5      2 +5.13388e-01 +5.13409e-01 2.09419e-05   1024             BothErrMet
     5      3 +5.66398e-04 +5.67130e-04 7.32036e-07   1024             AbsErrMet
     5      4 +4.64614e-01 +4.64603e-01 1.09926e-05   2048             BothErrMet
     5      5 +2.10052e-01 +2.09952e-01 9.97594e-05   1024             BothErrMet
     6      1 -7.69087e-01 -7.69376e-01 2.89156e-04   8192             BothErrMet
     6      2 +4.41478e-01 +4.41474e-01 4.78350e-06   2048             BothErrMet
     6      3 +6.61501e-05 +7.34937e-05 7.34357e-06   1024             AbsErrMet
     6      4 +3.90240e-01 +3.90227e-01 1.29893e-05   2048             BothErrMet
     6      5 +1.50880e-01 +1.50939e-01 5.86716e-05   2048             BothErrMet
     7      1 -6.97483e-01 -6.97824e-01 3.40932e-04   8192             BothErrMet
     7      2 +3.75533e-01 +3.75484e-01 4.88606e-05   2048             BothErrMet
     7      3 +6.20153e-06 +8.42590e-06 2.22436e-06   1024             AbsErrMet
     7      4 +3.23218e-01 +3.23235e-01 1.67617e-05   4096             BothErrMet
     7      5 +1.06979e-01 +1.06978e-01 1.15223e-06   2048             BothErrMet
     8      1 -4.67286e-01 -4.67036e-01 2.49651e-04  16384             BothErrMet
     8      2 +3.16579e-01 +3.16602e-01 2.28765e-05   2048             BothErrMet
     8      3 +1.38342e-06 +8.66209e-07 5.17216e-07   1024             AbsErrMet
     8      4 +2.64743e-01 +2.64801e-01 5.78619e-05   4096             BothErrMet
     8      5 +7.49627e-02 +7.49531e-02 9.55330e-06   1024             BothErrMet
.
Done ut_cubLattice_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   2.7091 seconds testing time.
   100% Passed.
                                     Name   Passed   Failed Incomplete   Duration
        ut_cubLattice_g/cubLattice_gOfsin        1        0          0     0.0081
        ut_cubLattice_g/cubLattice_gOfexp        1        0          0     0.0088
    ut_cubLattice_g/cubLattice_gOdwarning        1        0          0     0.0247
    ut_cubLattice_g/cubLattice_gOfxsquare        1        0          0     0.0252
ut_cubLattice_g/cubLattice_gOfmultierrfun        1        0          0     0.0273
    ut_cubLattice_g/cubLattice_gOfwarning        1        0          0     0.0492
      ut_cubLattice_g/cubLattice_Workouts        1        0          0     0.4551
       ut_cubLattice_g/cubLattice_gNormal        1        0          0     2.1108

TAP version 13
1..26
ok 1 - "f = @(x) prod(x,2); hyperbox = [zeros(1,2);ones(1,2)];"
ok 2 - "q = cubSobol_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 3 - "check = double(abs(exactsol-q) < 1e-5)"
ok 4 - "f = @(x) x(:,1).^2.*x(:,2).^2.*x(:,3).^2; "
ok 5 - "hyperbox = [-inf(1,3);inf(1,3)]; exactsol = 1;"
ok 6 - "q = cubSobol_g(f,hyperbox,'normal',1e-3,1e-3, 'fudge',@(m) 10*2.^-m); "
ok 7 - "check = double(abs(exactsol-q) < max(1e-3,1e-3*abs(exactsol)))"
ok 8 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-ones(1,2);2*ones(1,2)];"
ok 9 - "q = cubSobol_g(f,hyperbox,'uniform',1e-3,1e-2); "
ok 10 - "exactsol = 1/9*(sqrt(pi)/2*(erf(2)+erf(1)))^2;"
ok 11 - "check = double(abs(exactsol-q) < max(1e-3,1e-2*abs(exactsol)))"
ok 12 - "f = @(x) exp(-0.05^2/2)*max(100*exp(0.05*x)-100,0); "
ok 13 - "hyperbox = [-inf(1,1);inf(1,1)];"
ok 14 - "q = cubSobol_g(f,hyperbox,'normal',1e-4,1e-2); "
ok 15 - "price = normcdf(0.05)*100 - 0.5*100*exp(-0.05^2/2);"
ok 16 - "check = double(abs(price-q) < max(1e-4,1e-2*abs(price)))"
ok 17 - "f = @(x) 8*prod(x,2); hyperbox = [zeros(1,5);ones(1,5)];"
ok 18 - "q = cubSobol_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 19 - "check = double(abs(exactsol-q) < 1e-5)"
ok 20 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1]; exactsol = pi/2;"
ok 21 - "q = cubSobol_g(f,hyperbox,'uniform ball','abstol',1e-4,'reltol',0); "
ok 22 - "check = double(abs(exactsol-q) < 1e-4)"
ok 23 - "g.func = @(x) [10*x(:,1)-5*x(:,2).^2+1*x(:,3).^3, x(:,1), x(:,2).^2];"
ok 24 - "g.cv = [1,4/3]; hyperbox= [zeros(1,3);2*ones(1,3)];"
ok 25 - "q = cubSobol_g(g,hyperbox,'uniform',1e-6,0); exactsol = 16/3;"
ok 26 - "check = double(abs(exactsol-q) < 1e-6)"
time =
   1.406365000000000

Running ut_cubSobol_g
.........Dim   FcnIdx       Q             f_true               Err            Sample Used             Stats  
-----------------------------------------------------------------------------------------------------
1     1       8.41471e-01       8.41471e-01       5.60056e-08         1024             BothErrMet
1     2       7.85398e-01       7.85398e-01       3.75589e-08         1024             BothErrMet
2     1       4.96751e-01       4.96751e-01       4.40724e-08         1024             BothErrMet
2     2       7.28296e-01       7.28296e-01       2.07627e-07         1024             BothErrMet
3     1       6.23662e-02       6.23593e-02       6.91056e-06         1024             BothErrMet
3     2       6.62568e-01       6.62570e-01       1.59447e-06         1024             BothErrMet
.
Done ut_cubSobol_g
__________

Totals:
   10 Passed, 0 Failed, 0 Incomplete.   1.2614 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
           ut_cubSobol_g/cubSobol_gOfsin        1        0          0     0.0092
           ut_cubSobol_g/cubSobol_gOfexp        1        0          0     0.0097
    ut_cubSobol_g/cubSobol_gOfmultierfcv        1        0          0     0.0153
   ut_cubSobol_g/cubSobol_gOfmultierrfun        1        0          0     0.0204
       ut_cubSobol_g/cubSobol_gOdwarning        1        0          0     0.0235
        ut_cubSobol_g/cubSobol_gOfpolycv        1        0          0     0.0296
       ut_cubSobol_g/cubSobol_gOfxsquare        1        0          0     0.0296
       ut_cubSobol_g/cubSobol_gOfwarning        1        0          0     0.0407
         ut_cubSobol_g/cubSobol_Workouts        1        0          0     0.1097
    ut_cubSobol_g/cubSobol_gOfgmeanOptcv        1        0          0     0.9735

TAP version 13
1..2
ok 1 - "obj = assetPath"
ok 2 - "obj = assetPath"
time =
    0.8855
TAP version 13
1..2
ok 1 - "obj = optPayoff"
ok 2 - "obj = optPayoff"
time =
    0.7961
TAP version 13
1..2
ok 1 - "obj = optPrice"
ok 2 - "obj = optPrice"
time =
    0.9798
TAP version 13
1..2
ok 1 - "obj = brownianMotion"
ok 2 - "obj = brownianMotion"
time =
    0.7707
TAP version 13
1..1
ok 1 - "obj = stochProcess"
time =
    0.6280
TAP version 13
1..2
ok 1 - "obj = whiteNoise"
ok 2 - "obj = whiteNoise"
time =
    0.6331
TAP version 13
1..4
ok 1 - "errParamObj = gail.errorParam"
ok 2 - "errParamObj = gail.errorParam(0.001)"
ok 3 - "errParamObj = gail.errorParam('relTol',0.1)"
ok 4 - "newErrParamObj = gail.errorParam(errParamObj,'relTol',0.001)"
time =
    0.6751
TAP version 13
1..12
ok 1 - "fParamObj = gail.fParam"
ok 2 - "fParamObj = gail.fParam(@(x) sum(x.^3.2),[0 0; 1 1])"
ok 3 - "fParamObj = gail.fParam(@(x) sum(x.^3.2),[0 0; 1 1],'ball')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.relTol = 0.1;"
ok 7 - "fParamObj = gail.fParam(inpStruct)"
ok 8 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 9 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 10 - "inpStruct.relTol = 0.1;"
ok 11 - "fParamObj = gail.fParam(inpStruct,0.0001,0.01)"
ok 12 - "newfParamObj = gail.fParam(fParamObj,'domainType','sphere')"
time =
    0.5573
TAP version 13
1..8
ok 1 - "cubParamObj = gail.cubParam"
ok 2 - "cubParamObj = gail.cubParam(@(x) sum(x.^3.2),[0 0; 2 2],'box','Lebesgue')"
ok 3 - "cubParamObj = gail.cubParam('domain', [-Inf -Inf; Inf Inf], 'f', @(x) sum(x.^3.2), 'relTol', 0.1, 'measure', 'Gaussian')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.nInit = 2048;"
ok 7 - "cubParamObj = gail.cubParam(inpStruct)"
ok 8 - "NewCubParamObj = gail.cubParam(cubParamObj,'measure','Lebesgue')"
time =
    0.6586
TAP version 13
1..5
ok 1 - "cubParamObj = gail.cubParam; %an input object"
ok 2 - "cubOutObj = gail.cubOut(cubParamObj); %copied to becom an output object"
ok 3 - "cubOutObj.mu = 1.467; %integral value is recorded"
ok 4 - "cubOutObj.nSample = 31415926; %sample size is recorded"
ok 5 - "cubOutObj.time = 0.0278 %time of computation is recorded"
time =
    0.5467
TAP version 13
1..7
ok 1 - "cubLatticeParamObj = gail.cubLatticeParam"
ok 2 - "cubLatticeParamObj = gail.cubLatticeParam('domain', [-2 -2; 2 2], 'f', @(x) sum(x.^3.2), 'relTol', 0.1, 'isShift', false)"
ok 3 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 4 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 5 - "inpStruct.isShift = false;"
ok 6 - "cubLatticeParamObj = gail.cubLatticeParam(inpStruct)"
ok 7 - "NewCubLatticeParamObj = gail.cubLatticeParam(cubLatticeParamObj,'measure','Lebesgue')"
time =
    0.5814
TAP version 13
1..8
ok 1 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam"
ok 2 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam(@(x) sum(x.^3.2),[0 0; 2 2])"
ok 3 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam('domain', [0 0; 1 1], 'f', @(x) sum(x.^3.2), 'relTol', 0.1,'kerName','Ber4')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.kerName = 'Ber4';"
ok 7 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam(inpStruct)"
ok 8 - "NewCubBayesLatticeParamObj = gail.cubBayesLatticeParam(cubBayesLatticeParamObj,'GPMean',0)"
time =
    0.6465
TAP version 13
1..5
ok 1 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam; %an input object"
ok 2 - "cubBayesLatticeOutObj = gail.cubBayesLatticeOut(cubBayesLatticeParamObj); %copied to becom an output object"
ok 3 - "cubBayesLatticeOutObj.mu = 1.467; %integral value is recorded"
ok 4 - "cubBayesLatticeOutObj.nSample = 31415926; %sample size is recorded"
ok 5 - "cubBayesLatticeOutObj.time = 0.0278 %time of computation is recorded"
time =
    0.6280
TAP version 13
1..8
ok 1 - "meanYParamObj = gail.meanYParam"
ok 2 - "meanYParamObj = gail.meanYParam(@(n) sum(rand(n,4).^3,2),0.001)"
ok 3 - "meanYParamObj = gail.meanYParam('nSig', 1e4, 'Y', @(n)sin(sum(rand(n,4).^3,2)), 'relTol', 0.1)"
ok 4 - "inpStruct.Y = @(n) sin(sum(rand(n,2),2));"
ok 5 - "inpStruct.nSig = 1e4;"
ok 6 - "inpStruct.relTol = 0.1;"
ok 7 - "meanYParamObj = gail.meanYParam(inpStruct)"
ok 8 - "NewMeanYParamObj = gail.meanYParam(meanYParamObj,'Y',@(n) rand(n,3))"
time =
    0.6470
TAP version 13
1..7
ok 1 - "meanParamObj = gail.meanYParam; %an input object"
ok 2 - "meanOutObj = gail.meanYOut(meanParamObj); %copied to becom an output object"
ok 3 - "meanOutObj.sol = 1.467; %integral value is recorded"
ok 4 - "meanOutObj.stddev = 1.23; %standard deviation is recorded"
ok 5 - "meanOutObj.nSample = 31415926; %sample size is recorded"
ok 6 - "meanOutObj.time = 0.0278; %time of computation is recorded"
ok 7 - "meanOutObj.errBd = 0.000456 %error bound is recorded"
time =
    0.6094
total_time =
   39.0320
>> gailpbs_tests: Input arg R2020a

                            < M A T L A B (R) >
                  Copyright 1984-2020 The MathWorks, Inc.
                  R2020a (9.8.0.1323502) 64-bit (glnxa64)
                             February 25, 2020

 
To get started, type doc.
For product information, visit www.mathworks.com.
 
>> >> >> >> 
Welcome to Guaranteed Automatic Integration Library (GAIL).
You are installing GAIL v2.3.1.

[Warning: Unable to save path to file
'/share/apps/matlab/R2020a/toolbox/local/pathdef.m'. You can save your path to
a different location by calling SAVEPATH with an input argument that specifies
the full path. For MATLAB to use that path in future sessions, save the path to
'pathdef.m' in your MATLAB startup folder.] 
[> In savepath (line 176)
  In GAIL_Install (line 20)] 

GAIL version 2.3.1 has been installed successfully.

>> >> >> >> GAILVERSION = 2.3.1.  MATLABVERSION = 9.8
TAP version 13
1..24
ok 1 - "help cubBayesNet_g"
ok 2 - "warning('off','GAIL:cubBayesNet_g:fdnotgiven')"
ok 3 - "[~,muhat] = cubBayesNet_g;"
ok 4 - "exactInteg = 1.0/3;"
ok 5 - "warning('on','GAIL:cubBayesNet_g:fdnotgiven')"
ok 6 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 7 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 8 - "dim=2; absTol=1e-3; relTol=1e-2;"
ok 9 - "exactInteg = besseli(0,1)^dim;"
ok 10 - "inputArgs = {'absTol',absTol,'relTol',relTol};"
ok 11 - "[~,muhat]=cubBayesNet_g(fun, dim, inputArgs{:});"
ok 12 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
ok 13 - "help cubBayesNet_g"
ok 14 - "warning('off','GAIL:cubBayesNet_g:fdnotgiven')"
ok 15 - "[~,muhat] = cubBayesNet_g;"
ok 16 - "exactInteg = 1.0/3;"
ok 17 - "warning('on','GAIL:cubBayesNet_g:fdnotgiven')"
ok 18 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 19 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 20 - "dim=2; absTol=1e-3; relTol=1e-2;"
ok 21 - "exactInteg = besseli(0,1)^dim;"
ok 22 - "inputArgs = {'absTol',absTol,'relTol',relTol};"
ok 23 - "[~,muhat]=cubBayesNet_g(fun, dim, inputArgs{:});"
ok 24 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
time =
    9.2790
TAP version 13
1..30
ok 1 - "help cubBayesLattice_g"
ok 2 - "warning('off','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 3 - "[~,muhat] = cubBayesLattice_g;"
ok 4 - "exactInteg = 1.0/3;"
ok 5 - "warning('on','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 6 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 7 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 8 - "dim=2; absTol=1e-2; relTol=1e-2;"
ok 9 - "exactInteg = besseli(0,1)^dim;"
ok 10 - "inputArgs = {'relTol',relTol, 'order',2, 'ptransform','C1sin'};"
ok 11 - "inputArgs = [{fun, dim, 'absTol',absTol,'oneTheta',false} inputArgs];"
ok 12 - "obj=cubBayesLattice_g(inputArgs{:});"
ok 13 - "[muhat,outParams]=compInteg(obj);"
ok 14 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
ok 15 - "etaDim = size(outParams.optParams.aMLEAll, 2)"
ok 16 - "help cubBayesLattice_g"
ok 17 - "warning('off','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 18 - "[~,muhat] = cubBayesLattice_g;"
ok 19 - "exactInteg = 1.0/3;"
ok 20 - "warning('on','GAIL:cubBayesLattice_g:fdnotgiven')"
ok 21 - "check = double(abs(exactInteg-muhat) < 0.01)"
ok 22 - "fun = @(x) exp(sum(cos(2*pi*x), 2));"
ok 23 - "dim=2; absTol=1e-2; relTol=1e-2;"
ok 24 - "exactInteg = besseli(0,1)^dim;"
ok 25 - "inputArgs = {'relTol',relTol, 'order',2, 'ptransform','C1sin'};"
ok 26 - "inputArgs = [{fun, dim, 'absTol',absTol,'oneTheta',false} inputArgs];"
ok 27 - "obj=cubBayesLattice_g(inputArgs{:});"
ok 28 - "[muhat,outParams]=compInteg(obj);"
ok 29 - "check = double(abs(exactInteg-muhat) < max(absTol,relTol*abs(exactInteg)))"
ok 30 - "etaDim = size(outParams.optParams.aMLEAll, 2)"
time =
    2.4539
TAP version 13
1..3
ok 1 - "q = integral_g(@(x) x.^2)"
ok 2 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',1,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 3 - "q = integral_g()"
time =
    0.2436
TAP version 13
1..17
ok 1 - "f = @(x) exp(-(x-1).^2); q = integral_g(f,'a',1,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 2 - "f = @(x) exp(-x.^2); q = integral_g(f,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 3 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',1,'b',2,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 4 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',2,'abstol',1e-5,'nhi',52,'nmax',1e7)"
ok 5 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',2,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 6 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',0,'b',3,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 7 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',-1,'b',3,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 8 - "f = @(x) exp(-x.^2); q = integral_g(f,'a',-4.5,'b',1.5,'nlo',100,'nhi',10000,'abstol',1e-5,'nmax',1e7)"
ok 9 - "q = integral_g(@(x)x.^2,'a',1)"
ok 10 - "q = integral_g(@(x)x.^2,'a',0,'b',Inf)"
ok 11 - "q = integral_g(@(x)x.^2,'a',Inf)"
ok 12 - "q = integral_g(@(x)x.^2,'a',NaN)"
ok 13 - "q = integral_g(@(x)x.^2,'a',0,'b',NaN)"
ok 14 - "q = integral_g(@(x)x.^2,'a',1,'b',0)"
ok 15 - "q = integral_g(@(x)x.^2,'a',0,'b',2,'nlo',10,'nhi',100)"
ok 16 - " inparam.a=0; inparam.b=3; inparam.abstol=1e-13; q=integral_g(@(x) exp(2*x),inparam)"
ok 17 - "q = integral_g(@(x) x.^2,'a',-1,'b',1)"
time =
    0.1431

Running ut_integral_g
........
Done ut_integral_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   0.10327 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
      ut_integral_g/testerrorfabstolnmax        1        0          0     0.0030
          ut_integral_g/testsinefunction        1        0          0     0.0035
                ut_integral_g/testerrorf        1        0          0     0.0057
           ut_integral_g/testerrorfninit        1        0          0     0.0113
            ut_integral_g/testerrorfnamx        1        0          0     0.0118
     ut_integral_g/testerrorfabstolninit        1        0          0     0.0128
          ut_integral_g/testerrorOfExp2x        1        0          0     0.0148
          ut_integral_g/testerrorfabstol        1        0          0     0.0403

TAP version 13
1..7
ok 1 - "f = @(x) x.^2;"
ok 2 - "[~, out_param] = funappx_g(f,-2,2,1e-7,18)"
ok 3 - "f = @(x) x.^2;"
ok 4 - "[~, out_param] = funappx_g(f,'a',-2,'b',2,'ninit',17)"
ok 5 - "in_param.a = -5; in_param.b = 5; f = @(x) x.^2;"
ok 6 - "in_param.abstol = 10^(-6); in_param.ninit=18;"
ok 7 - "[~, out_param] = funappx_g(f,in_param)"
time =
    0.2301
TAP version 13
1..11
ok 1 - "funappx_g"
ok 2 - "clear in_param; in_param.a = -5; in_param.b =5; in_param.abstol = 10^(-7); "
ok 3 - "[~, out_param] = funappx_g(@(x) x.^2, in_param)"
ok 4 - "clear in_param; f = @(x) sin(x); in_param.a = -1; in_param.b = 1; "
ok 5 - "in_param.abstol = 10^(-8); in_param.ninit = 20; "
ok 6 - "[~, out_param] = funappx_g(f, in_param)"
ok 7 - "[~, out_param] = funappx_g(@(x) x.^3,'a',-2,'b',2,'abstol',1e-7,'ninit',41)"
ok 8 - "[~, out_param] = funappx_g(@(x) exp(-100*(x-0.7).^2),'a',0,'b',1,'ninit',28)"
ok 9 - "[~, out_param] = funappx_g(@(x) x.^2,'memorytest',1,'output_x',1);"
ok 10 - "out_param.bytes <= 280674"
ok 11 - "length(out_param.x) == out_param.npoints"
time =
    0.3566

Running ut_funappx_g
.......... .......
Done ut_funappx_g
__________

Totals:
   17 Passed, 0 Failed, 0 Incomplete.   1.1028 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
             ut_funappx_g/funappx_gOfxab        1        0          0     0.0061
       ut_funappx_g/funappx_gOfxsquareab        1        0          0     0.0061
         ut_funappx_g/funappx_gOf100000x        1        0          0     0.0117
   ut_funappx_g/funappx_gOfexponentialab        1        0          0     0.0124
               ut_funappx_g/funappx_gOfx        1        0          0     0.0124
           ut_funappx_g/funappx_gOfsinab        1        0          0     0.0143
             ut_funappx_g/funappx_gOfsin        1        0          0     0.0156
  ut_funappx_g/funappx_gOnpointsoflinear        1        0          0     0.0167
         ut_funappx_g/funappx_gOfxsquare        1        0          0     0.0192
ut_funappx_g/funappx_gOnpointsofconstant        1        0          0     0.0281
            ut_funappx_g/funappx_gOfbeqa        1        0          0     0.0416
    ut_funappx_g/funappx_gOfexceedbudget        1        0          0     0.0428
     ut_funappx_g/funappx_gOfexponential        1        0          0     0.0539
      ut_funappx_g/funappx_gOfnofunction        1        0          0     0.0649
      ut_funappx_g/funappx_gOfexceediter        1        0          0     0.0867
            ut_funappx_g/funappx_gOfblea        1        0          0     0.2495
ut_funappx_g/funappx_gofConstantFunction        1        0          0     0.4207

TAP version 13
1..12
ok 1 - "f = @(x) exp(0.01*(x-0.5).^2); [fmin,out_param] = funmin_g(f)"
ok 2 - "f = @(x) exp(0.01*(x-0.5).^2);"
ok 3 - "[fmin,out_param] = funmin_g(f,-2,2,1e-7,10,1000000)"
ok 4 - "f=@(x) exp(0.01*(x-0.5).^2);"
ok 5 - "in_param.a = -13; in_param.b = 8;"
ok 6 - "in_param.abstol = 10^(-7);"
ok 7 - "in_param.ninit = 100;"
ok 8 - "in_param.nmax = 10^6;"
ok 9 - "[fmin,out_param] = funmin_g(f,in_param)"
ok 10 - "f=@(x) exp(0.01*(x-0.5).^2);"
ok 11 - "[fmin,out_param] = funmin_g(f,'a',-2,'b',2,'ninit',64,'nmax',1e6,'abstol',1e-5)"
ok 12 - "out_param(:).intervals"
time =
    0.1239

Running ut_funmin_g
........
Done ut_funmin_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   0.78128 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
                ut_funmin_g/funmin_gEXM6        1        0          0     0.0063
                ut_funmin_g/funmin_gEXM2        1        0          0     0.0133
                ut_funmin_g/funmin_gEXM3        1        0          0     0.0185
                ut_funmin_g/funmin_gEXM5        1        0          0     0.0189
                ut_funmin_g/funmin_gEXM7        1        0          0     0.0223
                ut_funmin_g/funmin_gEXM1        1        0          0     0.0543
                ut_funmin_g/funmin_gEXM4        1        0          0     0.1249
                ut_funmin_g/funmin_gEXM8        1        0          0     0.5229


Running ut_funmin_g_end
..
Done ut_funmin_g_end
__________

Totals:
   2 Passed, 0 Failed, 0 Incomplete.   0.059551 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
            ut_funmin_g_end/funmin_gEXM2        1        0          0     0.0109
            ut_funmin_g_end/funmin_gEXM1        1        0          0     0.0487

TAP version 13
1..10
ok 1 - "meanMC_g"
ok 2 - "in_param.reltol = 0; in_param.abstol = 1e-3;"
ok 3 - "in_param.alpha = 0.05; Yrand=@(n) rand(n,1).^2;"
ok 4 - "tmu = meanMC_g(Yrand,in_param); exactsol = 1/3;"
ok 5 - "check = double(abs(exactsol-tmu) < 1e-3)"
ok 6 - "tmu = meanMC_g(@(n)exp(rand(n,1)),1e-3,0); exactsol = exp(1)-1;"
ok 7 - "check = double(abs(exactsol-tmu) < 1e-3)"
ok 8 - "tmu = meanMC_g(@(n)cos(rand(n,1)),'reltol',1e-3,'abstol',1e-4,'alpha',0.01);"
ok 9 - "exactsol = sin(1);"
ok 10 - "check = double(abs(exactsol-tmu) < max(1e-3,1e-2*abs(exactsol)))"
time =
    0.0370

Running ut_meanMC_g
......
Done ut_meanMC_g
__________

Totals:
   6 Passed, 0 Failed, 0 Incomplete.   2.1214 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
               ut_meanMC_g/meanMC_gOfsin        1        0          0     0.0130
           ut_meanMC_g/meanMC_gOfxsquare        1        0          0     0.0200
    ut_meanMC_g/meanMC_gOfnonRandomInput        1        0          0     0.0286
           ut_meanMC_g/meanMC_gOfparsing        1        0          0     0.0418
               ut_meanMC_g/meanMC_gOfexp        1        0          0     0.0551
          ut_meanMC_g/meanMC_gOfWorkouts        1        0          0     1.9630

TAP version 13
1..22
ok 1 - "cubMC_g"
ok 2 - "f = @(x) sin(x); interval = [1;2];"
ok 3 - "Q = cubMC_g(f,interval,'uniform',1e-3,1e-2);"
ok 4 - "exactsol = 0.9564;"
ok 5 - "check = double(abs(exactsol-Q) < max(1e-3,1e-2*abs(exactsol)))"
ok 6 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [0 0;1 1];"
ok 7 - "Q = cubMC_g(f,hyperbox,'uniform',1e-3,0);"
ok 8 - "exactsol = 0.5577;"
ok 9 - "check = double(abs(exactsol-Q) < 1e-3)"
ok 10 - "d = 3; f = @(x) 2^d*prod(x,2)+0.555; hyperbox =[zeros(1,d); ones(1,d)];"
ok 11 - "in_param.abstol = 1e-3; in_param.reltol = 1e-3;"
ok 12 - "Q = cubMC_g(f,hyperbox,in_param);"
ok 13 - "exactsol = 1.555;"
ok 14 - "check = double(abs(exactsol-Q) < max(1e-3,1e-3*abs(exactsol)))"
ok 15 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-inf -inf;inf inf];"
ok 16 - "Q = cubMC_g(f,hyperbox,'normal',0,1e-2);"
ok 17 - "exactsol = 1/3;"
ok 18 - "check = double(abs(exactsol-Q) < max(0,1e-2*abs(exactsol)))"
ok 19 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1];"
ok 20 - "Q = cubMC_g(f,hyperbox,'uniform ball','abstol',1e-3,'reltol',1e-3);"
ok 21 - "exactsol = pi/2;"
ok 22 - "check = double(abs(exactsol-Q) < max(1e-3,1e-3*abs(exactsol)))"
time =
    0.9931
TAP version 13
1..21
ok 1 - "f = @(x) prod(x,2); hyperbox = [zeros(1,2);ones(1,2)];"
ok 2 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0,'transform','C1sin'); exactsol = 1/4;"
ok 3 - "check = double(abs(exactsol-q) < 1e-5)"
ok 4 - "f = @(x) x(:,1).^2.*x(:,2).^2.*x(:,3).^2; hyperbox = [-inf(1,3);inf(1,3)];"
ok 5 - "q = cubLattice_g(f,hyperbox,'normal',1e-3,1e-3,'transform','C1sin','shift',2^(-25)*ones(1,3)); exactsol = 1;"
ok 6 - "check = double(abs(exactsol-q) < max(1e-3,1e-3*abs(exactsol)))"
ok 7 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-ones(1,2);2*ones(1,2)];"
ok 8 - "q = cubLattice_g(f,hyperbox,'uniform',1e-3,1e-2,'transform','C1'); exactsol = 1/9*(sqrt(pi)/2*(erf(2)+erf(1)))^2;"
ok 9 - "check = double(abs(exactsol-q) < max(1e-3,1e-2*abs(exactsol)))"
ok 10 - "f = @(x) exp(-0.05^2/2)*max(100*exp(0.05*x)-100,0); hyperbox = [-inf(1,1);inf(1,1)];"
ok 11 - "q = cubLattice_g(f,hyperbox,'normal',1e-4,1e-2,'transform','C1sin'); price = normcdf(0.05)*100 - 0.5*100*exp(-0.05^2/2);"
ok 12 - "check = double(abs(price-q) < max(1e-4,1e-2*abs(price)))"
ok 13 - "f = @(x) 8*prod(x,2); hyperbox = [zeros(1,5);ones(1,5)];"
ok 14 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 15 - "check = double(abs(exactsol-q) < 1e-5)"
ok 16 - "f = @(x) 3./(5-4*(cos(2*pi*x))); hyperbox = [0;1];"
ok 17 - "q = cubLattice_g(f,hyperbox,'uniform',1e-5,0,'transform','id'); exactsol = 1;"
ok 18 - "check = double(abs(exactsol-q) < 1e-5)"
ok 19 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1];"
ok 20 - "q = cubLattice_g(f,hyperbox,'uniform ball','abstol',1e-4,'reltol',0); exactsol = pi/2;"
ok 21 - "check = double(abs(exactsol-q) < 1e-4)"
time =
    0.8227

Running ut_cubLattice_g
.......
  Dim  FcnIdx       Q        f_true          Err      Sample Used      Stats  
-----------------------------------------------------------------------------------------------------
     1      1 +8.41471e-01 +8.41471e-01 1.33746e-07   1024             BothErrMet
     1      2 +7.85398e-01 +7.85398e-01 2.11485e-08   1024             BothErrMet
     1      3 +3.75000e-01 +3.75000e-01 2.41843e-07   1024             BothErrMet
     1      4 +7.46824e-01 +7.46824e-01 1.15624e-07   1024             BothErrMet
     1      5 +6.32121e-01 +6.32121e-01 2.77049e-08   1024             BothErrMet
     2      1 +4.96751e-01 +4.96751e-01 5.55111e-08   1024             BothErrMet
     2      2 +7.28296e-01 +7.28296e-01 3.58618e-07   1024             BothErrMet
     2      3 +1.01856e-01 +1.01852e-01 4.64730e-06   2048             BothErrMet
     2      4 +6.88991e-01 +6.88992e-01 7.74098e-07   1024             BothErrMet
     2      5 +4.97439e-01 +4.97440e-01 9.12480e-07   1024             BothErrMet
     3      1 +6.23591e-02 +6.23593e-02 2.49053e-07   2048             BothErrMet
     3      2 +6.62570e-01 +6.62570e-01 2.77826e-07   1024             BothErrMet
     3      3 +2.19070e-02 +2.17014e-02 2.05629e-04   1024             AbsErrMet
     3      4 +6.20904e-01 +6.20903e-01 7.02525e-07   1024             BothErrMet
     3      5 +3.83053e-01 +3.83055e-01 1.07261e-06   1024             BothErrMet
     4      1 -3.51761e-01 -3.51764e-01 3.02715e-06   4096             BothErrMet
     4      2 +5.88679e-01 +5.88680e-01 9.26781e-07   1024             BothErrMet
     4      3 +3.85920e-03 +3.80556e-03 5.36485e-05   1024             AbsErrMet
     4      4 +5.43377e-01 +5.43373e-01 4.01803e-06   1024             BothErrMet
     4      5 +2.86924e-01 +2.86844e-01 7.97796e-05   1024             BothErrMet
     5      1 -6.49316e-01 -6.49331e-01 1.48379e-05   4096             BothErrMet
     5      2 +5.13380e-01 +5.13409e-01 2.87031e-05   1024             BothErrMet
     5      3 +5.21793e-04 +5.67130e-04 4.53369e-05   1024             AbsErrMet
     5      4 +4.64598e-01 +4.64603e-01 4.59315e-06   2048             BothErrMet
     5      5 +2.09847e-01 +2.09952e-01 1.05953e-04   1024             BothErrMet
     6      1 -7.69094e-01 -7.69376e-01 2.82075e-04   8192             BothErrMet
     6      2 +4.41476e-01 +4.41474e-01 2.24999e-06   2048             BothErrMet
     6      3 +7.21530e-05 +7.34937e-05 1.34064e-06   1024             AbsErrMet
     6      4 +3.90215e-01 +3.90227e-01 1.25715e-05   2048             BothErrMet
     6      5 +1.50942e-01 +1.50939e-01 2.48659e-06   2048             BothErrMet
     7      1 -6.97723e-01 -6.97824e-01 1.00557e-04   8192             BothErrMet
     7      2 +3.75403e-01 +3.75484e-01 8.02030e-05   2048             BothErrMet
     7      3 +6.46468e-06 +8.42590e-06 1.96121e-06   1024             AbsErrMet
     7      4 +3.23341e-01 +3.23235e-01 1.05318e-04   2048             BothErrMet
     7      5 +1.07003e-01 +1.06978e-01 2.51796e-05   2048             BothErrMet
     8      1 -4.67225e-01 -4.67036e-01 1.88734e-04  16384             BothErrMet
     8      2 +3.16553e-01 +3.16602e-01 4.89212e-05   2048             BothErrMet
     8      3 +8.57047e-07 +8.66209e-07 9.16127e-09   1024             AbsErrMet
     8      4 +2.64814e-01 +2.64801e-01 1.28232e-05   2048             BothErrMet
     8      5 +7.49537e-02 +7.49531e-02 5.28020e-07   1024             BothErrMet
.
Done ut_cubLattice_g
__________

Totals:
   8 Passed, 0 Failed, 0 Incomplete.   3.2272 seconds testing time.
   100% Passed.
                                     Name   Passed   Failed Incomplete   Duration
        ut_cubLattice_g/cubLattice_gOfsin        1        0          0     0.0160
        ut_cubLattice_g/cubLattice_gOfexp        1        0          0     0.0186
    ut_cubLattice_g/cubLattice_gOdwarning        1        0          0     0.0322
    ut_cubLattice_g/cubLattice_gOfxsquare        1        0          0     0.0340
ut_cubLattice_g/cubLattice_gOfmultierrfun        1        0          0     0.0364
    ut_cubLattice_g/cubLattice_gOfwarning        1        0          0     0.0622
      ut_cubLattice_g/cubLattice_Workouts        1        0          0     0.5732
       ut_cubLattice_g/cubLattice_gNormal        1        0          0     2.4545

TAP version 13
1..26
ok 1 - "f = @(x) prod(x,2); hyperbox = [zeros(1,2);ones(1,2)];"
ok 2 - "q = cubSobol_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 3 - "check = double(abs(exactsol-q) < 1e-5)"
ok 4 - "f = @(x) x(:,1).^2.*x(:,2).^2.*x(:,3).^2; "
ok 5 - "hyperbox = [-inf(1,3);inf(1,3)]; exactsol = 1;"
ok 6 - "q = cubSobol_g(f,hyperbox,'normal',1e-3,1e-3, 'fudge',@(m) 10*2.^-m); "
ok 7 - "check = double(abs(exactsol-q) < max(1e-3,1e-3*abs(exactsol)))"
ok 8 - "f = @(x) exp(-x(:,1).^2-x(:,2).^2); hyperbox = [-ones(1,2);2*ones(1,2)];"
ok 9 - "q = cubSobol_g(f,hyperbox,'uniform',1e-3,1e-2); "
ok 10 - "exactsol = 1/9*(sqrt(pi)/2*(erf(2)+erf(1)))^2;"
ok 11 - "check = double(abs(exactsol-q) < max(1e-3,1e-2*abs(exactsol)))"
ok 12 - "f = @(x) exp(-0.05^2/2)*max(100*exp(0.05*x)-100,0); "
ok 13 - "hyperbox = [-inf(1,1);inf(1,1)];"
ok 14 - "q = cubSobol_g(f,hyperbox,'normal',1e-4,1e-2); "
ok 15 - "price = normcdf(0.05)*100 - 0.5*100*exp(-0.05^2/2);"
ok 16 - "check = double(abs(price-q) < max(1e-4,1e-2*abs(price)))"
ok 17 - "f = @(x) 8*prod(x,2); hyperbox = [zeros(1,5);ones(1,5)];"
ok 18 - "q = cubSobol_g(f,hyperbox,'uniform',1e-5,0); exactsol = 1/4;"
ok 19 - "check = double(abs(exactsol-q) < 1e-5)"
ok 20 - "f = @(x) x(:,1).^2+x(:,2).^2; hyperbox = [0,0,1]; exactsol = pi/2;"
ok 21 - "q = cubSobol_g(f,hyperbox,'uniform ball','abstol',1e-4,'reltol',0); "
ok 22 - "check = double(abs(exactsol-q) < 1e-4)"
ok 23 - "g.func = @(x) [10*x(:,1)-5*x(:,2).^2+1*x(:,3).^3, x(:,1), x(:,2).^2];"
ok 24 - "g.cv = [1,4/3]; hyperbox= [zeros(1,3);2*ones(1,3)];"
ok 25 - "q = cubSobol_g(g,hyperbox,'uniform',1e-6,0); exactsol = 16/3;"
ok 26 - "check = double(abs(exactsol-q) < 1e-6)"
time =
   1.941543000000000

Running ut_cubSobol_g
.........Dim   FcnIdx       Q             f_true               Err            Sample Used             Stats  
-----------------------------------------------------------------------------------------------------
1     1       8.41471e-01       8.41471e-01       4.02848e-10         1024             BothErrMet
1     2       7.85398e-01       7.85398e-01       8.10875e-09         1024             BothErrMet
2     1       4.96739e-01       4.96751e-01       1.20487e-05         1024             BothErrMet
2     2       7.28296e-01       7.28296e-01       6.45443e-08         1024             BothErrMet
3     1       6.23579e-02       6.23593e-02       1.39988e-06         1024             BothErrMet
3     2       6.62576e-01       6.62570e-01       6.57076e-06         1024             BothErrMet
.
Done ut_cubSobol_g
__________

Totals:
   10 Passed, 0 Failed, 0 Incomplete.   1.897 seconds testing time.
   100% Passed.
                                    Name   Passed   Failed Incomplete   Duration
           ut_cubSobol_g/cubSobol_gOfsin        1        0          0     0.0078
           ut_cubSobol_g/cubSobol_gOfexp        1        0          0     0.0107
    ut_cubSobol_g/cubSobol_gOfmultierfcv        1        0          0     0.0190
   ut_cubSobol_g/cubSobol_gOfmultierrfun        1        0          0     0.0267
        ut_cubSobol_g/cubSobol_gOfpolycv        1        0          0     0.0326
       ut_cubSobol_g/cubSobol_gOfxsquare        1        0          0     0.0343
       ut_cubSobol_g/cubSobol_gOdwarning        1        0          0     0.0367
       ut_cubSobol_g/cubSobol_gOfwarning        1        0          0     0.0560
         ut_cubSobol_g/cubSobol_Workouts        1        0          0     0.1493
    ut_cubSobol_g/cubSobol_gOfgmeanOptcv        1        0          0     1.5240

TAP version 13
1..2
ok 1 - "obj = assetPath"
ok 2 - "obj = assetPath"
time =
    0.9841
TAP version 13
1..2
ok 1 - "obj = optPayoff"
ok 2 - "obj = optPayoff"
time =
    0.8902
TAP version 13
1..2
ok 1 - "obj = optPrice"
ok 2 - "obj = optPrice"
time =
    0.8994
TAP version 13
1..2
ok 1 - "obj = brownianMotion"
ok 2 - "obj = brownianMotion"
time =
    0.7587
TAP version 13
1..1
ok 1 - "obj = stochProcess"
time =
    0.5865
TAP version 13
1..2
ok 1 - "obj = whiteNoise"
ok 2 - "obj = whiteNoise"
time =
    0.8871
TAP version 13
1..4
ok 1 - "errParamObj = gail.errorParam"
ok 2 - "errParamObj = gail.errorParam(0.001)"
ok 3 - "errParamObj = gail.errorParam('relTol',0.1)"
ok 4 - "newErrParamObj = gail.errorParam(errParamObj,'relTol',0.001)"
time =
    0.6710
TAP version 13
1..12
ok 1 - "fParamObj = gail.fParam"
ok 2 - "fParamObj = gail.fParam(@(x) sum(x.^3.2),[0 0; 1 1])"
ok 3 - "fParamObj = gail.fParam(@(x) sum(x.^3.2),[0 0; 1 1],'ball')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.relTol = 0.1;"
ok 7 - "fParamObj = gail.fParam(inpStruct)"
ok 8 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 9 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 10 - "inpStruct.relTol = 0.1;"
ok 11 - "fParamObj = gail.fParam(inpStruct,0.0001,0.01)"
ok 12 - "newfParamObj = gail.fParam(fParamObj,'domainType','sphere')"
time =
    0.6725
TAP version 13
1..8
ok 1 - "cubParamObj = gail.cubParam"
ok 2 - "cubParamObj = gail.cubParam(@(x) sum(x.^3.2),[0 0; 2 2],'box','Lebesgue')"
ok 3 - "cubParamObj = gail.cubParam('domain', [-Inf -Inf; Inf Inf], 'f', @(x) sum(x.^3.2), 'relTol', 0.1, 'measure', 'Gaussian')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.nInit = 2048;"
ok 7 - "cubParamObj = gail.cubParam(inpStruct)"
ok 8 - "NewCubParamObj = gail.cubParam(cubParamObj,'measure','Lebesgue')"
time =
    0.6118
TAP version 13
1..5
ok 1 - "cubParamObj = gail.cubParam; %an input object"
ok 2 - "cubOutObj = gail.cubOut(cubParamObj); %copied to becom an output object"
ok 3 - "cubOutObj.mu = 1.467; %integral value is recorded"
ok 4 - "cubOutObj.nSample = 31415926; %sample size is recorded"
ok 5 - "cubOutObj.time = 0.0278 %time of computation is recorded"
time =
    0.4790
TAP version 13
1..7
ok 1 - "cubLatticeParamObj = gail.cubLatticeParam"
ok 2 - "cubLatticeParamObj = gail.cubLatticeParam('domain', [-2 -2; 2 2], 'f', @(x) sum(x.^3.2), 'relTol', 0.1, 'isShift', false)"
ok 3 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 4 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 5 - "inpStruct.isShift = false;"
ok 6 - "cubLatticeParamObj = gail.cubLatticeParam(inpStruct)"
ok 7 - "NewCubLatticeParamObj = gail.cubLatticeParam(cubLatticeParamObj,'measure','Lebesgue')"
time =
    0.5249
TAP version 13
1..8
ok 1 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam"
ok 2 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam(@(x) sum(x.^3.2),[0 0; 2 2])"
ok 3 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam('domain', [0 0; 1 1], 'f', @(x) sum(x.^3.2), 'relTol', 0.1,'kerName','Ber4')"
ok 4 - "inpStruct.f = @(x) sin(sum(x,2));"
ok 5 - "inpStruct.domain = [zeros(1,4); ones(1,4)];"
ok 6 - "inpStruct.kerName = 'Ber4';"
ok 7 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam(inpStruct)"
ok 8 - "NewCubBayesLatticeParamObj = gail.cubBayesLatticeParam(cubBayesLatticeParamObj,'GPMean',0)"
time =
    0.5400
TAP version 13
1..5
ok 1 - "cubBayesLatticeParamObj = gail.cubBayesLatticeParam; %an input object"
ok 2 - "cubBayesLatticeOutObj = gail.cubBayesLatticeOut(cubBayesLatticeParamObj); %copied to becom an output object"
ok 3 - "cubBayesLatticeOutObj.mu = 1.467; %integral value is recorded"
ok 4 - "cubBayesLatticeOutObj.nSample = 31415926; %sample size is recorded"
ok 5 - "cubBayesLatticeOutObj.time = 0.0278 %time of computation is recorded"
time =
    0.5146
TAP version 13
1..8
ok 1 - "meanYParamObj = gail.meanYParam"
ok 2 - "meanYParamObj = gail.meanYParam(@(n) sum(rand(n,4).^3,2),0.001)"
ok 3 - "meanYParamObj = gail.meanYParam('nSig', 1e4, 'Y', @(n)sin(sum(rand(n,4).^3,2)), 'relTol', 0.1)"
ok 4 - "inpStruct.Y = @(n) sin(sum(rand(n,2),2));"
ok 5 - "inpStruct.nSig = 1e4;"
ok 6 - "inpStruct.relTol = 0.1;"
ok 7 - "meanYParamObj = gail.meanYParam(inpStruct)"
ok 8 - "NewMeanYParamObj = gail.meanYParam(meanYParamObj,'Y',@(n) rand(n,3))"
time =
    0.6119
TAP version 13
1..7
ok 1 - "meanParamObj = gail.meanYParam; %an input object"
ok 2 - "meanOutObj = gail.meanYOut(meanParamObj); %copied to becom an output object"
ok 3 - "meanOutObj.sol = 1.467; %integral value is recorded"
ok 4 - "meanOutObj.stddev = 1.23; %standard deviation is recorded"
ok 5 - "meanOutObj.nSample = 31415926; %sample size is recorded"
ok 6 - "meanOutObj.time = 0.0278; %time of computation is recorded"
ok 7 - "meanOutObj.errBd = 0.000456 %error bound is recorded"
time =
    0.4665
total_time =
   43.3129
>> 