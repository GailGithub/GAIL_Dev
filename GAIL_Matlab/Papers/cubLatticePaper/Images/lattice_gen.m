function xlat = lattice_gen(nmin,nmax,d)
% d: dimension of the problem, 1<=d<=100.
% nmin,nmax: minimum and maximum indexes of the sequence:
%       xlat=[x_nmin,...,x_nmax]. 1<=nmin<=nmax<=2^27.
%       nmax must be defined as a power of 2 and we can only have
%       nmin=1 or nmin=nmax/2+1

% generating vector from L'Ecuyer generator d=100, 2^27
% z=[1, 55469281, 30027329, 8602267, 54785287, 14414253, 12439749,...
%     66155523, 49958529, 50678183, 55082445, 11596735, 56686781,...
%     30468193, 65851543, 28853873, 1986401, 31466969, 39713727,...
%     42030083, 45070517, 23411367, 60170803, 7421875, 18416989, 9887091,...
%     34346733, 53211753, 50444289, 50389313, 62221249, 17701367,...
%     33447805, 13284517, 9501243, 26751367, 9131609, 62968715, 8775773,...
%     49646523, 17475295, 49884785, 56867237, 49060203, 52023131, 47109331,...
%     54841717, 66225649, 36973289, 8012491, 51033753, 29350449, 30889251,...
%     32142699, 54738535, 45473269, 54947635, 27758697, 29790529, 26625455,...
%     60517011, 61153189, 5489635, 48516949, 66917801, 55940005, 776425,...
%     12712825, 20263211, 43152611, 44328075, 45998049, 36071913, 33802997,...
%     28026845, 32069741, 58205893, 7063485, 47516219, 15036803, 56954555,...
%     53480353, 62425513, 64392749, 22511733, 41470267, 61734105, 54699367,...
%     57054517, 52011193, 5277525, 12672943, 7978621, 56166235, 26118131,...
%     29491449, 29833283, 54467951, 33420145, 41944363];

% generating vector from L'Ecuyer generator d=100, 2^26
% z = [1, 27808567, 24248641, 20178749, 2740467, 8856057, 7545759, 12466787, 15015273, 18920429, 25821397, 12155423, 3983381, 33369453, 10737213, 31605679, 4711085, 17684585, 24635961, 7443167, 5478791, 4014225, 26554937, 19823151, 861961, 2385357, 31779889, 17752191, 1364051, 2309627, 30326431, 13984191, 27169917, 947571, 31197961, 20720809, 3933087, 12438895, 4778025, 19146039, 2524487, 15991747, 12067705, 14907455, 28109429, 17431689, 25005609, 16400575, 26654579, 19209331, 5672519, 18559297, 8562527, 32650881, 12277897, 8094849, 4000927, 7289759, 5225449, 10778105, 21171869, 12380517, 26879045, 32315547, 30678235, 10300617, 19287097, 14498883, 8864779, 29643711, 31029857, 6032657, 32215759, 16094821, 3127437, 26999405, 14578589, 29132213, 15632347, 12811051, 29701291, 32350061, 23020851, 20340811, 12656219, 28520033, 20040037, 19132097, 12204599, 14248593, 2598055, 9956595, 19650375, 24719083, 28037073, 8723061, 9129857, 9523117, 10101779, 29023151];

% generating vector from Dirk, max 2^20
% z = [ 1 182667 469891 498753 110745 446247 250185 118627 245333 283199 ...
%       408519 391023 246327 126539 399185 461527 300343 69681 516695 436179 ...
%       106383 238523 413283 70841 47719 300129 113029 123925 410745 211325 ...
%       17489 511893 40767 186077 519471 255369 101819 243573 66189 152143 ...
%       503455 113217 132603 463967 297717 157383 224015 502917 36237 94049 ...
%       170665 79397 123963 223451 323871 303633 98567 318855 494245 477137 ...
%       177975 64483 26695 88779 94497 239429 381007 110205 339157 73397 ...
%       407559 181791 442675 301397 32569 147737 189949 138655 350241 63371 ...
%       511925 515861 434045 383435 249187 492723 479195 84589 99703 239831 ...
%       269423 182241 61063 130789 143095 471209 139019 172565 487045 304803 ...
%       45669 380427 19547 425593 337729 237863 428453 291699 238587 110653 ...
%       196113 465711 141583 224183 266671 169063 317617 68143 291637 263355 ...
%       427191 200211 365773 254701 368663 248047 209221 279201 323179 80217 ...
%       122791 316633 118515 14253 129509 410941 402601 511437 10469 366469 ...
%       463959 442841 54641 44167 19703 209585 69037 33317 433373 55879 ...
%       245295 10905 468881 128617 417919 45067 442243 359529 51109 290275 ...
%       168691 212061 217775 405485 313395 256763 152537 326437 332981 406755 ...
%       423147 412621 362019 279679 169189 107405 251851 5413 316095 247945 ...
%       422489 2555 282267 121027 369319 204587 445191 337315 322505 388411 ...
%       102961 506099 399801 254381 452545 309001 147013 507865 32283 320511 ...
%       264647 417965 227069 341461 466581 386241 494585 201479 151243 481337 ...
%       68195 75401 58359 448107 459499 9873 365117 350845 181873 7917 436695 ...
%       43899 348367 423927 437399 385089 21693 268793 49257 250211 125071 ...
%       341631 310163 94631 108795 21175 142847 383599 71105 65989 446433 ...
%       177457 107311 295679 442763 40729 322721 420175 430359 480757 ]';
  
  % generating vector from LEcuyer, d50 max 2^26
  % z = [1, 27808567, 4291723, 19128519, 30780651, 18458749, 12178783, 29743783, 25033691, 33480147, 8020593, 19148153, 14066445, 18518703, 15613699, 2178677, 28183573, 1526171, 30115975, 31071023, 15869959, 14224785, 974761, 4853571, 12826055, 30822883, 15777357, 6208779, 33078147, 30705703, 14862433, 3713611, 31550515, 17095895, 18194583, 29102385, 11354753, 24605925, 15798429, 432055, 26093779, 17395193, 30564669, 810647, 2752777, 24488595, 30630923, 4960629, 21749861, 25891391];
  % generating vector from Dirk, d32 max 2^32
  % z = [ 2725422931 3588483826 2482056008 2699894846 261045382 1543081430 80852679 400481084 2723310511 1309912161 655654112 547067126 3863332203 2002975972 4094377537 1174014147 526440590 3366872681 2104102445 208642063 4035773363 1769626454 3596462691 727266034 2011029754 3801685993 1333262877 2049874381 125018216 2922738589 1574929950 3562264754];

% generating vector from LEcuyer with weights, d250 max 2^26
 z = [1, 27808567, 14629093, 17951525, 873611, 20915065, 21016621, 23276977, 13573889, 23031381, 30852487, 26266751, 28027657, 5189743, 16396083, 17119083, 13327883, 5182645, 736279, 16190439, 4281341, 18011305, 26892147, 2860863, 18897101, 20241879, 31482589, 9705235, 23408339, 14422975, 27614503, 19560933, 1623155, 25844767, 4275455, 19908921, 32077639, 13483691, 7500601, 23724921, 20105911, 10850327, 12463705, 20419927, 15450237, 13699327, 5391239, 20988989, 2292675, 22914301, 11579857, 3631277, 29192369, 27493855, 26733513, 18979447, 7895911, 28510509, 5136563, 6010773, 22244255, 18318415, 21262503, 2703747, 12557745, 29189357, 24888579, 5272959, 18244419, 10852353, 19495673, 15385229, 17652639, 21737265, 13726991, 14542113, 16618901, 1921655, 29004257, 24806569, 2515121, 25540279, 3051655, 5637047, 19239479, 25413861, 19026129, 7717595, 16939323, 5596877, 3411409, 29006229, 29289975, 17980543, 25987481, 23186729, 4858187, 25345023, 30536647, 865955];

 
nelem=nmax-nmin+1;

% p=sobolset(1,'Skip',nmin-1); % Faster than below but requires Statistical Toolbox
% y=net(p,nelem);

if nmin==1 % vdc points using our own vdc function
    y=gail.vdc(nelem);
else
    y=gail.vdc(nelem)+1/(2*(nmin-1));
end

%Rank-1 lattice points
xlat=[y,zeros(nelem,d-1)];
for j=2:d
xlat(:,j)=mod(y*z(j),1);
end
