function xlat = lattice_gen(nmin,nmax,d)
% d: dimension of the problem, 1<=d<=100.
% nmin,nmax: minimum and maximum indexes of the sequence:
%       xlat=[x_nmin,...,x_nmax]. 1<=nmin<=nmax<=2^27.
%       nmax must be defined as a power of 2 and we can only have
%       nmin=1 or nmin=nmax/2+1

z=[1, 55469281, 30027329, 8602267, 54785287, 14414253, 12439749,...
    66155523, 49958529, 50678183, 55082445, 11596735, 56686781,...
    30468193, 65851543, 28853873, 1986401, 31466969, 39713727,...
    42030083, 45070517, 23411367, 60170803, 7421875, 18416989, 9887091,...
    34346733, 53211753, 50444289, 50389313, 62221249, 17701367,...
    33447805, 13284517, 9501243, 26751367, 9131609, 62968715, 8775773,...
    49646523, 17475295, 49884785, 56867237, 49060203, 52023131, 47109331,...
    54841717, 66225649, 36973289, 8012491, 51033753, 29350449, 30889251,...
    32142699, 54738535, 45473269, 54947635, 27758697, 29790529, 26625455,...
    60517011, 61153189, 5489635, 48516949, 66917801, 55940005, 776425,...
    12712825, 20263211, 43152611, 44328075, 45998049, 36071913, 33802997,...
    28026845, 32069741, 58205893, 7063485, 47516219, 15036803, 56954555,...
    53480353, 62425513, 64392749, 22511733, 41470267, 61734105, 54699367,...
    57054517, 52011193, 5277525, 12672943, 7978621, 56166235, 26118131,...
    29491449, 29833283, 54467951, 33420145, 41944363]; % generating vector from L'Ecuyer generator

nelem=nmax-nmin+1;

% p=sobolset(1,'Skip',nmin-1); % Faster than below but requires Statistical Toolbox
% y=net(p,nelem);

if nmin==1 % vdc points using our own vdc function
    y=gail.vdc(nelem);
else
    y=gail.vdc(nelem)+1/(2*(nmin-1));
end

%Rank-1 lattice points
xlat=[y,zeros(nelem,d-1)];
for j=2:d
xlat(:,j)=mod(y*z(j),1);
end
