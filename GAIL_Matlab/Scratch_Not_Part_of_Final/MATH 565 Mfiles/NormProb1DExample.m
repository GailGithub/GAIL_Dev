%Pictures of stock pricesclose all, clear allset(0,'defaultaxesfontsize',18,'defaulttextfontsize',18)N=2^18; %number of random numbersa=0;b=1;nvec=(1:N)';m=floor(log2(N));twomvec=2.^(0:m)';normcdf=inline('(1+erf(x/sqrt(2)))/2','x');mu=normcdf(1)-normcdf(0);%Monte Carlo 1st estimatorx=rand(N,1); %uniform random numbersy=exp(-x.*x/2)/sqrt(2*pi);MC1N=cumsum(y)./nvec; %MC at each NerrMC1N=abs(mu-MC1N)/mu; %errorvarMC1=(normcdf(sqrt(2))-normcdf(0))/(2*sqrt(pi)) - mu^2;%Monte Carlo 2nd estimatorx=randn(N,1); %uniform random numbersy=(x >=0) & (x <= 1);MC2N=cumsum(y)./nvec; %MC at each NerrMC2N=abs(mu-MC2N)/mu; %errorvarMC2=mu - mu^2;%Rectangle Rule estimatorx=vandercorput(N); %van der Corputy=exp(-x.*x/2)/sqrt(2*pi);rectN=cumsum(y)./nvec; %MC at each NerrrectN=abs(mu-rectN)/mu; %error%Rectangle Rule estimatorx=scrvandercorput(N); %scrambled van der Corputy=exp(-x.*x/2)/sqrt(2*pi);stratN=cumsum(y)./nvec; %MC at each NerrstratN=abs(mu-stratN)/mu; %error%Plot estimates converging to the answerfigure; h=plot(nvec,MC1N,'-b',nvec,MC2N,'-r',nvec,rectN,'-k',nvec,stratN,'-g');  set(h,'linewidth',2);xlabel('N')ylabel('Estimators')text(N*0.3,mu*0.9,'MC1','color','blue')text(N*0.3,mu*0.85,'MC2','color','red')text(N*0.3,mu*0.8,'Rect','color','black')text(N*0.3,mu*0.75,'Strat','color','green')axis([0 N 0.33 0.35])eval(['print -depsc NormProbEst' int2str(N) '.eps'])refresh%Plot errors as a function of N figure; h=loglog(nvec,errMC1N,'-b',nvec,errMC2N,'-r',nvec,errrectN,'-k',nvec,errstratN,'-g');hold onh=[h;plot([1 N],sqrt(varMC1)*[1 1./sqrt(N)],'b--',[1 N],sqrt(varMC2)*[1 1./sqrt(N)],'r--',[1 N],[1 1./N],'k--',[1 N],[1 N^(-1.5)],'g--')];  set(h,'linewidth',2)hold onh=loglog(twomvec,errrectN(twomvec),'ok',twomvec,errstratN(twomvec),'og');set(h,'linewidth',4)xlabel('N')ylabel('Relative Error of Estimators')text(3,1e-4,'MC1','color','blue')text(3,1e-5,'MC2','color','red')text(3,1e-6,'Rect','color','black')text(3,1e-7,'Strat','color','green')axis([1 N 1e-10 1])set(gca,'xtick',10.^(0:5))eval(['print -depsc NormProbEstErr' int2str(N) '.eps'])refresh