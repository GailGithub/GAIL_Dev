% Sou-Cheng Choi, schoi32@iit.edu
%
% Mac OS X 10.8.4, Matlab 7.12 (R2011a)

n = 100;                                  e = ones(n,1);
A = spdiags([-2*e 4*e -2*e],-1:1,n,n);    M = spdiags(4*e,0,n,n);
b = sum(A,2);             rtol = 1e-10;   maxit = 50;
tic
x = minresqlp(A,b,rtol,maxit,M);
time=toc

% Enter minresqlp.  Min-length solution of symmetric (A-sI)x = b or min ||(A-sI)x - b||
% n      =    100   ||b||    = 1.414e+00   shift    = 0.000e+00   rtol     = 1.000e-10
% maxit  =     50   maxxnorm = 1.000e+07   Acondlim = 1.000e+15   TranCond = 1.000e+07
% precon =      1
%
% iter     rnorm     Arnorm   Compatible     LS        Anorm      Acond      xnorm
% P      0   1.41e+00   1.58e+00   1.00e+00   1.00e+00   0.00e+00   1.00e+00   0.00e+00
% 1   6.32e-01   5.10e-01   2.36e-01   5.56e-01   1.12e+00   1.00e+00   1.13e+00
% 2   3.78e-01   2.53e-01   9.65e-02   4.61e-01   1.45e+00   2.22e+00   1.73e+00
% 3   2.58e-01   1.51e-01   5.64e-02   4.03e-01   1.45e+00   3.32e+00   2.18e+00
% 4   1.91e-01   1.00e-01   3.71e-02   3.63e-01   1.45e+00   4.58e+00   2.57e+00
% 5   1.48e-01   7.16e-02   2.63e-02   3.33e-01   1.45e+00   5.98e+00   2.91e+00
% 6   1.20e-01   5.37e-02   1.97e-02   3.10e-01   1.45e+00   7.50e+00   3.21e+00
% 7   9.90e-02   4.17e-02   1.53e-02   2.91e-01   1.45e+00   9.14e+00   3.49e+00
% 8   8.38e-02   3.34e-02   1.22e-02   2.75e-01   1.45e+00   1.09e+01   3.75e+00
% 9   7.21e-02   2.73e-02   1.00e-02   2.61e-01   1.45e+00   1.27e+01   3.99e+00
% 10   6.29e-02   2.27e-02   8.35e-03   2.50e-01   1.45e+00   1.47e+01   4.22e+00
% 11   5.55e-02   1.92e-02   7.07e-03   2.39e-01   1.45e+00   1.67e+01   4.44e+00
% 12   4.94e-02   1.65e-02   6.07e-03   2.30e-01   1.45e+00   1.88e+01   4.64e+00
% 13   4.44e-02   1.43e-02   5.27e-03   2.22e-01   1.45e+00   2.10e+01   4.84e+00
% 14   4.02e-02   1.25e-02   4.61e-03   2.15e-01   1.45e+00   2.33e+01   5.03e+00
% 15   3.66e-02   1.10e-02   4.08e-03   2.08e-01   1.45e+00   2.57e+01   5.21e+00
% 16   3.35e-02   9.81e-03   3.63e-03   2.02e-01   1.45e+00   2.81e+01   5.39e+00
% 17   3.08e-02   8.78e-03   3.25e-03   1.97e-01   1.45e+00   3.06e+01   5.56e+00
% 18   2.85e-02   7.90e-03   2.93e-03   1.92e-01   1.45e+00   3.32e+01   5.73e+00
% 19   2.64e-02   7.14e-03   2.65e-03   1.87e-01   1.45e+00   3.58e+01   5.89e+00
% 20   2.46e-02   6.50e-03   2.41e-03   1.82e-01   1.45e+00   3.85e+01   6.05e+00
%
% iter     rnorm     Arnorm   Compatible     LS        Anorm      Acond      xnorm
% 21   2.30e-02   5.93e-03   2.21e-03   1.78e-01   1.45e+00   4.13e+01   6.20e+00
% 22   2.15e-02   5.44e-03   2.02e-03   1.74e-01   1.45e+00   4.42e+01   6.35e+00
% 23   2.02e-02   5.00e-03   1.86e-03   1.71e-01   1.45e+00   4.71e+01   6.50e+00
% 24   1.90e-02   4.62e-03   1.72e-03   1.67e-01   1.45e+00   5.00e+01   6.64e+00
% 25   1.80e-02   4.27e-03   1.60e-03   1.64e-01   1.45e+00   5.31e+01   6.78e+00
% 26   1.70e-02   3.97e-03   1.48e-03   1.61e-01   1.45e+00   5.62e+01   6.92e+00
% 27   1.61e-02   3.70e-03   1.38e-03   1.58e-01   1.45e+00   5.93e+01   7.06e+00
% 28   1.53e-02   3.45e-03   1.29e-03   1.56e-01   1.45e+00   6.25e+01   7.19e+00
% 29   1.45e-02   3.23e-03   1.21e-03   1.53e-01   1.45e+00   6.58e+01   7.32e+00
% 30   1.39e-02   3.02e-03   1.14e-03   1.51e-01   1.45e+00   6.91e+01   7.45e+00
% 31   1.32e-02   2.84e-03   1.07e-03   1.48e-01   1.45e+00   7.25e+01   7.57e+00
% 32   1.26e-02   2.67e-03   1.01e-03   1.46e-01   1.45e+00   7.59e+01   7.69e+00
% 33   1.21e-02   2.52e-03   9.49e-04   1.44e-01   1.45e+00   7.93e+01   7.82e+00
% 34   1.16e-02   2.38e-03   8.97e-04   1.42e-01   1.45e+00   8.29e+01   7.94e+00
% 35   1.11e-02   2.25e-03   8.49e-04   1.40e-01   1.45e+00   8.64e+01   8.05e+00
% 36   1.07e-02   2.13e-03   8.05e-04   1.38e-01   1.45e+00   9.01e+01   8.17e+00
% 37   1.03e-02   2.02e-03   7.64e-04   1.36e-01   1.45e+00   9.37e+01   8.28e+00
% 38   9.87e-03   1.92e-03   7.26e-04   1.34e-01   1.45e+00   9.75e+01   8.40e+00
% 39   9.50e-03   1.83e-03   6.91e-04   1.33e-01   1.45e+00   1.01e+02   8.51e+00
% 40   9.16e-03   1.74e-03   6.59e-04   1.31e-01   1.45e+00   1.05e+02   8.62e+00
%
% iter     rnorm     Arnorm   Compatible     LS        Anorm      Acond      xnorm
% 41   8.84e-03   1.66e-03   6.29e-04   1.30e-01   1.45e+00   1.09e+02   8.73e+00
% 42   8.54e-03   1.59e-03   6.01e-04   1.28e-01   1.45e+00   1.13e+02   8.83e+00
% 43   8.25e-03   1.52e-03   5.74e-04   1.27e-01   1.45e+00   1.17e+02   8.94e+00
% 44   7.98e-03   1.45e-03   5.50e-04   1.25e-01   1.45e+00   1.21e+02   9.05e+00
% 45   7.73e-03   1.39e-03   5.27e-04   1.24e-01   1.45e+00   1.25e+02   9.15e+00
% 46   7.48e-03   1.33e-03   5.05e-04   1.23e-01   1.45e+00   1.29e+02   9.25e+00
% 47   7.25e-03   1.28e-03   4.85e-04   1.21e-01   1.45e+00   1.33e+02   9.35e+00
% 48   7.03e-03   1.22e-03   4.65e-04   1.20e-01   1.45e+00   1.37e+02   9.45e+00
% 49   6.83e-03   1.65e-05   4.47e-04   1.67e-03   1.45e+00   1.41e+02   9.55e+00
% 50   1.71e-14   1.13e-13D  1.07e-15   4.55e+00D  1.45e+00   2.97e+03   1.00e+01
%
%
% Exit minresqlp.   flag  =      1   A solution to Ax = b found, given rtol
% Exit minresqlp.   iter  =     50   (MINRES      0, MINRES-QLP     50)
% Exit minresqlp.   rnorm =  1.7093e-14     rnorm  direct =  1.7093e-14
% Exit minresqlp.                           Arnorm direct =  1.1271e-13
% Exit minresqlp.   xnorm =  1.0000e+01     xnorm  direct =  1.0000e+01
% Exit minresqlp.   Anorm =  1.4491e+00     Acond         =  2.9743e+03
%
% time =
%
% 0.0182



%Suggestion for improvement:  The IDE Code Analyzer reports in multiple
%lines that using ISEMPT is usually faster than comparing LENGTH to 0.